/* Schoolbook Block Montgomery multiplication */

inline void force_inline block_mont_mul512_8_1040(__m512i out[20], __m512i a512[20], __m512i b512[20], __m512i n[20], __m512i n_prime[1])
{
	__m512i out512[40];
	out512[0] = _mm512_madd52lo_epu64(zero,a512[0],b512[0]);
	out512[1] = _mm512_madd52hi_epu64(zero,a512[0],b512[0]);
	out512[1] = _mm512_madd52lo_epu64(out512[1],a512[0],b512[1]);
	out512[2] = _mm512_madd52hi_epu64(zero,a512[0],b512[1]);
	out512[2] = _mm512_madd52lo_epu64(out512[2],a512[0],b512[2]);
	out512[3] = _mm512_madd52hi_epu64(zero,a512[0],b512[2]);
	out512[3] = _mm512_madd52lo_epu64(out512[3],a512[0],b512[3]);
	out512[4] = _mm512_madd52hi_epu64(zero,a512[0],b512[3]);
	out512[4] = _mm512_madd52lo_epu64(out512[4],a512[0],b512[4]);
	out512[5] = _mm512_madd52hi_epu64(zero,a512[0],b512[4]);
	out512[5] = _mm512_madd52lo_epu64(out512[5],a512[0],b512[5]);
	out512[6] = _mm512_madd52hi_epu64(zero,a512[0],b512[5]);
	out512[6] = _mm512_madd52lo_epu64(out512[6],a512[0],b512[6]);
	out512[7] = _mm512_madd52hi_epu64(zero,a512[0],b512[6]);
	out512[7] = _mm512_madd52lo_epu64(out512[7],a512[0],b512[7]);
	out512[8] = _mm512_madd52hi_epu64(zero,a512[0],b512[7]);
	out512[8] = _mm512_madd52lo_epu64(out512[8],a512[0],b512[8]);
	out512[9] = _mm512_madd52hi_epu64(zero,a512[0],b512[8]);
	out512[9] = _mm512_madd52lo_epu64(out512[9],a512[0],b512[9]);
	out512[10] = _mm512_madd52hi_epu64(zero,a512[0],b512[9]);
	out512[10] = _mm512_madd52lo_epu64(out512[10],a512[0],b512[10]);
	out512[11] = _mm512_madd52hi_epu64(zero,a512[0],b512[10]);
	out512[11] = _mm512_madd52lo_epu64(out512[11],a512[0],b512[11]);
	out512[12] = _mm512_madd52hi_epu64(zero,a512[0],b512[11]);
	out512[12] = _mm512_madd52lo_epu64(out512[12],a512[0],b512[12]);
	out512[13] = _mm512_madd52hi_epu64(zero,a512[0],b512[12]);
	out512[13] = _mm512_madd52lo_epu64(out512[13],a512[0],b512[13]);
	out512[14] = _mm512_madd52hi_epu64(zero,a512[0],b512[13]);
	out512[14] = _mm512_madd52lo_epu64(out512[14],a512[0],b512[14]);
	out512[15] = _mm512_madd52hi_epu64(zero,a512[0],b512[14]);
	out512[15] = _mm512_madd52lo_epu64(out512[15],a512[0],b512[15]);
	out512[16] = _mm512_madd52hi_epu64(zero,a512[0],b512[15]);
	out512[16] = _mm512_madd52lo_epu64(out512[16],a512[0],b512[16]);
	out512[17] = _mm512_madd52hi_epu64(zero,a512[0],b512[16]);
	out512[17] = _mm512_madd52lo_epu64(out512[17],a512[0],b512[17]);
	out512[18] = _mm512_madd52hi_epu64(zero,a512[0],b512[17]);
	out512[18] = _mm512_madd52lo_epu64(out512[18],a512[0],b512[18]);
	out512[19] = _mm512_madd52hi_epu64(zero,a512[0],b512[18]);
	out512[19] = _mm512_madd52lo_epu64(out512[19],a512[0],b512[19]);
	out512[20] = _mm512_madd52hi_epu64(zero,a512[0],b512[19]);

	__m512i q512 = _mm512_madd52lo_epu64(zero,out512[0],n_prime[0]);

	__m512i t512[21];
	t512[0] = _mm512_madd52lo_epu64(out512[0],q512,n[0]);
	t512[1] = _mm512_madd52hi_epu64(out512[1],q512,n[0]);
	t512[1] = _mm512_madd52lo_epu64(t512[1],q512,n[1]);
	t512[2] = _mm512_madd52hi_epu64(out512[2],q512,n[1]);
	t512[2] = _mm512_madd52lo_epu64(t512[2],q512,n[2]);
	t512[3] = _mm512_madd52hi_epu64(out512[3],q512,n[2]);
	t512[3] = _mm512_madd52lo_epu64(t512[3],q512,n[3]);
	t512[4] = _mm512_madd52hi_epu64(out512[4],q512,n[3]);
	t512[4] = _mm512_madd52lo_epu64(t512[4],q512,n[4]);
	t512[5] = _mm512_madd52hi_epu64(out512[5],q512,n[4]);
	t512[5] = _mm512_madd52lo_epu64(t512[5],q512,n[5]);
	t512[6] = _mm512_madd52hi_epu64(out512[6],q512,n[5]);
	t512[6] = _mm512_madd52lo_epu64(t512[6],q512,n[6]);
	t512[7] = _mm512_madd52hi_epu64(out512[7],q512,n[6]);
	t512[7] = _mm512_madd52lo_epu64(t512[7],q512,n[7]);
	t512[8] = _mm512_madd52hi_epu64(out512[8],q512,n[7]);
	t512[8] = _mm512_madd52lo_epu64(t512[8],q512,n[8]);
	t512[9] = _mm512_madd52hi_epu64(out512[9],q512,n[8]);
	t512[9] = _mm512_madd52lo_epu64(t512[9],q512,n[9]);
	t512[10] = _mm512_madd52hi_epu64(out512[10],q512,n[9]);
	t512[10] = _mm512_madd52lo_epu64(t512[10],q512,n[10]);
	t512[11] = _mm512_madd52hi_epu64(out512[11],q512,n[10]);
	t512[11] = _mm512_madd52lo_epu64(t512[11],q512,n[11]);
	t512[12] = _mm512_madd52hi_epu64(out512[12],q512,n[11]);
	t512[12] = _mm512_madd52lo_epu64(t512[12],q512,n[12]);
	t512[13] = _mm512_madd52hi_epu64(out512[13],q512,n[12]);
	t512[13] = _mm512_madd52lo_epu64(t512[13],q512,n[13]);
	t512[14] = _mm512_madd52hi_epu64(out512[14],q512,n[13]);
	t512[14] = _mm512_madd52lo_epu64(t512[14],q512,n[14]);
	t512[15] = _mm512_madd52hi_epu64(out512[15],q512,n[14]);
	t512[15] = _mm512_madd52lo_epu64(t512[15],q512,n[15]);
	t512[16] = _mm512_madd52hi_epu64(out512[16],q512,n[15]);
	t512[16] = _mm512_madd52lo_epu64(t512[16],q512,n[16]);
	t512[17] = _mm512_madd52hi_epu64(out512[17],q512,n[16]);
	t512[17] = _mm512_madd52lo_epu64(t512[17],q512,n[17]);
	t512[18] = _mm512_madd52hi_epu64(out512[18],q512,n[17]);
	t512[18] = _mm512_madd52lo_epu64(t512[18],q512,n[18]);
	t512[19] = _mm512_madd52hi_epu64(out512[19],q512,n[18]);
	t512[19] = _mm512_madd52lo_epu64(t512[19],q512,n[19]);
	t512[20] = _mm512_madd52hi_epu64(out512[20],q512,n[19]);

	__m512i carry  = _mm512_srli_epi64(t512[0],52);
	out512[0] = _mm512_and_si512(t512[0],mask52);
	t512[1] = _mm512_add_epi64(t512[1],carry);
	carry  = _mm512_srli_epi64(t512[1],52);
	out512[1] = _mm512_and_si512(t512[1],mask52);
	t512[2] = _mm512_add_epi64(t512[2],carry);
	carry  = _mm512_srli_epi64(t512[2],52);
	out512[2] = _mm512_and_si512(t512[2],mask52);
	t512[3] = _mm512_add_epi64(t512[3],carry);
	carry  = _mm512_srli_epi64(t512[3],52);
	out512[3] = _mm512_and_si512(t512[3],mask52);
	t512[4] = _mm512_add_epi64(t512[4],carry);
	carry  = _mm512_srli_epi64(t512[4],52);
	out512[4] = _mm512_and_si512(t512[4],mask52);
	t512[5] = _mm512_add_epi64(t512[5],carry);
	carry  = _mm512_srli_epi64(t512[5],52);
	out512[5] = _mm512_and_si512(t512[5],mask52);
	t512[6] = _mm512_add_epi64(t512[6],carry);
	carry  = _mm512_srli_epi64(t512[6],52);
	out512[6] = _mm512_and_si512(t512[6],mask52);
	t512[7] = _mm512_add_epi64(t512[7],carry);
	carry  = _mm512_srli_epi64(t512[7],52);
	out512[7] = _mm512_and_si512(t512[7],mask52);
	t512[8] = _mm512_add_epi64(t512[8],carry);
	carry  = _mm512_srli_epi64(t512[8],52);
	out512[8] = _mm512_and_si512(t512[8],mask52);
	t512[9] = _mm512_add_epi64(t512[9],carry);
	carry  = _mm512_srli_epi64(t512[9],52);
	out512[9] = _mm512_and_si512(t512[9],mask52);
	t512[10] = _mm512_add_epi64(t512[10],carry);
	carry  = _mm512_srli_epi64(t512[10],52);
	out512[10] = _mm512_and_si512(t512[10],mask52);
	t512[11] = _mm512_add_epi64(t512[11],carry);
	carry  = _mm512_srli_epi64(t512[11],52);
	out512[11] = _mm512_and_si512(t512[11],mask52);
	t512[12] = _mm512_add_epi64(t512[12],carry);
	carry  = _mm512_srli_epi64(t512[12],52);
	out512[12] = _mm512_and_si512(t512[12],mask52);
	t512[13] = _mm512_add_epi64(t512[13],carry);
	carry  = _mm512_srli_epi64(t512[13],52);
	out512[13] = _mm512_and_si512(t512[13],mask52);
	t512[14] = _mm512_add_epi64(t512[14],carry);
	carry  = _mm512_srli_epi64(t512[14],52);
	out512[14] = _mm512_and_si512(t512[14],mask52);
	t512[15] = _mm512_add_epi64(t512[15],carry);
	carry  = _mm512_srli_epi64(t512[15],52);
	out512[15] = _mm512_and_si512(t512[15],mask52);
	t512[16] = _mm512_add_epi64(t512[16],carry);
	carry  = _mm512_srli_epi64(t512[16],52);
	out512[16] = _mm512_and_si512(t512[16],mask52);
	t512[17] = _mm512_add_epi64(t512[17],carry);
	carry  = _mm512_srli_epi64(t512[17],52);
	out512[17] = _mm512_and_si512(t512[17],mask52);
	t512[18] = _mm512_add_epi64(t512[18],carry);
	carry  = _mm512_srli_epi64(t512[18],52);
	out512[18] = _mm512_and_si512(t512[18],mask52);
	t512[19] = _mm512_add_epi64(t512[19],carry);
	carry  = _mm512_srli_epi64(t512[19],52);
	out512[19] = _mm512_and_si512(t512[19],mask52);
	out512[20] = _mm512_add_epi64(t512[20],carry);


	//Y = Y + a_iB

	out512[1] = _mm512_madd52lo_epu64(out512[1],a512[1],b512[0]);
	out512[2] = _mm512_madd52hi_epu64(out512[2],a512[1],b512[0]);
	out512[2] = _mm512_madd52lo_epu64(out512[2],a512[1],b512[1]);
	out512[3] = _mm512_madd52hi_epu64(out512[3],a512[1],b512[1]);
	out512[3] = _mm512_madd52lo_epu64(out512[3],a512[1],b512[2]);
	out512[4] = _mm512_madd52hi_epu64(out512[4],a512[1],b512[2]);
	out512[4] = _mm512_madd52lo_epu64(out512[4],a512[1],b512[3]);
	out512[5] = _mm512_madd52hi_epu64(out512[5],a512[1],b512[3]);
	out512[5] = _mm512_madd52lo_epu64(out512[5],a512[1],b512[4]);
	out512[6] = _mm512_madd52hi_epu64(out512[6],a512[1],b512[4]);
	out512[6] = _mm512_madd52lo_epu64(out512[6],a512[1],b512[5]);
	out512[7] = _mm512_madd52hi_epu64(out512[7],a512[1],b512[5]);
	out512[7] = _mm512_madd52lo_epu64(out512[7],a512[1],b512[6]);
	out512[8] = _mm512_madd52hi_epu64(out512[8],a512[1],b512[6]);
	out512[8] = _mm512_madd52lo_epu64(out512[8],a512[1],b512[7]);
	out512[9] = _mm512_madd52hi_epu64(out512[9],a512[1],b512[7]);
	out512[9] = _mm512_madd52lo_epu64(out512[9],a512[1],b512[8]);
	out512[10] = _mm512_madd52hi_epu64(out512[10],a512[1],b512[8]);
	out512[10] = _mm512_madd52lo_epu64(out512[10],a512[1],b512[9]);
	out512[11] = _mm512_madd52hi_epu64(out512[11],a512[1],b512[9]);
	out512[11] = _mm512_madd52lo_epu64(out512[11],a512[1],b512[10]);
	out512[12] = _mm512_madd52hi_epu64(out512[12],a512[1],b512[10]);
	out512[12] = _mm512_madd52lo_epu64(out512[12],a512[1],b512[11]);
	out512[13] = _mm512_madd52hi_epu64(out512[13],a512[1],b512[11]);
	out512[13] = _mm512_madd52lo_epu64(out512[13],a512[1],b512[12]);
	out512[14] = _mm512_madd52hi_epu64(out512[14],a512[1],b512[12]);
	out512[14] = _mm512_madd52lo_epu64(out512[14],a512[1],b512[13]);
	out512[15] = _mm512_madd52hi_epu64(out512[15],a512[1],b512[13]);
	out512[15] = _mm512_madd52lo_epu64(out512[15],a512[1],b512[14]);
	out512[16] = _mm512_madd52hi_epu64(out512[16],a512[1],b512[14]);
	out512[16] = _mm512_madd52lo_epu64(out512[16],a512[1],b512[15]);
	out512[17] = _mm512_madd52hi_epu64(out512[17],a512[1],b512[15]);
	out512[17] = _mm512_madd52lo_epu64(out512[17],a512[1],b512[16]);
	out512[18] = _mm512_madd52hi_epu64(out512[18],a512[1],b512[16]);
	out512[18] = _mm512_madd52lo_epu64(out512[18],a512[1],b512[17]);
	out512[19] = _mm512_madd52hi_epu64(out512[19],a512[1],b512[17]);
	out512[19] = _mm512_madd52lo_epu64(out512[19],a512[1],b512[18]);
	out512[20] = _mm512_madd52hi_epu64(out512[20],a512[1],b512[18]);
	out512[20] = _mm512_madd52lo_epu64(out512[20],a512[1],b512[19]);
	out512[21] = _mm512_madd52hi_epu64(zero,a512[1],b512[19]);

	q512 = _mm512_madd52lo_epu64(zero,out512[1],n_prime[0]);

	t512[0] = _mm512_madd52lo_epu64(out512[1],q512,n[0]);
	t512[1] = _mm512_madd52hi_epu64(out512[2],q512,n[0]);
	t512[1] = _mm512_madd52lo_epu64(t512[1],q512,n[1]);
	t512[2] = _mm512_madd52hi_epu64(out512[3],q512,n[1]);
	t512[2] = _mm512_madd52lo_epu64(t512[2],q512,n[2]);
	t512[3] = _mm512_madd52hi_epu64(out512[4],q512,n[2]);
	t512[3] = _mm512_madd52lo_epu64(t512[3],q512,n[3]);
	t512[4] = _mm512_madd52hi_epu64(out512[5],q512,n[3]);
	t512[4] = _mm512_madd52lo_epu64(t512[4],q512,n[4]);
	t512[5] = _mm512_madd52hi_epu64(out512[6],q512,n[4]);
	t512[5] = _mm512_madd52lo_epu64(t512[5],q512,n[5]);
	t512[6] = _mm512_madd52hi_epu64(out512[7],q512,n[5]);
	t512[6] = _mm512_madd52lo_epu64(t512[6],q512,n[6]);
	t512[7] = _mm512_madd52hi_epu64(out512[8],q512,n[6]);
	t512[7] = _mm512_madd52lo_epu64(t512[7],q512,n[7]);
	t512[8] = _mm512_madd52hi_epu64(out512[9],q512,n[7]);
	t512[8] = _mm512_madd52lo_epu64(t512[8],q512,n[8]);
	t512[9] = _mm512_madd52hi_epu64(out512[10],q512,n[8]);
	t512[9] = _mm512_madd52lo_epu64(t512[9],q512,n[9]);
	t512[10] = _mm512_madd52hi_epu64(out512[11],q512,n[9]);
	t512[10] = _mm512_madd52lo_epu64(t512[10],q512,n[10]);
	t512[11] = _mm512_madd52hi_epu64(out512[12],q512,n[10]);
	t512[11] = _mm512_madd52lo_epu64(t512[11],q512,n[11]);
	t512[12] = _mm512_madd52hi_epu64(out512[13],q512,n[11]);
	t512[12] = _mm512_madd52lo_epu64(t512[12],q512,n[12]);
	t512[13] = _mm512_madd52hi_epu64(out512[14],q512,n[12]);
	t512[13] = _mm512_madd52lo_epu64(t512[13],q512,n[13]);
	t512[14] = _mm512_madd52hi_epu64(out512[15],q512,n[13]);
	t512[14] = _mm512_madd52lo_epu64(t512[14],q512,n[14]);
	t512[15] = _mm512_madd52hi_epu64(out512[16],q512,n[14]);
	t512[15] = _mm512_madd52lo_epu64(t512[15],q512,n[15]);
	t512[16] = _mm512_madd52hi_epu64(out512[17],q512,n[15]);
	t512[16] = _mm512_madd52lo_epu64(t512[16],q512,n[16]);
	t512[17] = _mm512_madd52hi_epu64(out512[18],q512,n[16]);
	t512[17] = _mm512_madd52lo_epu64(t512[17],q512,n[17]);
	t512[18] = _mm512_madd52hi_epu64(out512[19],q512,n[17]);
	t512[18] = _mm512_madd52lo_epu64(t512[18],q512,n[18]);
	t512[19] = _mm512_madd52hi_epu64(out512[20],q512,n[18]);
	t512[19] = _mm512_madd52lo_epu64(t512[19],q512,n[19]);
	t512[20] = _mm512_madd52hi_epu64(out512[21],q512,n[19]);

	carry  = _mm512_srli_epi64(t512[0],52);
	out512[1] = _mm512_and_si512(t512[0],mask52);
	t512[1] = _mm512_add_epi64(carry,t512[1]);
	carry  = _mm512_srli_epi64(t512[1],52);
	out512[2] = _mm512_and_si512(t512[1],mask52);
	t512[2] = _mm512_add_epi64(carry,t512[2]);
	carry  = _mm512_srli_epi64(t512[2],52);
	out512[3] = _mm512_and_si512(t512[2],mask52);
	t512[3] = _mm512_add_epi64(carry,t512[3]);
	carry  = _mm512_srli_epi64(t512[3],52);
	out512[4] = _mm512_and_si512(t512[3],mask52);
	t512[4] = _mm512_add_epi64(carry,t512[4]);
	carry  = _mm512_srli_epi64(t512[4],52);
	out512[5] = _mm512_and_si512(t512[4],mask52);
	t512[5] = _mm512_add_epi64(carry,t512[5]);
	carry  = _mm512_srli_epi64(t512[5],52);
	out512[6] = _mm512_and_si512(t512[5],mask52);
	t512[6] = _mm512_add_epi64(carry,t512[6]);
	carry  = _mm512_srli_epi64(t512[6],52);
	out512[7] = _mm512_and_si512(t512[6],mask52);
	t512[7] = _mm512_add_epi64(carry,t512[7]);
	carry  = _mm512_srli_epi64(t512[7],52);
	out512[8] = _mm512_and_si512(t512[7],mask52);
	t512[8] = _mm512_add_epi64(carry,t512[8]);
	carry  = _mm512_srli_epi64(t512[8],52);
	out512[9] = _mm512_and_si512(t512[8],mask52);
	t512[9] = _mm512_add_epi64(carry,t512[9]);
	carry  = _mm512_srli_epi64(t512[9],52);
	out512[10] = _mm512_and_si512(t512[9],mask52);
	t512[10] = _mm512_add_epi64(carry,t512[10]);
	carry  = _mm512_srli_epi64(t512[10],52);
	out512[11] = _mm512_and_si512(t512[10],mask52);
	t512[11] = _mm512_add_epi64(carry,t512[11]);
	carry  = _mm512_srli_epi64(t512[11],52);
	out512[12] = _mm512_and_si512(t512[11],mask52);
	t512[12] = _mm512_add_epi64(carry,t512[12]);
	carry  = _mm512_srli_epi64(t512[12],52);
	out512[13] = _mm512_and_si512(t512[12],mask52);
	t512[13] = _mm512_add_epi64(carry,t512[13]);
	carry  = _mm512_srli_epi64(t512[13],52);
	out512[14] = _mm512_and_si512(t512[13],mask52);
	t512[14] = _mm512_add_epi64(carry,t512[14]);
	carry  = _mm512_srli_epi64(t512[14],52);
	out512[15] = _mm512_and_si512(t512[14],mask52);
	t512[15] = _mm512_add_epi64(carry,t512[15]);
	carry  = _mm512_srli_epi64(t512[15],52);
	out512[16] = _mm512_and_si512(t512[15],mask52);
	t512[16] = _mm512_add_epi64(carry,t512[16]);
	carry  = _mm512_srli_epi64(t512[16],52);
	out512[17] = _mm512_and_si512(t512[16],mask52);
	t512[17] = _mm512_add_epi64(carry,t512[17]);
	carry  = _mm512_srli_epi64(t512[17],52);
	out512[18] = _mm512_and_si512(t512[17],mask52);
	t512[18] = _mm512_add_epi64(carry,t512[18]);
	carry  = _mm512_srli_epi64(t512[18],52);
	out512[19] = _mm512_and_si512(t512[18],mask52);
	t512[19] = _mm512_add_epi64(carry,t512[19]);
	carry  = _mm512_srli_epi64(t512[19],52);
	out512[20] = _mm512_and_si512(t512[19],mask52);
	out512[21] = _mm512_add_epi64(t512[20],carry);


	//Y = Y + a_iB

	out512[2] = _mm512_madd52lo_epu64(out512[2],a512[2],b512[0]);
	out512[3] = _mm512_madd52hi_epu64(out512[3],a512[2],b512[0]);
	out512[3] = _mm512_madd52lo_epu64(out512[3],a512[2],b512[1]);
	out512[4] = _mm512_madd52hi_epu64(out512[4],a512[2],b512[1]);
	out512[4] = _mm512_madd52lo_epu64(out512[4],a512[2],b512[2]);
	out512[5] = _mm512_madd52hi_epu64(out512[5],a512[2],b512[2]);
	out512[5] = _mm512_madd52lo_epu64(out512[5],a512[2],b512[3]);
	out512[6] = _mm512_madd52hi_epu64(out512[6],a512[2],b512[3]);
	out512[6] = _mm512_madd52lo_epu64(out512[6],a512[2],b512[4]);
	out512[7] = _mm512_madd52hi_epu64(out512[7],a512[2],b512[4]);
	out512[7] = _mm512_madd52lo_epu64(out512[7],a512[2],b512[5]);
	out512[8] = _mm512_madd52hi_epu64(out512[8],a512[2],b512[5]);
	out512[8] = _mm512_madd52lo_epu64(out512[8],a512[2],b512[6]);
	out512[9] = _mm512_madd52hi_epu64(out512[9],a512[2],b512[6]);
	out512[9] = _mm512_madd52lo_epu64(out512[9],a512[2],b512[7]);
	out512[10] = _mm512_madd52hi_epu64(out512[10],a512[2],b512[7]);
	out512[10] = _mm512_madd52lo_epu64(out512[10],a512[2],b512[8]);
	out512[11] = _mm512_madd52hi_epu64(out512[11],a512[2],b512[8]);
	out512[11] = _mm512_madd52lo_epu64(out512[11],a512[2],b512[9]);
	out512[12] = _mm512_madd52hi_epu64(out512[12],a512[2],b512[9]);
	out512[12] = _mm512_madd52lo_epu64(out512[12],a512[2],b512[10]);
	out512[13] = _mm512_madd52hi_epu64(out512[13],a512[2],b512[10]);
	out512[13] = _mm512_madd52lo_epu64(out512[13],a512[2],b512[11]);
	out512[14] = _mm512_madd52hi_epu64(out512[14],a512[2],b512[11]);
	out512[14] = _mm512_madd52lo_epu64(out512[14],a512[2],b512[12]);
	out512[15] = _mm512_madd52hi_epu64(out512[15],a512[2],b512[12]);
	out512[15] = _mm512_madd52lo_epu64(out512[15],a512[2],b512[13]);
	out512[16] = _mm512_madd52hi_epu64(out512[16],a512[2],b512[13]);
	out512[16] = _mm512_madd52lo_epu64(out512[16],a512[2],b512[14]);
	out512[17] = _mm512_madd52hi_epu64(out512[17],a512[2],b512[14]);
	out512[17] = _mm512_madd52lo_epu64(out512[17],a512[2],b512[15]);
	out512[18] = _mm512_madd52hi_epu64(out512[18],a512[2],b512[15]);
	out512[18] = _mm512_madd52lo_epu64(out512[18],a512[2],b512[16]);
	out512[19] = _mm512_madd52hi_epu64(out512[19],a512[2],b512[16]);
	out512[19] = _mm512_madd52lo_epu64(out512[19],a512[2],b512[17]);
	out512[20] = _mm512_madd52hi_epu64(out512[20],a512[2],b512[17]);
	out512[20] = _mm512_madd52lo_epu64(out512[20],a512[2],b512[18]);
	out512[21] = _mm512_madd52hi_epu64(out512[21],a512[2],b512[18]);
	out512[21] = _mm512_madd52lo_epu64(out512[21],a512[2],b512[19]);
	out512[22] = _mm512_madd52hi_epu64(zero,a512[2],b512[19]);

	q512 = _mm512_madd52lo_epu64(zero,out512[2],n_prime[0]);

	t512[0] = _mm512_madd52lo_epu64(out512[2],q512,n[0]);
	t512[1] = _mm512_madd52hi_epu64(out512[3],q512,n[0]);
	t512[1] = _mm512_madd52lo_epu64(t512[1],q512,n[1]);
	t512[2] = _mm512_madd52hi_epu64(out512[4],q512,n[1]);
	t512[2] = _mm512_madd52lo_epu64(t512[2],q512,n[2]);
	t512[3] = _mm512_madd52hi_epu64(out512[5],q512,n[2]);
	t512[3] = _mm512_madd52lo_epu64(t512[3],q512,n[3]);
	t512[4] = _mm512_madd52hi_epu64(out512[6],q512,n[3]);
	t512[4] = _mm512_madd52lo_epu64(t512[4],q512,n[4]);
	t512[5] = _mm512_madd52hi_epu64(out512[7],q512,n[4]);
	t512[5] = _mm512_madd52lo_epu64(t512[5],q512,n[5]);
	t512[6] = _mm512_madd52hi_epu64(out512[8],q512,n[5]);
	t512[6] = _mm512_madd52lo_epu64(t512[6],q512,n[6]);
	t512[7] = _mm512_madd52hi_epu64(out512[9],q512,n[6]);
	t512[7] = _mm512_madd52lo_epu64(t512[7],q512,n[7]);
	t512[8] = _mm512_madd52hi_epu64(out512[10],q512,n[7]);
	t512[8] = _mm512_madd52lo_epu64(t512[8],q512,n[8]);
	t512[9] = _mm512_madd52hi_epu64(out512[11],q512,n[8]);
	t512[9] = _mm512_madd52lo_epu64(t512[9],q512,n[9]);
	t512[10] = _mm512_madd52hi_epu64(out512[12],q512,n[9]);
	t512[10] = _mm512_madd52lo_epu64(t512[10],q512,n[10]);
	t512[11] = _mm512_madd52hi_epu64(out512[13],q512,n[10]);
	t512[11] = _mm512_madd52lo_epu64(t512[11],q512,n[11]);
	t512[12] = _mm512_madd52hi_epu64(out512[14],q512,n[11]);
	t512[12] = _mm512_madd52lo_epu64(t512[12],q512,n[12]);
	t512[13] = _mm512_madd52hi_epu64(out512[15],q512,n[12]);
	t512[13] = _mm512_madd52lo_epu64(t512[13],q512,n[13]);
	t512[14] = _mm512_madd52hi_epu64(out512[16],q512,n[13]);
	t512[14] = _mm512_madd52lo_epu64(t512[14],q512,n[14]);
	t512[15] = _mm512_madd52hi_epu64(out512[17],q512,n[14]);
	t512[15] = _mm512_madd52lo_epu64(t512[15],q512,n[15]);
	t512[16] = _mm512_madd52hi_epu64(out512[18],q512,n[15]);
	t512[16] = _mm512_madd52lo_epu64(t512[16],q512,n[16]);
	t512[17] = _mm512_madd52hi_epu64(out512[19],q512,n[16]);
	t512[17] = _mm512_madd52lo_epu64(t512[17],q512,n[17]);
	t512[18] = _mm512_madd52hi_epu64(out512[20],q512,n[17]);
	t512[18] = _mm512_madd52lo_epu64(t512[18],q512,n[18]);
	t512[19] = _mm512_madd52hi_epu64(out512[21],q512,n[18]);
	t512[19] = _mm512_madd52lo_epu64(t512[19],q512,n[19]);
	t512[20] = _mm512_madd52hi_epu64(out512[22],q512,n[19]);

	carry  = _mm512_srli_epi64(t512[0],52);
	out512[2] = _mm512_and_si512(t512[0],mask52);
	t512[1] = _mm512_add_epi64(carry,t512[1]);
	carry  = _mm512_srli_epi64(t512[1],52);
	out512[3] = _mm512_and_si512(t512[1],mask52);
	t512[2] = _mm512_add_epi64(carry,t512[2]);
	carry  = _mm512_srli_epi64(t512[2],52);
	out512[4] = _mm512_and_si512(t512[2],mask52);
	t512[3] = _mm512_add_epi64(carry,t512[3]);
	carry  = _mm512_srli_epi64(t512[3],52);
	out512[5] = _mm512_and_si512(t512[3],mask52);
	t512[4] = _mm512_add_epi64(carry,t512[4]);
	carry  = _mm512_srli_epi64(t512[4],52);
	out512[6] = _mm512_and_si512(t512[4],mask52);
	t512[5] = _mm512_add_epi64(carry,t512[5]);
	carry  = _mm512_srli_epi64(t512[5],52);
	out512[7] = _mm512_and_si512(t512[5],mask52);
	t512[6] = _mm512_add_epi64(carry,t512[6]);
	carry  = _mm512_srli_epi64(t512[6],52);
	out512[8] = _mm512_and_si512(t512[6],mask52);
	t512[7] = _mm512_add_epi64(carry,t512[7]);
	carry  = _mm512_srli_epi64(t512[7],52);
	out512[9] = _mm512_and_si512(t512[7],mask52);
	t512[8] = _mm512_add_epi64(carry,t512[8]);
	carry  = _mm512_srli_epi64(t512[8],52);
	out512[10] = _mm512_and_si512(t512[8],mask52);
	t512[9] = _mm512_add_epi64(carry,t512[9]);
	carry  = _mm512_srli_epi64(t512[9],52);
	out512[11] = _mm512_and_si512(t512[9],mask52);
	t512[10] = _mm512_add_epi64(carry,t512[10]);
	carry  = _mm512_srli_epi64(t512[10],52);
	out512[12] = _mm512_and_si512(t512[10],mask52);
	t512[11] = _mm512_add_epi64(carry,t512[11]);
	carry  = _mm512_srli_epi64(t512[11],52);
	out512[13] = _mm512_and_si512(t512[11],mask52);
	t512[12] = _mm512_add_epi64(carry,t512[12]);
	carry  = _mm512_srli_epi64(t512[12],52);
	out512[14] = _mm512_and_si512(t512[12],mask52);
	t512[13] = _mm512_add_epi64(carry,t512[13]);
	carry  = _mm512_srli_epi64(t512[13],52);
	out512[15] = _mm512_and_si512(t512[13],mask52);
	t512[14] = _mm512_add_epi64(carry,t512[14]);
	carry  = _mm512_srli_epi64(t512[14],52);
	out512[16] = _mm512_and_si512(t512[14],mask52);
	t512[15] = _mm512_add_epi64(carry,t512[15]);
	carry  = _mm512_srli_epi64(t512[15],52);
	out512[17] = _mm512_and_si512(t512[15],mask52);
	t512[16] = _mm512_add_epi64(carry,t512[16]);
	carry  = _mm512_srli_epi64(t512[16],52);
	out512[18] = _mm512_and_si512(t512[16],mask52);
	t512[17] = _mm512_add_epi64(carry,t512[17]);
	carry  = _mm512_srli_epi64(t512[17],52);
	out512[19] = _mm512_and_si512(t512[17],mask52);
	t512[18] = _mm512_add_epi64(carry,t512[18]);
	carry  = _mm512_srli_epi64(t512[18],52);
	out512[20] = _mm512_and_si512(t512[18],mask52);
	t512[19] = _mm512_add_epi64(carry,t512[19]);
	carry  = _mm512_srli_epi64(t512[19],52);
	out512[21] = _mm512_and_si512(t512[19],mask52);
	out512[22] = _mm512_add_epi64(t512[20],carry);


	//Y = Y + a_iB

	out512[3] = _mm512_madd52lo_epu64(out512[3],a512[3],b512[0]);
	out512[4] = _mm512_madd52hi_epu64(out512[4],a512[3],b512[0]);
	out512[4] = _mm512_madd52lo_epu64(out512[4],a512[3],b512[1]);
	out512[5] = _mm512_madd52hi_epu64(out512[5],a512[3],b512[1]);
	out512[5] = _mm512_madd52lo_epu64(out512[5],a512[3],b512[2]);
	out512[6] = _mm512_madd52hi_epu64(out512[6],a512[3],b512[2]);
	out512[6] = _mm512_madd52lo_epu64(out512[6],a512[3],b512[3]);
	out512[7] = _mm512_madd52hi_epu64(out512[7],a512[3],b512[3]);
	out512[7] = _mm512_madd52lo_epu64(out512[7],a512[3],b512[4]);
	out512[8] = _mm512_madd52hi_epu64(out512[8],a512[3],b512[4]);
	out512[8] = _mm512_madd52lo_epu64(out512[8],a512[3],b512[5]);
	out512[9] = _mm512_madd52hi_epu64(out512[9],a512[3],b512[5]);
	out512[9] = _mm512_madd52lo_epu64(out512[9],a512[3],b512[6]);
	out512[10] = _mm512_madd52hi_epu64(out512[10],a512[3],b512[6]);
	out512[10] = _mm512_madd52lo_epu64(out512[10],a512[3],b512[7]);
	out512[11] = _mm512_madd52hi_epu64(out512[11],a512[3],b512[7]);
	out512[11] = _mm512_madd52lo_epu64(out512[11],a512[3],b512[8]);
	out512[12] = _mm512_madd52hi_epu64(out512[12],a512[3],b512[8]);
	out512[12] = _mm512_madd52lo_epu64(out512[12],a512[3],b512[9]);
	out512[13] = _mm512_madd52hi_epu64(out512[13],a512[3],b512[9]);
	out512[13] = _mm512_madd52lo_epu64(out512[13],a512[3],b512[10]);
	out512[14] = _mm512_madd52hi_epu64(out512[14],a512[3],b512[10]);
	out512[14] = _mm512_madd52lo_epu64(out512[14],a512[3],b512[11]);
	out512[15] = _mm512_madd52hi_epu64(out512[15],a512[3],b512[11]);
	out512[15] = _mm512_madd52lo_epu64(out512[15],a512[3],b512[12]);
	out512[16] = _mm512_madd52hi_epu64(out512[16],a512[3],b512[12]);
	out512[16] = _mm512_madd52lo_epu64(out512[16],a512[3],b512[13]);
	out512[17] = _mm512_madd52hi_epu64(out512[17],a512[3],b512[13]);
	out512[17] = _mm512_madd52lo_epu64(out512[17],a512[3],b512[14]);
	out512[18] = _mm512_madd52hi_epu64(out512[18],a512[3],b512[14]);
	out512[18] = _mm512_madd52lo_epu64(out512[18],a512[3],b512[15]);
	out512[19] = _mm512_madd52hi_epu64(out512[19],a512[3],b512[15]);
	out512[19] = _mm512_madd52lo_epu64(out512[19],a512[3],b512[16]);
	out512[20] = _mm512_madd52hi_epu64(out512[20],a512[3],b512[16]);
	out512[20] = _mm512_madd52lo_epu64(out512[20],a512[3],b512[17]);
	out512[21] = _mm512_madd52hi_epu64(out512[21],a512[3],b512[17]);
	out512[21] = _mm512_madd52lo_epu64(out512[21],a512[3],b512[18]);
	out512[22] = _mm512_madd52hi_epu64(out512[22],a512[3],b512[18]);
	out512[22] = _mm512_madd52lo_epu64(out512[22],a512[3],b512[19]);
	out512[23] = _mm512_madd52hi_epu64(zero,a512[3],b512[19]);

	q512 = _mm512_madd52lo_epu64(zero,out512[3],n_prime[0]);

	t512[0] = _mm512_madd52lo_epu64(out512[3],q512,n[0]);
	t512[1] = _mm512_madd52hi_epu64(out512[4],q512,n[0]);
	t512[1] = _mm512_madd52lo_epu64(t512[1],q512,n[1]);
	t512[2] = _mm512_madd52hi_epu64(out512[5],q512,n[1]);
	t512[2] = _mm512_madd52lo_epu64(t512[2],q512,n[2]);
	t512[3] = _mm512_madd52hi_epu64(out512[6],q512,n[2]);
	t512[3] = _mm512_madd52lo_epu64(t512[3],q512,n[3]);
	t512[4] = _mm512_madd52hi_epu64(out512[7],q512,n[3]);
	t512[4] = _mm512_madd52lo_epu64(t512[4],q512,n[4]);
	t512[5] = _mm512_madd52hi_epu64(out512[8],q512,n[4]);
	t512[5] = _mm512_madd52lo_epu64(t512[5],q512,n[5]);
	t512[6] = _mm512_madd52hi_epu64(out512[9],q512,n[5]);
	t512[6] = _mm512_madd52lo_epu64(t512[6],q512,n[6]);
	t512[7] = _mm512_madd52hi_epu64(out512[10],q512,n[6]);
	t512[7] = _mm512_madd52lo_epu64(t512[7],q512,n[7]);
	t512[8] = _mm512_madd52hi_epu64(out512[11],q512,n[7]);
	t512[8] = _mm512_madd52lo_epu64(t512[8],q512,n[8]);
	t512[9] = _mm512_madd52hi_epu64(out512[12],q512,n[8]);
	t512[9] = _mm512_madd52lo_epu64(t512[9],q512,n[9]);
	t512[10] = _mm512_madd52hi_epu64(out512[13],q512,n[9]);
	t512[10] = _mm512_madd52lo_epu64(t512[10],q512,n[10]);
	t512[11] = _mm512_madd52hi_epu64(out512[14],q512,n[10]);
	t512[11] = _mm512_madd52lo_epu64(t512[11],q512,n[11]);
	t512[12] = _mm512_madd52hi_epu64(out512[15],q512,n[11]);
	t512[12] = _mm512_madd52lo_epu64(t512[12],q512,n[12]);
	t512[13] = _mm512_madd52hi_epu64(out512[16],q512,n[12]);
	t512[13] = _mm512_madd52lo_epu64(t512[13],q512,n[13]);
	t512[14] = _mm512_madd52hi_epu64(out512[17],q512,n[13]);
	t512[14] = _mm512_madd52lo_epu64(t512[14],q512,n[14]);
	t512[15] = _mm512_madd52hi_epu64(out512[18],q512,n[14]);
	t512[15] = _mm512_madd52lo_epu64(t512[15],q512,n[15]);
	t512[16] = _mm512_madd52hi_epu64(out512[19],q512,n[15]);
	t512[16] = _mm512_madd52lo_epu64(t512[16],q512,n[16]);
	t512[17] = _mm512_madd52hi_epu64(out512[20],q512,n[16]);
	t512[17] = _mm512_madd52lo_epu64(t512[17],q512,n[17]);
	t512[18] = _mm512_madd52hi_epu64(out512[21],q512,n[17]);
	t512[18] = _mm512_madd52lo_epu64(t512[18],q512,n[18]);
	t512[19] = _mm512_madd52hi_epu64(out512[22],q512,n[18]);
	t512[19] = _mm512_madd52lo_epu64(t512[19],q512,n[19]);
	t512[20] = _mm512_madd52hi_epu64(out512[23],q512,n[19]);

	carry  = _mm512_srli_epi64(t512[0],52);
	out512[3] = _mm512_and_si512(t512[0],mask52);
	t512[1] = _mm512_add_epi64(carry,t512[1]);
	carry  = _mm512_srli_epi64(t512[1],52);
	out512[4] = _mm512_and_si512(t512[1],mask52);
	t512[2] = _mm512_add_epi64(carry,t512[2]);
	carry  = _mm512_srli_epi64(t512[2],52);
	out512[5] = _mm512_and_si512(t512[2],mask52);
	t512[3] = _mm512_add_epi64(carry,t512[3]);
	carry  = _mm512_srli_epi64(t512[3],52);
	out512[6] = _mm512_and_si512(t512[3],mask52);
	t512[4] = _mm512_add_epi64(carry,t512[4]);
	carry  = _mm512_srli_epi64(t512[4],52);
	out512[7] = _mm512_and_si512(t512[4],mask52);
	t512[5] = _mm512_add_epi64(carry,t512[5]);
	carry  = _mm512_srli_epi64(t512[5],52);
	out512[8] = _mm512_and_si512(t512[5],mask52);
	t512[6] = _mm512_add_epi64(carry,t512[6]);
	carry  = _mm512_srli_epi64(t512[6],52);
	out512[9] = _mm512_and_si512(t512[6],mask52);
	t512[7] = _mm512_add_epi64(carry,t512[7]);
	carry  = _mm512_srli_epi64(t512[7],52);
	out512[10] = _mm512_and_si512(t512[7],mask52);
	t512[8] = _mm512_add_epi64(carry,t512[8]);
	carry  = _mm512_srli_epi64(t512[8],52);
	out512[11] = _mm512_and_si512(t512[8],mask52);
	t512[9] = _mm512_add_epi64(carry,t512[9]);
	carry  = _mm512_srli_epi64(t512[9],52);
	out512[12] = _mm512_and_si512(t512[9],mask52);
	t512[10] = _mm512_add_epi64(carry,t512[10]);
	carry  = _mm512_srli_epi64(t512[10],52);
	out512[13] = _mm512_and_si512(t512[10],mask52);
	t512[11] = _mm512_add_epi64(carry,t512[11]);
	carry  = _mm512_srli_epi64(t512[11],52);
	out512[14] = _mm512_and_si512(t512[11],mask52);
	t512[12] = _mm512_add_epi64(carry,t512[12]);
	carry  = _mm512_srli_epi64(t512[12],52);
	out512[15] = _mm512_and_si512(t512[12],mask52);
	t512[13] = _mm512_add_epi64(carry,t512[13]);
	carry  = _mm512_srli_epi64(t512[13],52);
	out512[16] = _mm512_and_si512(t512[13],mask52);
	t512[14] = _mm512_add_epi64(carry,t512[14]);
	carry  = _mm512_srli_epi64(t512[14],52);
	out512[17] = _mm512_and_si512(t512[14],mask52);
	t512[15] = _mm512_add_epi64(carry,t512[15]);
	carry  = _mm512_srli_epi64(t512[15],52);
	out512[18] = _mm512_and_si512(t512[15],mask52);
	t512[16] = _mm512_add_epi64(carry,t512[16]);
	carry  = _mm512_srli_epi64(t512[16],52);
	out512[19] = _mm512_and_si512(t512[16],mask52);
	t512[17] = _mm512_add_epi64(carry,t512[17]);
	carry  = _mm512_srli_epi64(t512[17],52);
	out512[20] = _mm512_and_si512(t512[17],mask52);
	t512[18] = _mm512_add_epi64(carry,t512[18]);
	carry  = _mm512_srli_epi64(t512[18],52);
	out512[21] = _mm512_and_si512(t512[18],mask52);
	t512[19] = _mm512_add_epi64(carry,t512[19]);
	carry  = _mm512_srli_epi64(t512[19],52);
	out512[22] = _mm512_and_si512(t512[19],mask52);
	out512[23] = _mm512_add_epi64(t512[20],carry);


	//Y = Y + a_iB

	out512[4] = _mm512_madd52lo_epu64(out512[4],a512[4],b512[0]);
	out512[5] = _mm512_madd52hi_epu64(out512[5],a512[4],b512[0]);
	out512[5] = _mm512_madd52lo_epu64(out512[5],a512[4],b512[1]);
	out512[6] = _mm512_madd52hi_epu64(out512[6],a512[4],b512[1]);
	out512[6] = _mm512_madd52lo_epu64(out512[6],a512[4],b512[2]);
	out512[7] = _mm512_madd52hi_epu64(out512[7],a512[4],b512[2]);
	out512[7] = _mm512_madd52lo_epu64(out512[7],a512[4],b512[3]);
	out512[8] = _mm512_madd52hi_epu64(out512[8],a512[4],b512[3]);
	out512[8] = _mm512_madd52lo_epu64(out512[8],a512[4],b512[4]);
	out512[9] = _mm512_madd52hi_epu64(out512[9],a512[4],b512[4]);
	out512[9] = _mm512_madd52lo_epu64(out512[9],a512[4],b512[5]);
	out512[10] = _mm512_madd52hi_epu64(out512[10],a512[4],b512[5]);
	out512[10] = _mm512_madd52lo_epu64(out512[10],a512[4],b512[6]);
	out512[11] = _mm512_madd52hi_epu64(out512[11],a512[4],b512[6]);
	out512[11] = _mm512_madd52lo_epu64(out512[11],a512[4],b512[7]);
	out512[12] = _mm512_madd52hi_epu64(out512[12],a512[4],b512[7]);
	out512[12] = _mm512_madd52lo_epu64(out512[12],a512[4],b512[8]);
	out512[13] = _mm512_madd52hi_epu64(out512[13],a512[4],b512[8]);
	out512[13] = _mm512_madd52lo_epu64(out512[13],a512[4],b512[9]);
	out512[14] = _mm512_madd52hi_epu64(out512[14],a512[4],b512[9]);
	out512[14] = _mm512_madd52lo_epu64(out512[14],a512[4],b512[10]);
	out512[15] = _mm512_madd52hi_epu64(out512[15],a512[4],b512[10]);
	out512[15] = _mm512_madd52lo_epu64(out512[15],a512[4],b512[11]);
	out512[16] = _mm512_madd52hi_epu64(out512[16],a512[4],b512[11]);
	out512[16] = _mm512_madd52lo_epu64(out512[16],a512[4],b512[12]);
	out512[17] = _mm512_madd52hi_epu64(out512[17],a512[4],b512[12]);
	out512[17] = _mm512_madd52lo_epu64(out512[17],a512[4],b512[13]);
	out512[18] = _mm512_madd52hi_epu64(out512[18],a512[4],b512[13]);
	out512[18] = _mm512_madd52lo_epu64(out512[18],a512[4],b512[14]);
	out512[19] = _mm512_madd52hi_epu64(out512[19],a512[4],b512[14]);
	out512[19] = _mm512_madd52lo_epu64(out512[19],a512[4],b512[15]);
	out512[20] = _mm512_madd52hi_epu64(out512[20],a512[4],b512[15]);
	out512[20] = _mm512_madd52lo_epu64(out512[20],a512[4],b512[16]);
	out512[21] = _mm512_madd52hi_epu64(out512[21],a512[4],b512[16]);
	out512[21] = _mm512_madd52lo_epu64(out512[21],a512[4],b512[17]);
	out512[22] = _mm512_madd52hi_epu64(out512[22],a512[4],b512[17]);
	out512[22] = _mm512_madd52lo_epu64(out512[22],a512[4],b512[18]);
	out512[23] = _mm512_madd52hi_epu64(out512[23],a512[4],b512[18]);
	out512[23] = _mm512_madd52lo_epu64(out512[23],a512[4],b512[19]);
	out512[24] = _mm512_madd52hi_epu64(zero,a512[4],b512[19]);

	q512 = _mm512_madd52lo_epu64(zero,out512[4],n_prime[0]);

	t512[0] = _mm512_madd52lo_epu64(out512[4],q512,n[0]);
	t512[1] = _mm512_madd52hi_epu64(out512[5],q512,n[0]);
	t512[1] = _mm512_madd52lo_epu64(t512[1],q512,n[1]);
	t512[2] = _mm512_madd52hi_epu64(out512[6],q512,n[1]);
	t512[2] = _mm512_madd52lo_epu64(t512[2],q512,n[2]);
	t512[3] = _mm512_madd52hi_epu64(out512[7],q512,n[2]);
	t512[3] = _mm512_madd52lo_epu64(t512[3],q512,n[3]);
	t512[4] = _mm512_madd52hi_epu64(out512[8],q512,n[3]);
	t512[4] = _mm512_madd52lo_epu64(t512[4],q512,n[4]);
	t512[5] = _mm512_madd52hi_epu64(out512[9],q512,n[4]);
	t512[5] = _mm512_madd52lo_epu64(t512[5],q512,n[5]);
	t512[6] = _mm512_madd52hi_epu64(out512[10],q512,n[5]);
	t512[6] = _mm512_madd52lo_epu64(t512[6],q512,n[6]);
	t512[7] = _mm512_madd52hi_epu64(out512[11],q512,n[6]);
	t512[7] = _mm512_madd52lo_epu64(t512[7],q512,n[7]);
	t512[8] = _mm512_madd52hi_epu64(out512[12],q512,n[7]);
	t512[8] = _mm512_madd52lo_epu64(t512[8],q512,n[8]);
	t512[9] = _mm512_madd52hi_epu64(out512[13],q512,n[8]);
	t512[9] = _mm512_madd52lo_epu64(t512[9],q512,n[9]);
	t512[10] = _mm512_madd52hi_epu64(out512[14],q512,n[9]);
	t512[10] = _mm512_madd52lo_epu64(t512[10],q512,n[10]);
	t512[11] = _mm512_madd52hi_epu64(out512[15],q512,n[10]);
	t512[11] = _mm512_madd52lo_epu64(t512[11],q512,n[11]);
	t512[12] = _mm512_madd52hi_epu64(out512[16],q512,n[11]);
	t512[12] = _mm512_madd52lo_epu64(t512[12],q512,n[12]);
	t512[13] = _mm512_madd52hi_epu64(out512[17],q512,n[12]);
	t512[13] = _mm512_madd52lo_epu64(t512[13],q512,n[13]);
	t512[14] = _mm512_madd52hi_epu64(out512[18],q512,n[13]);
	t512[14] = _mm512_madd52lo_epu64(t512[14],q512,n[14]);
	t512[15] = _mm512_madd52hi_epu64(out512[19],q512,n[14]);
	t512[15] = _mm512_madd52lo_epu64(t512[15],q512,n[15]);
	t512[16] = _mm512_madd52hi_epu64(out512[20],q512,n[15]);
	t512[16] = _mm512_madd52lo_epu64(t512[16],q512,n[16]);
	t512[17] = _mm512_madd52hi_epu64(out512[21],q512,n[16]);
	t512[17] = _mm512_madd52lo_epu64(t512[17],q512,n[17]);
	t512[18] = _mm512_madd52hi_epu64(out512[22],q512,n[17]);
	t512[18] = _mm512_madd52lo_epu64(t512[18],q512,n[18]);
	t512[19] = _mm512_madd52hi_epu64(out512[23],q512,n[18]);
	t512[19] = _mm512_madd52lo_epu64(t512[19],q512,n[19]);
	t512[20] = _mm512_madd52hi_epu64(out512[24],q512,n[19]);

	carry  = _mm512_srli_epi64(t512[0],52);
	out512[4] = _mm512_and_si512(t512[0],mask52);
	t512[1] = _mm512_add_epi64(carry,t512[1]);
	carry  = _mm512_srli_epi64(t512[1],52);
	out512[5] = _mm512_and_si512(t512[1],mask52);
	t512[2] = _mm512_add_epi64(carry,t512[2]);
	carry  = _mm512_srli_epi64(t512[2],52);
	out512[6] = _mm512_and_si512(t512[2],mask52);
	t512[3] = _mm512_add_epi64(carry,t512[3]);
	carry  = _mm512_srli_epi64(t512[3],52);
	out512[7] = _mm512_and_si512(t512[3],mask52);
	t512[4] = _mm512_add_epi64(carry,t512[4]);
	carry  = _mm512_srli_epi64(t512[4],52);
	out512[8] = _mm512_and_si512(t512[4],mask52);
	t512[5] = _mm512_add_epi64(carry,t512[5]);
	carry  = _mm512_srli_epi64(t512[5],52);
	out512[9] = _mm512_and_si512(t512[5],mask52);
	t512[6] = _mm512_add_epi64(carry,t512[6]);
	carry  = _mm512_srli_epi64(t512[6],52);
	out512[10] = _mm512_and_si512(t512[6],mask52);
	t512[7] = _mm512_add_epi64(carry,t512[7]);
	carry  = _mm512_srli_epi64(t512[7],52);
	out512[11] = _mm512_and_si512(t512[7],mask52);
	t512[8] = _mm512_add_epi64(carry,t512[8]);
	carry  = _mm512_srli_epi64(t512[8],52);
	out512[12] = _mm512_and_si512(t512[8],mask52);
	t512[9] = _mm512_add_epi64(carry,t512[9]);
	carry  = _mm512_srli_epi64(t512[9],52);
	out512[13] = _mm512_and_si512(t512[9],mask52);
	t512[10] = _mm512_add_epi64(carry,t512[10]);
	carry  = _mm512_srli_epi64(t512[10],52);
	out512[14] = _mm512_and_si512(t512[10],mask52);
	t512[11] = _mm512_add_epi64(carry,t512[11]);
	carry  = _mm512_srli_epi64(t512[11],52);
	out512[15] = _mm512_and_si512(t512[11],mask52);
	t512[12] = _mm512_add_epi64(carry,t512[12]);
	carry  = _mm512_srli_epi64(t512[12],52);
	out512[16] = _mm512_and_si512(t512[12],mask52);
	t512[13] = _mm512_add_epi64(carry,t512[13]);
	carry  = _mm512_srli_epi64(t512[13],52);
	out512[17] = _mm512_and_si512(t512[13],mask52);
	t512[14] = _mm512_add_epi64(carry,t512[14]);
	carry  = _mm512_srli_epi64(t512[14],52);
	out512[18] = _mm512_and_si512(t512[14],mask52);
	t512[15] = _mm512_add_epi64(carry,t512[15]);
	carry  = _mm512_srli_epi64(t512[15],52);
	out512[19] = _mm512_and_si512(t512[15],mask52);
	t512[16] = _mm512_add_epi64(carry,t512[16]);
	carry  = _mm512_srli_epi64(t512[16],52);
	out512[20] = _mm512_and_si512(t512[16],mask52);
	t512[17] = _mm512_add_epi64(carry,t512[17]);
	carry  = _mm512_srli_epi64(t512[17],52);
	out512[21] = _mm512_and_si512(t512[17],mask52);
	t512[18] = _mm512_add_epi64(carry,t512[18]);
	carry  = _mm512_srli_epi64(t512[18],52);
	out512[22] = _mm512_and_si512(t512[18],mask52);
	t512[19] = _mm512_add_epi64(carry,t512[19]);
	carry  = _mm512_srli_epi64(t512[19],52);
	out512[23] = _mm512_and_si512(t512[19],mask52);
	out512[24] = _mm512_add_epi64(t512[20],carry);


	//Y = Y + a_iB

	out512[5] = _mm512_madd52lo_epu64(out512[5],a512[5],b512[0]);
	out512[6] = _mm512_madd52hi_epu64(out512[6],a512[5],b512[0]);
	out512[6] = _mm512_madd52lo_epu64(out512[6],a512[5],b512[1]);
	out512[7] = _mm512_madd52hi_epu64(out512[7],a512[5],b512[1]);
	out512[7] = _mm512_madd52lo_epu64(out512[7],a512[5],b512[2]);
	out512[8] = _mm512_madd52hi_epu64(out512[8],a512[5],b512[2]);
	out512[8] = _mm512_madd52lo_epu64(out512[8],a512[5],b512[3]);
	out512[9] = _mm512_madd52hi_epu64(out512[9],a512[5],b512[3]);
	out512[9] = _mm512_madd52lo_epu64(out512[9],a512[5],b512[4]);
	out512[10] = _mm512_madd52hi_epu64(out512[10],a512[5],b512[4]);
	out512[10] = _mm512_madd52lo_epu64(out512[10],a512[5],b512[5]);
	out512[11] = _mm512_madd52hi_epu64(out512[11],a512[5],b512[5]);
	out512[11] = _mm512_madd52lo_epu64(out512[11],a512[5],b512[6]);
	out512[12] = _mm512_madd52hi_epu64(out512[12],a512[5],b512[6]);
	out512[12] = _mm512_madd52lo_epu64(out512[12],a512[5],b512[7]);
	out512[13] = _mm512_madd52hi_epu64(out512[13],a512[5],b512[7]);
	out512[13] = _mm512_madd52lo_epu64(out512[13],a512[5],b512[8]);
	out512[14] = _mm512_madd52hi_epu64(out512[14],a512[5],b512[8]);
	out512[14] = _mm512_madd52lo_epu64(out512[14],a512[5],b512[9]);
	out512[15] = _mm512_madd52hi_epu64(out512[15],a512[5],b512[9]);
	out512[15] = _mm512_madd52lo_epu64(out512[15],a512[5],b512[10]);
	out512[16] = _mm512_madd52hi_epu64(out512[16],a512[5],b512[10]);
	out512[16] = _mm512_madd52lo_epu64(out512[16],a512[5],b512[11]);
	out512[17] = _mm512_madd52hi_epu64(out512[17],a512[5],b512[11]);
	out512[17] = _mm512_madd52lo_epu64(out512[17],a512[5],b512[12]);
	out512[18] = _mm512_madd52hi_epu64(out512[18],a512[5],b512[12]);
	out512[18] = _mm512_madd52lo_epu64(out512[18],a512[5],b512[13]);
	out512[19] = _mm512_madd52hi_epu64(out512[19],a512[5],b512[13]);
	out512[19] = _mm512_madd52lo_epu64(out512[19],a512[5],b512[14]);
	out512[20] = _mm512_madd52hi_epu64(out512[20],a512[5],b512[14]);
	out512[20] = _mm512_madd52lo_epu64(out512[20],a512[5],b512[15]);
	out512[21] = _mm512_madd52hi_epu64(out512[21],a512[5],b512[15]);
	out512[21] = _mm512_madd52lo_epu64(out512[21],a512[5],b512[16]);
	out512[22] = _mm512_madd52hi_epu64(out512[22],a512[5],b512[16]);
	out512[22] = _mm512_madd52lo_epu64(out512[22],a512[5],b512[17]);
	out512[23] = _mm512_madd52hi_epu64(out512[23],a512[5],b512[17]);
	out512[23] = _mm512_madd52lo_epu64(out512[23],a512[5],b512[18]);
	out512[24] = _mm512_madd52hi_epu64(out512[24],a512[5],b512[18]);
	out512[24] = _mm512_madd52lo_epu64(out512[24],a512[5],b512[19]);
	out512[25] = _mm512_madd52hi_epu64(zero,a512[5],b512[19]);

	q512 = _mm512_madd52lo_epu64(zero,out512[5],n_prime[0]);

	t512[0] = _mm512_madd52lo_epu64(out512[5],q512,n[0]);
	t512[1] = _mm512_madd52hi_epu64(out512[6],q512,n[0]);
	t512[1] = _mm512_madd52lo_epu64(t512[1],q512,n[1]);
	t512[2] = _mm512_madd52hi_epu64(out512[7],q512,n[1]);
	t512[2] = _mm512_madd52lo_epu64(t512[2],q512,n[2]);
	t512[3] = _mm512_madd52hi_epu64(out512[8],q512,n[2]);
	t512[3] = _mm512_madd52lo_epu64(t512[3],q512,n[3]);
	t512[4] = _mm512_madd52hi_epu64(out512[9],q512,n[3]);
	t512[4] = _mm512_madd52lo_epu64(t512[4],q512,n[4]);
	t512[5] = _mm512_madd52hi_epu64(out512[10],q512,n[4]);
	t512[5] = _mm512_madd52lo_epu64(t512[5],q512,n[5]);
	t512[6] = _mm512_madd52hi_epu64(out512[11],q512,n[5]);
	t512[6] = _mm512_madd52lo_epu64(t512[6],q512,n[6]);
	t512[7] = _mm512_madd52hi_epu64(out512[12],q512,n[6]);
	t512[7] = _mm512_madd52lo_epu64(t512[7],q512,n[7]);
	t512[8] = _mm512_madd52hi_epu64(out512[13],q512,n[7]);
	t512[8] = _mm512_madd52lo_epu64(t512[8],q512,n[8]);
	t512[9] = _mm512_madd52hi_epu64(out512[14],q512,n[8]);
	t512[9] = _mm512_madd52lo_epu64(t512[9],q512,n[9]);
	t512[10] = _mm512_madd52hi_epu64(out512[15],q512,n[9]);
	t512[10] = _mm512_madd52lo_epu64(t512[10],q512,n[10]);
	t512[11] = _mm512_madd52hi_epu64(out512[16],q512,n[10]);
	t512[11] = _mm512_madd52lo_epu64(t512[11],q512,n[11]);
	t512[12] = _mm512_madd52hi_epu64(out512[17],q512,n[11]);
	t512[12] = _mm512_madd52lo_epu64(t512[12],q512,n[12]);
	t512[13] = _mm512_madd52hi_epu64(out512[18],q512,n[12]);
	t512[13] = _mm512_madd52lo_epu64(t512[13],q512,n[13]);
	t512[14] = _mm512_madd52hi_epu64(out512[19],q512,n[13]);
	t512[14] = _mm512_madd52lo_epu64(t512[14],q512,n[14]);
	t512[15] = _mm512_madd52hi_epu64(out512[20],q512,n[14]);
	t512[15] = _mm512_madd52lo_epu64(t512[15],q512,n[15]);
	t512[16] = _mm512_madd52hi_epu64(out512[21],q512,n[15]);
	t512[16] = _mm512_madd52lo_epu64(t512[16],q512,n[16]);
	t512[17] = _mm512_madd52hi_epu64(out512[22],q512,n[16]);
	t512[17] = _mm512_madd52lo_epu64(t512[17],q512,n[17]);
	t512[18] = _mm512_madd52hi_epu64(out512[23],q512,n[17]);
	t512[18] = _mm512_madd52lo_epu64(t512[18],q512,n[18]);
	t512[19] = _mm512_madd52hi_epu64(out512[24],q512,n[18]);
	t512[19] = _mm512_madd52lo_epu64(t512[19],q512,n[19]);
	t512[20] = _mm512_madd52hi_epu64(out512[25],q512,n[19]);

	carry  = _mm512_srli_epi64(t512[0],52);
	out512[5] = _mm512_and_si512(t512[0],mask52);
	t512[1] = _mm512_add_epi64(carry,t512[1]);
	carry  = _mm512_srli_epi64(t512[1],52);
	out512[6] = _mm512_and_si512(t512[1],mask52);
	t512[2] = _mm512_add_epi64(carry,t512[2]);
	carry  = _mm512_srli_epi64(t512[2],52);
	out512[7] = _mm512_and_si512(t512[2],mask52);
	t512[3] = _mm512_add_epi64(carry,t512[3]);
	carry  = _mm512_srli_epi64(t512[3],52);
	out512[8] = _mm512_and_si512(t512[3],mask52);
	t512[4] = _mm512_add_epi64(carry,t512[4]);
	carry  = _mm512_srli_epi64(t512[4],52);
	out512[9] = _mm512_and_si512(t512[4],mask52);
	t512[5] = _mm512_add_epi64(carry,t512[5]);
	carry  = _mm512_srli_epi64(t512[5],52);
	out512[10] = _mm512_and_si512(t512[5],mask52);
	t512[6] = _mm512_add_epi64(carry,t512[6]);
	carry  = _mm512_srli_epi64(t512[6],52);
	out512[11] = _mm512_and_si512(t512[6],mask52);
	t512[7] = _mm512_add_epi64(carry,t512[7]);
	carry  = _mm512_srli_epi64(t512[7],52);
	out512[12] = _mm512_and_si512(t512[7],mask52);
	t512[8] = _mm512_add_epi64(carry,t512[8]);
	carry  = _mm512_srli_epi64(t512[8],52);
	out512[13] = _mm512_and_si512(t512[8],mask52);
	t512[9] = _mm512_add_epi64(carry,t512[9]);
	carry  = _mm512_srli_epi64(t512[9],52);
	out512[14] = _mm512_and_si512(t512[9],mask52);
	t512[10] = _mm512_add_epi64(carry,t512[10]);
	carry  = _mm512_srli_epi64(t512[10],52);
	out512[15] = _mm512_and_si512(t512[10],mask52);
	t512[11] = _mm512_add_epi64(carry,t512[11]);
	carry  = _mm512_srli_epi64(t512[11],52);
	out512[16] = _mm512_and_si512(t512[11],mask52);
	t512[12] = _mm512_add_epi64(carry,t512[12]);
	carry  = _mm512_srli_epi64(t512[12],52);
	out512[17] = _mm512_and_si512(t512[12],mask52);
	t512[13] = _mm512_add_epi64(carry,t512[13]);
	carry  = _mm512_srli_epi64(t512[13],52);
	out512[18] = _mm512_and_si512(t512[13],mask52);
	t512[14] = _mm512_add_epi64(carry,t512[14]);
	carry  = _mm512_srli_epi64(t512[14],52);
	out512[19] = _mm512_and_si512(t512[14],mask52);
	t512[15] = _mm512_add_epi64(carry,t512[15]);
	carry  = _mm512_srli_epi64(t512[15],52);
	out512[20] = _mm512_and_si512(t512[15],mask52);
	t512[16] = _mm512_add_epi64(carry,t512[16]);
	carry  = _mm512_srli_epi64(t512[16],52);
	out512[21] = _mm512_and_si512(t512[16],mask52);
	t512[17] = _mm512_add_epi64(carry,t512[17]);
	carry  = _mm512_srli_epi64(t512[17],52);
	out512[22] = _mm512_and_si512(t512[17],mask52);
	t512[18] = _mm512_add_epi64(carry,t512[18]);
	carry  = _mm512_srli_epi64(t512[18],52);
	out512[23] = _mm512_and_si512(t512[18],mask52);
	t512[19] = _mm512_add_epi64(carry,t512[19]);
	carry  = _mm512_srli_epi64(t512[19],52);
	out512[24] = _mm512_and_si512(t512[19],mask52);
	out512[25] = _mm512_add_epi64(t512[20],carry);


	//Y = Y + a_iB

	out512[6] = _mm512_madd52lo_epu64(out512[6],a512[6],b512[0]);
	out512[7] = _mm512_madd52hi_epu64(out512[7],a512[6],b512[0]);
	out512[7] = _mm512_madd52lo_epu64(out512[7],a512[6],b512[1]);
	out512[8] = _mm512_madd52hi_epu64(out512[8],a512[6],b512[1]);
	out512[8] = _mm512_madd52lo_epu64(out512[8],a512[6],b512[2]);
	out512[9] = _mm512_madd52hi_epu64(out512[9],a512[6],b512[2]);
	out512[9] = _mm512_madd52lo_epu64(out512[9],a512[6],b512[3]);
	out512[10] = _mm512_madd52hi_epu64(out512[10],a512[6],b512[3]);
	out512[10] = _mm512_madd52lo_epu64(out512[10],a512[6],b512[4]);
	out512[11] = _mm512_madd52hi_epu64(out512[11],a512[6],b512[4]);
	out512[11] = _mm512_madd52lo_epu64(out512[11],a512[6],b512[5]);
	out512[12] = _mm512_madd52hi_epu64(out512[12],a512[6],b512[5]);
	out512[12] = _mm512_madd52lo_epu64(out512[12],a512[6],b512[6]);
	out512[13] = _mm512_madd52hi_epu64(out512[13],a512[6],b512[6]);
	out512[13] = _mm512_madd52lo_epu64(out512[13],a512[6],b512[7]);
	out512[14] = _mm512_madd52hi_epu64(out512[14],a512[6],b512[7]);
	out512[14] = _mm512_madd52lo_epu64(out512[14],a512[6],b512[8]);
	out512[15] = _mm512_madd52hi_epu64(out512[15],a512[6],b512[8]);
	out512[15] = _mm512_madd52lo_epu64(out512[15],a512[6],b512[9]);
	out512[16] = _mm512_madd52hi_epu64(out512[16],a512[6],b512[9]);
	out512[16] = _mm512_madd52lo_epu64(out512[16],a512[6],b512[10]);
	out512[17] = _mm512_madd52hi_epu64(out512[17],a512[6],b512[10]);
	out512[17] = _mm512_madd52lo_epu64(out512[17],a512[6],b512[11]);
	out512[18] = _mm512_madd52hi_epu64(out512[18],a512[6],b512[11]);
	out512[18] = _mm512_madd52lo_epu64(out512[18],a512[6],b512[12]);
	out512[19] = _mm512_madd52hi_epu64(out512[19],a512[6],b512[12]);
	out512[19] = _mm512_madd52lo_epu64(out512[19],a512[6],b512[13]);
	out512[20] = _mm512_madd52hi_epu64(out512[20],a512[6],b512[13]);
	out512[20] = _mm512_madd52lo_epu64(out512[20],a512[6],b512[14]);
	out512[21] = _mm512_madd52hi_epu64(out512[21],a512[6],b512[14]);
	out512[21] = _mm512_madd52lo_epu64(out512[21],a512[6],b512[15]);
	out512[22] = _mm512_madd52hi_epu64(out512[22],a512[6],b512[15]);
	out512[22] = _mm512_madd52lo_epu64(out512[22],a512[6],b512[16]);
	out512[23] = _mm512_madd52hi_epu64(out512[23],a512[6],b512[16]);
	out512[23] = _mm512_madd52lo_epu64(out512[23],a512[6],b512[17]);
	out512[24] = _mm512_madd52hi_epu64(out512[24],a512[6],b512[17]);
	out512[24] = _mm512_madd52lo_epu64(out512[24],a512[6],b512[18]);
	out512[25] = _mm512_madd52hi_epu64(out512[25],a512[6],b512[18]);
	out512[25] = _mm512_madd52lo_epu64(out512[25],a512[6],b512[19]);
	out512[26] = _mm512_madd52hi_epu64(zero,a512[6],b512[19]);

	q512 = _mm512_madd52lo_epu64(zero,out512[6],n_prime[0]);

	t512[0] = _mm512_madd52lo_epu64(out512[6],q512,n[0]);
	t512[1] = _mm512_madd52hi_epu64(out512[7],q512,n[0]);
	t512[1] = _mm512_madd52lo_epu64(t512[1],q512,n[1]);
	t512[2] = _mm512_madd52hi_epu64(out512[8],q512,n[1]);
	t512[2] = _mm512_madd52lo_epu64(t512[2],q512,n[2]);
	t512[3] = _mm512_madd52hi_epu64(out512[9],q512,n[2]);
	t512[3] = _mm512_madd52lo_epu64(t512[3],q512,n[3]);
	t512[4] = _mm512_madd52hi_epu64(out512[10],q512,n[3]);
	t512[4] = _mm512_madd52lo_epu64(t512[4],q512,n[4]);
	t512[5] = _mm512_madd52hi_epu64(out512[11],q512,n[4]);
	t512[5] = _mm512_madd52lo_epu64(t512[5],q512,n[5]);
	t512[6] = _mm512_madd52hi_epu64(out512[12],q512,n[5]);
	t512[6] = _mm512_madd52lo_epu64(t512[6],q512,n[6]);
	t512[7] = _mm512_madd52hi_epu64(out512[13],q512,n[6]);
	t512[7] = _mm512_madd52lo_epu64(t512[7],q512,n[7]);
	t512[8] = _mm512_madd52hi_epu64(out512[14],q512,n[7]);
	t512[8] = _mm512_madd52lo_epu64(t512[8],q512,n[8]);
	t512[9] = _mm512_madd52hi_epu64(out512[15],q512,n[8]);
	t512[9] = _mm512_madd52lo_epu64(t512[9],q512,n[9]);
	t512[10] = _mm512_madd52hi_epu64(out512[16],q512,n[9]);
	t512[10] = _mm512_madd52lo_epu64(t512[10],q512,n[10]);
	t512[11] = _mm512_madd52hi_epu64(out512[17],q512,n[10]);
	t512[11] = _mm512_madd52lo_epu64(t512[11],q512,n[11]);
	t512[12] = _mm512_madd52hi_epu64(out512[18],q512,n[11]);
	t512[12] = _mm512_madd52lo_epu64(t512[12],q512,n[12]);
	t512[13] = _mm512_madd52hi_epu64(out512[19],q512,n[12]);
	t512[13] = _mm512_madd52lo_epu64(t512[13],q512,n[13]);
	t512[14] = _mm512_madd52hi_epu64(out512[20],q512,n[13]);
	t512[14] = _mm512_madd52lo_epu64(t512[14],q512,n[14]);
	t512[15] = _mm512_madd52hi_epu64(out512[21],q512,n[14]);
	t512[15] = _mm512_madd52lo_epu64(t512[15],q512,n[15]);
	t512[16] = _mm512_madd52hi_epu64(out512[22],q512,n[15]);
	t512[16] = _mm512_madd52lo_epu64(t512[16],q512,n[16]);
	t512[17] = _mm512_madd52hi_epu64(out512[23],q512,n[16]);
	t512[17] = _mm512_madd52lo_epu64(t512[17],q512,n[17]);
	t512[18] = _mm512_madd52hi_epu64(out512[24],q512,n[17]);
	t512[18] = _mm512_madd52lo_epu64(t512[18],q512,n[18]);
	t512[19] = _mm512_madd52hi_epu64(out512[25],q512,n[18]);
	t512[19] = _mm512_madd52lo_epu64(t512[19],q512,n[19]);
	t512[20] = _mm512_madd52hi_epu64(out512[26],q512,n[19]);

	carry  = _mm512_srli_epi64(t512[0],52);
	out512[6] = _mm512_and_si512(t512[0],mask52);
	t512[1] = _mm512_add_epi64(carry,t512[1]);
	carry  = _mm512_srli_epi64(t512[1],52);
	out512[7] = _mm512_and_si512(t512[1],mask52);
	t512[2] = _mm512_add_epi64(carry,t512[2]);
	carry  = _mm512_srli_epi64(t512[2],52);
	out512[8] = _mm512_and_si512(t512[2],mask52);
	t512[3] = _mm512_add_epi64(carry,t512[3]);
	carry  = _mm512_srli_epi64(t512[3],52);
	out512[9] = _mm512_and_si512(t512[3],mask52);
	t512[4] = _mm512_add_epi64(carry,t512[4]);
	carry  = _mm512_srli_epi64(t512[4],52);
	out512[10] = _mm512_and_si512(t512[4],mask52);
	t512[5] = _mm512_add_epi64(carry,t512[5]);
	carry  = _mm512_srli_epi64(t512[5],52);
	out512[11] = _mm512_and_si512(t512[5],mask52);
	t512[6] = _mm512_add_epi64(carry,t512[6]);
	carry  = _mm512_srli_epi64(t512[6],52);
	out512[12] = _mm512_and_si512(t512[6],mask52);
	t512[7] = _mm512_add_epi64(carry,t512[7]);
	carry  = _mm512_srli_epi64(t512[7],52);
	out512[13] = _mm512_and_si512(t512[7],mask52);
	t512[8] = _mm512_add_epi64(carry,t512[8]);
	carry  = _mm512_srli_epi64(t512[8],52);
	out512[14] = _mm512_and_si512(t512[8],mask52);
	t512[9] = _mm512_add_epi64(carry,t512[9]);
	carry  = _mm512_srli_epi64(t512[9],52);
	out512[15] = _mm512_and_si512(t512[9],mask52);
	t512[10] = _mm512_add_epi64(carry,t512[10]);
	carry  = _mm512_srli_epi64(t512[10],52);
	out512[16] = _mm512_and_si512(t512[10],mask52);
	t512[11] = _mm512_add_epi64(carry,t512[11]);
	carry  = _mm512_srli_epi64(t512[11],52);
	out512[17] = _mm512_and_si512(t512[11],mask52);
	t512[12] = _mm512_add_epi64(carry,t512[12]);
	carry  = _mm512_srli_epi64(t512[12],52);
	out512[18] = _mm512_and_si512(t512[12],mask52);
	t512[13] = _mm512_add_epi64(carry,t512[13]);
	carry  = _mm512_srli_epi64(t512[13],52);
	out512[19] = _mm512_and_si512(t512[13],mask52);
	t512[14] = _mm512_add_epi64(carry,t512[14]);
	carry  = _mm512_srli_epi64(t512[14],52);
	out512[20] = _mm512_and_si512(t512[14],mask52);
	t512[15] = _mm512_add_epi64(carry,t512[15]);
	carry  = _mm512_srli_epi64(t512[15],52);
	out512[21] = _mm512_and_si512(t512[15],mask52);
	t512[16] = _mm512_add_epi64(carry,t512[16]);
	carry  = _mm512_srli_epi64(t512[16],52);
	out512[22] = _mm512_and_si512(t512[16],mask52);
	t512[17] = _mm512_add_epi64(carry,t512[17]);
	carry  = _mm512_srli_epi64(t512[17],52);
	out512[23] = _mm512_and_si512(t512[17],mask52);
	t512[18] = _mm512_add_epi64(carry,t512[18]);
	carry  = _mm512_srli_epi64(t512[18],52);
	out512[24] = _mm512_and_si512(t512[18],mask52);
	t512[19] = _mm512_add_epi64(carry,t512[19]);
	carry  = _mm512_srli_epi64(t512[19],52);
	out512[25] = _mm512_and_si512(t512[19],mask52);
	out512[26] = _mm512_add_epi64(t512[20],carry);


	//Y = Y + a_iB

	out512[7] = _mm512_madd52lo_epu64(out512[7],a512[7],b512[0]);
	out512[8] = _mm512_madd52hi_epu64(out512[8],a512[7],b512[0]);
	out512[8] = _mm512_madd52lo_epu64(out512[8],a512[7],b512[1]);
	out512[9] = _mm512_madd52hi_epu64(out512[9],a512[7],b512[1]);
	out512[9] = _mm512_madd52lo_epu64(out512[9],a512[7],b512[2]);
	out512[10] = _mm512_madd52hi_epu64(out512[10],a512[7],b512[2]);
	out512[10] = _mm512_madd52lo_epu64(out512[10],a512[7],b512[3]);
	out512[11] = _mm512_madd52hi_epu64(out512[11],a512[7],b512[3]);
	out512[11] = _mm512_madd52lo_epu64(out512[11],a512[7],b512[4]);
	out512[12] = _mm512_madd52hi_epu64(out512[12],a512[7],b512[4]);
	out512[12] = _mm512_madd52lo_epu64(out512[12],a512[7],b512[5]);
	out512[13] = _mm512_madd52hi_epu64(out512[13],a512[7],b512[5]);
	out512[13] = _mm512_madd52lo_epu64(out512[13],a512[7],b512[6]);
	out512[14] = _mm512_madd52hi_epu64(out512[14],a512[7],b512[6]);
	out512[14] = _mm512_madd52lo_epu64(out512[14],a512[7],b512[7]);
	out512[15] = _mm512_madd52hi_epu64(out512[15],a512[7],b512[7]);
	out512[15] = _mm512_madd52lo_epu64(out512[15],a512[7],b512[8]);
	out512[16] = _mm512_madd52hi_epu64(out512[16],a512[7],b512[8]);
	out512[16] = _mm512_madd52lo_epu64(out512[16],a512[7],b512[9]);
	out512[17] = _mm512_madd52hi_epu64(out512[17],a512[7],b512[9]);
	out512[17] = _mm512_madd52lo_epu64(out512[17],a512[7],b512[10]);
	out512[18] = _mm512_madd52hi_epu64(out512[18],a512[7],b512[10]);
	out512[18] = _mm512_madd52lo_epu64(out512[18],a512[7],b512[11]);
	out512[19] = _mm512_madd52hi_epu64(out512[19],a512[7],b512[11]);
	out512[19] = _mm512_madd52lo_epu64(out512[19],a512[7],b512[12]);
	out512[20] = _mm512_madd52hi_epu64(out512[20],a512[7],b512[12]);
	out512[20] = _mm512_madd52lo_epu64(out512[20],a512[7],b512[13]);
	out512[21] = _mm512_madd52hi_epu64(out512[21],a512[7],b512[13]);
	out512[21] = _mm512_madd52lo_epu64(out512[21],a512[7],b512[14]);
	out512[22] = _mm512_madd52hi_epu64(out512[22],a512[7],b512[14]);
	out512[22] = _mm512_madd52lo_epu64(out512[22],a512[7],b512[15]);
	out512[23] = _mm512_madd52hi_epu64(out512[23],a512[7],b512[15]);
	out512[23] = _mm512_madd52lo_epu64(out512[23],a512[7],b512[16]);
	out512[24] = _mm512_madd52hi_epu64(out512[24],a512[7],b512[16]);
	out512[24] = _mm512_madd52lo_epu64(out512[24],a512[7],b512[17]);
	out512[25] = _mm512_madd52hi_epu64(out512[25],a512[7],b512[17]);
	out512[25] = _mm512_madd52lo_epu64(out512[25],a512[7],b512[18]);
	out512[26] = _mm512_madd52hi_epu64(out512[26],a512[7],b512[18]);
	out512[26] = _mm512_madd52lo_epu64(out512[26],a512[7],b512[19]);
	out512[27] = _mm512_madd52hi_epu64(zero,a512[7],b512[19]);

	q512 = _mm512_madd52lo_epu64(zero,out512[7],n_prime[0]);

	t512[0] = _mm512_madd52lo_epu64(out512[7],q512,n[0]);
	t512[1] = _mm512_madd52hi_epu64(out512[8],q512,n[0]);
	t512[1] = _mm512_madd52lo_epu64(t512[1],q512,n[1]);
	t512[2] = _mm512_madd52hi_epu64(out512[9],q512,n[1]);
	t512[2] = _mm512_madd52lo_epu64(t512[2],q512,n[2]);
	t512[3] = _mm512_madd52hi_epu64(out512[10],q512,n[2]);
	t512[3] = _mm512_madd52lo_epu64(t512[3],q512,n[3]);
	t512[4] = _mm512_madd52hi_epu64(out512[11],q512,n[3]);
	t512[4] = _mm512_madd52lo_epu64(t512[4],q512,n[4]);
	t512[5] = _mm512_madd52hi_epu64(out512[12],q512,n[4]);
	t512[5] = _mm512_madd52lo_epu64(t512[5],q512,n[5]);
	t512[6] = _mm512_madd52hi_epu64(out512[13],q512,n[5]);
	t512[6] = _mm512_madd52lo_epu64(t512[6],q512,n[6]);
	t512[7] = _mm512_madd52hi_epu64(out512[14],q512,n[6]);
	t512[7] = _mm512_madd52lo_epu64(t512[7],q512,n[7]);
	t512[8] = _mm512_madd52hi_epu64(out512[15],q512,n[7]);
	t512[8] = _mm512_madd52lo_epu64(t512[8],q512,n[8]);
	t512[9] = _mm512_madd52hi_epu64(out512[16],q512,n[8]);
	t512[9] = _mm512_madd52lo_epu64(t512[9],q512,n[9]);
	t512[10] = _mm512_madd52hi_epu64(out512[17],q512,n[9]);
	t512[10] = _mm512_madd52lo_epu64(t512[10],q512,n[10]);
	t512[11] = _mm512_madd52hi_epu64(out512[18],q512,n[10]);
	t512[11] = _mm512_madd52lo_epu64(t512[11],q512,n[11]);
	t512[12] = _mm512_madd52hi_epu64(out512[19],q512,n[11]);
	t512[12] = _mm512_madd52lo_epu64(t512[12],q512,n[12]);
	t512[13] = _mm512_madd52hi_epu64(out512[20],q512,n[12]);
	t512[13] = _mm512_madd52lo_epu64(t512[13],q512,n[13]);
	t512[14] = _mm512_madd52hi_epu64(out512[21],q512,n[13]);
	t512[14] = _mm512_madd52lo_epu64(t512[14],q512,n[14]);
	t512[15] = _mm512_madd52hi_epu64(out512[22],q512,n[14]);
	t512[15] = _mm512_madd52lo_epu64(t512[15],q512,n[15]);
	t512[16] = _mm512_madd52hi_epu64(out512[23],q512,n[15]);
	t512[16] = _mm512_madd52lo_epu64(t512[16],q512,n[16]);
	t512[17] = _mm512_madd52hi_epu64(out512[24],q512,n[16]);
	t512[17] = _mm512_madd52lo_epu64(t512[17],q512,n[17]);
	t512[18] = _mm512_madd52hi_epu64(out512[25],q512,n[17]);
	t512[18] = _mm512_madd52lo_epu64(t512[18],q512,n[18]);
	t512[19] = _mm512_madd52hi_epu64(out512[26],q512,n[18]);
	t512[19] = _mm512_madd52lo_epu64(t512[19],q512,n[19]);
	t512[20] = _mm512_madd52hi_epu64(out512[27],q512,n[19]);

	carry  = _mm512_srli_epi64(t512[0],52);
	out512[7] = _mm512_and_si512(t512[0],mask52);
	t512[1] = _mm512_add_epi64(carry,t512[1]);
	carry  = _mm512_srli_epi64(t512[1],52);
	out512[8] = _mm512_and_si512(t512[1],mask52);
	t512[2] = _mm512_add_epi64(carry,t512[2]);
	carry  = _mm512_srli_epi64(t512[2],52);
	out512[9] = _mm512_and_si512(t512[2],mask52);
	t512[3] = _mm512_add_epi64(carry,t512[3]);
	carry  = _mm512_srli_epi64(t512[3],52);
	out512[10] = _mm512_and_si512(t512[3],mask52);
	t512[4] = _mm512_add_epi64(carry,t512[4]);
	carry  = _mm512_srli_epi64(t512[4],52);
	out512[11] = _mm512_and_si512(t512[4],mask52);
	t512[5] = _mm512_add_epi64(carry,t512[5]);
	carry  = _mm512_srli_epi64(t512[5],52);
	out512[12] = _mm512_and_si512(t512[5],mask52);
	t512[6] = _mm512_add_epi64(carry,t512[6]);
	carry  = _mm512_srli_epi64(t512[6],52);
	out512[13] = _mm512_and_si512(t512[6],mask52);
	t512[7] = _mm512_add_epi64(carry,t512[7]);
	carry  = _mm512_srli_epi64(t512[7],52);
	out512[14] = _mm512_and_si512(t512[7],mask52);
	t512[8] = _mm512_add_epi64(carry,t512[8]);
	carry  = _mm512_srli_epi64(t512[8],52);
	out512[15] = _mm512_and_si512(t512[8],mask52);
	t512[9] = _mm512_add_epi64(carry,t512[9]);
	carry  = _mm512_srli_epi64(t512[9],52);
	out512[16] = _mm512_and_si512(t512[9],mask52);
	t512[10] = _mm512_add_epi64(carry,t512[10]);
	carry  = _mm512_srli_epi64(t512[10],52);
	out512[17] = _mm512_and_si512(t512[10],mask52);
	t512[11] = _mm512_add_epi64(carry,t512[11]);
	carry  = _mm512_srli_epi64(t512[11],52);
	out512[18] = _mm512_and_si512(t512[11],mask52);
	t512[12] = _mm512_add_epi64(carry,t512[12]);
	carry  = _mm512_srli_epi64(t512[12],52);
	out512[19] = _mm512_and_si512(t512[12],mask52);
	t512[13] = _mm512_add_epi64(carry,t512[13]);
	carry  = _mm512_srli_epi64(t512[13],52);
	out512[20] = _mm512_and_si512(t512[13],mask52);
	t512[14] = _mm512_add_epi64(carry,t512[14]);
	carry  = _mm512_srli_epi64(t512[14],52);
	out512[21] = _mm512_and_si512(t512[14],mask52);
	t512[15] = _mm512_add_epi64(carry,t512[15]);
	carry  = _mm512_srli_epi64(t512[15],52);
	out512[22] = _mm512_and_si512(t512[15],mask52);
	t512[16] = _mm512_add_epi64(carry,t512[16]);
	carry  = _mm512_srli_epi64(t512[16],52);
	out512[23] = _mm512_and_si512(t512[16],mask52);
	t512[17] = _mm512_add_epi64(carry,t512[17]);
	carry  = _mm512_srli_epi64(t512[17],52);
	out512[24] = _mm512_and_si512(t512[17],mask52);
	t512[18] = _mm512_add_epi64(carry,t512[18]);
	carry  = _mm512_srli_epi64(t512[18],52);
	out512[25] = _mm512_and_si512(t512[18],mask52);
	t512[19] = _mm512_add_epi64(carry,t512[19]);
	carry  = _mm512_srli_epi64(t512[19],52);
	out512[26] = _mm512_and_si512(t512[19],mask52);
	out512[27] = _mm512_add_epi64(t512[20],carry);


	//Y = Y + a_iB

	out512[8] = _mm512_madd52lo_epu64(out512[8],a512[8],b512[0]);
	out512[9] = _mm512_madd52hi_epu64(out512[9],a512[8],b512[0]);
	out512[9] = _mm512_madd52lo_epu64(out512[9],a512[8],b512[1]);
	out512[10] = _mm512_madd52hi_epu64(out512[10],a512[8],b512[1]);
	out512[10] = _mm512_madd52lo_epu64(out512[10],a512[8],b512[2]);
	out512[11] = _mm512_madd52hi_epu64(out512[11],a512[8],b512[2]);
	out512[11] = _mm512_madd52lo_epu64(out512[11],a512[8],b512[3]);
	out512[12] = _mm512_madd52hi_epu64(out512[12],a512[8],b512[3]);
	out512[12] = _mm512_madd52lo_epu64(out512[12],a512[8],b512[4]);
	out512[13] = _mm512_madd52hi_epu64(out512[13],a512[8],b512[4]);
	out512[13] = _mm512_madd52lo_epu64(out512[13],a512[8],b512[5]);
	out512[14] = _mm512_madd52hi_epu64(out512[14],a512[8],b512[5]);
	out512[14] = _mm512_madd52lo_epu64(out512[14],a512[8],b512[6]);
	out512[15] = _mm512_madd52hi_epu64(out512[15],a512[8],b512[6]);
	out512[15] = _mm512_madd52lo_epu64(out512[15],a512[8],b512[7]);
	out512[16] = _mm512_madd52hi_epu64(out512[16],a512[8],b512[7]);
	out512[16] = _mm512_madd52lo_epu64(out512[16],a512[8],b512[8]);
	out512[17] = _mm512_madd52hi_epu64(out512[17],a512[8],b512[8]);
	out512[17] = _mm512_madd52lo_epu64(out512[17],a512[8],b512[9]);
	out512[18] = _mm512_madd52hi_epu64(out512[18],a512[8],b512[9]);
	out512[18] = _mm512_madd52lo_epu64(out512[18],a512[8],b512[10]);
	out512[19] = _mm512_madd52hi_epu64(out512[19],a512[8],b512[10]);
	out512[19] = _mm512_madd52lo_epu64(out512[19],a512[8],b512[11]);
	out512[20] = _mm512_madd52hi_epu64(out512[20],a512[8],b512[11]);
	out512[20] = _mm512_madd52lo_epu64(out512[20],a512[8],b512[12]);
	out512[21] = _mm512_madd52hi_epu64(out512[21],a512[8],b512[12]);
	out512[21] = _mm512_madd52lo_epu64(out512[21],a512[8],b512[13]);
	out512[22] = _mm512_madd52hi_epu64(out512[22],a512[8],b512[13]);
	out512[22] = _mm512_madd52lo_epu64(out512[22],a512[8],b512[14]);
	out512[23] = _mm512_madd52hi_epu64(out512[23],a512[8],b512[14]);
	out512[23] = _mm512_madd52lo_epu64(out512[23],a512[8],b512[15]);
	out512[24] = _mm512_madd52hi_epu64(out512[24],a512[8],b512[15]);
	out512[24] = _mm512_madd52lo_epu64(out512[24],a512[8],b512[16]);
	out512[25] = _mm512_madd52hi_epu64(out512[25],a512[8],b512[16]);
	out512[25] = _mm512_madd52lo_epu64(out512[25],a512[8],b512[17]);
	out512[26] = _mm512_madd52hi_epu64(out512[26],a512[8],b512[17]);
	out512[26] = _mm512_madd52lo_epu64(out512[26],a512[8],b512[18]);
	out512[27] = _mm512_madd52hi_epu64(out512[27],a512[8],b512[18]);
	out512[27] = _mm512_madd52lo_epu64(out512[27],a512[8],b512[19]);
	out512[28] = _mm512_madd52hi_epu64(zero,a512[8],b512[19]);

	q512 = _mm512_madd52lo_epu64(zero,out512[8],n_prime[0]);

	t512[0] = _mm512_madd52lo_epu64(out512[8],q512,n[0]);
	t512[1] = _mm512_madd52hi_epu64(out512[9],q512,n[0]);
	t512[1] = _mm512_madd52lo_epu64(t512[1],q512,n[1]);
	t512[2] = _mm512_madd52hi_epu64(out512[10],q512,n[1]);
	t512[2] = _mm512_madd52lo_epu64(t512[2],q512,n[2]);
	t512[3] = _mm512_madd52hi_epu64(out512[11],q512,n[2]);
	t512[3] = _mm512_madd52lo_epu64(t512[3],q512,n[3]);
	t512[4] = _mm512_madd52hi_epu64(out512[12],q512,n[3]);
	t512[4] = _mm512_madd52lo_epu64(t512[4],q512,n[4]);
	t512[5] = _mm512_madd52hi_epu64(out512[13],q512,n[4]);
	t512[5] = _mm512_madd52lo_epu64(t512[5],q512,n[5]);
	t512[6] = _mm512_madd52hi_epu64(out512[14],q512,n[5]);
	t512[6] = _mm512_madd52lo_epu64(t512[6],q512,n[6]);
	t512[7] = _mm512_madd52hi_epu64(out512[15],q512,n[6]);
	t512[7] = _mm512_madd52lo_epu64(t512[7],q512,n[7]);
	t512[8] = _mm512_madd52hi_epu64(out512[16],q512,n[7]);
	t512[8] = _mm512_madd52lo_epu64(t512[8],q512,n[8]);
	t512[9] = _mm512_madd52hi_epu64(out512[17],q512,n[8]);
	t512[9] = _mm512_madd52lo_epu64(t512[9],q512,n[9]);
	t512[10] = _mm512_madd52hi_epu64(out512[18],q512,n[9]);
	t512[10] = _mm512_madd52lo_epu64(t512[10],q512,n[10]);
	t512[11] = _mm512_madd52hi_epu64(out512[19],q512,n[10]);
	t512[11] = _mm512_madd52lo_epu64(t512[11],q512,n[11]);
	t512[12] = _mm512_madd52hi_epu64(out512[20],q512,n[11]);
	t512[12] = _mm512_madd52lo_epu64(t512[12],q512,n[12]);
	t512[13] = _mm512_madd52hi_epu64(out512[21],q512,n[12]);
	t512[13] = _mm512_madd52lo_epu64(t512[13],q512,n[13]);
	t512[14] = _mm512_madd52hi_epu64(out512[22],q512,n[13]);
	t512[14] = _mm512_madd52lo_epu64(t512[14],q512,n[14]);
	t512[15] = _mm512_madd52hi_epu64(out512[23],q512,n[14]);
	t512[15] = _mm512_madd52lo_epu64(t512[15],q512,n[15]);
	t512[16] = _mm512_madd52hi_epu64(out512[24],q512,n[15]);
	t512[16] = _mm512_madd52lo_epu64(t512[16],q512,n[16]);
	t512[17] = _mm512_madd52hi_epu64(out512[25],q512,n[16]);
	t512[17] = _mm512_madd52lo_epu64(t512[17],q512,n[17]);
	t512[18] = _mm512_madd52hi_epu64(out512[26],q512,n[17]);
	t512[18] = _mm512_madd52lo_epu64(t512[18],q512,n[18]);
	t512[19] = _mm512_madd52hi_epu64(out512[27],q512,n[18]);
	t512[19] = _mm512_madd52lo_epu64(t512[19],q512,n[19]);
	t512[20] = _mm512_madd52hi_epu64(out512[28],q512,n[19]);

	carry  = _mm512_srli_epi64(t512[0],52);
	out512[8] = _mm512_and_si512(t512[0],mask52);
	t512[1] = _mm512_add_epi64(carry,t512[1]);
	carry  = _mm512_srli_epi64(t512[1],52);
	out512[9] = _mm512_and_si512(t512[1],mask52);
	t512[2] = _mm512_add_epi64(carry,t512[2]);
	carry  = _mm512_srli_epi64(t512[2],52);
	out512[10] = _mm512_and_si512(t512[2],mask52);
	t512[3] = _mm512_add_epi64(carry,t512[3]);
	carry  = _mm512_srli_epi64(t512[3],52);
	out512[11] = _mm512_and_si512(t512[3],mask52);
	t512[4] = _mm512_add_epi64(carry,t512[4]);
	carry  = _mm512_srli_epi64(t512[4],52);
	out512[12] = _mm512_and_si512(t512[4],mask52);
	t512[5] = _mm512_add_epi64(carry,t512[5]);
	carry  = _mm512_srli_epi64(t512[5],52);
	out512[13] = _mm512_and_si512(t512[5],mask52);
	t512[6] = _mm512_add_epi64(carry,t512[6]);
	carry  = _mm512_srli_epi64(t512[6],52);
	out512[14] = _mm512_and_si512(t512[6],mask52);
	t512[7] = _mm512_add_epi64(carry,t512[7]);
	carry  = _mm512_srli_epi64(t512[7],52);
	out512[15] = _mm512_and_si512(t512[7],mask52);
	t512[8] = _mm512_add_epi64(carry,t512[8]);
	carry  = _mm512_srli_epi64(t512[8],52);
	out512[16] = _mm512_and_si512(t512[8],mask52);
	t512[9] = _mm512_add_epi64(carry,t512[9]);
	carry  = _mm512_srli_epi64(t512[9],52);
	out512[17] = _mm512_and_si512(t512[9],mask52);
	t512[10] = _mm512_add_epi64(carry,t512[10]);
	carry  = _mm512_srli_epi64(t512[10],52);
	out512[18] = _mm512_and_si512(t512[10],mask52);
	t512[11] = _mm512_add_epi64(carry,t512[11]);
	carry  = _mm512_srli_epi64(t512[11],52);
	out512[19] = _mm512_and_si512(t512[11],mask52);
	t512[12] = _mm512_add_epi64(carry,t512[12]);
	carry  = _mm512_srli_epi64(t512[12],52);
	out512[20] = _mm512_and_si512(t512[12],mask52);
	t512[13] = _mm512_add_epi64(carry,t512[13]);
	carry  = _mm512_srli_epi64(t512[13],52);
	out512[21] = _mm512_and_si512(t512[13],mask52);
	t512[14] = _mm512_add_epi64(carry,t512[14]);
	carry  = _mm512_srli_epi64(t512[14],52);
	out512[22] = _mm512_and_si512(t512[14],mask52);
	t512[15] = _mm512_add_epi64(carry,t512[15]);
	carry  = _mm512_srli_epi64(t512[15],52);
	out512[23] = _mm512_and_si512(t512[15],mask52);
	t512[16] = _mm512_add_epi64(carry,t512[16]);
	carry  = _mm512_srli_epi64(t512[16],52);
	out512[24] = _mm512_and_si512(t512[16],mask52);
	t512[17] = _mm512_add_epi64(carry,t512[17]);
	carry  = _mm512_srli_epi64(t512[17],52);
	out512[25] = _mm512_and_si512(t512[17],mask52);
	t512[18] = _mm512_add_epi64(carry,t512[18]);
	carry  = _mm512_srli_epi64(t512[18],52);
	out512[26] = _mm512_and_si512(t512[18],mask52);
	t512[19] = _mm512_add_epi64(carry,t512[19]);
	carry  = _mm512_srli_epi64(t512[19],52);
	out512[27] = _mm512_and_si512(t512[19],mask52);
	out512[28] = _mm512_add_epi64(t512[20],carry);


	//Y = Y + a_iB

	out512[9] = _mm512_madd52lo_epu64(out512[9],a512[9],b512[0]);
	out512[10] = _mm512_madd52hi_epu64(out512[10],a512[9],b512[0]);
	out512[10] = _mm512_madd52lo_epu64(out512[10],a512[9],b512[1]);
	out512[11] = _mm512_madd52hi_epu64(out512[11],a512[9],b512[1]);
	out512[11] = _mm512_madd52lo_epu64(out512[11],a512[9],b512[2]);
	out512[12] = _mm512_madd52hi_epu64(out512[12],a512[9],b512[2]);
	out512[12] = _mm512_madd52lo_epu64(out512[12],a512[9],b512[3]);
	out512[13] = _mm512_madd52hi_epu64(out512[13],a512[9],b512[3]);
	out512[13] = _mm512_madd52lo_epu64(out512[13],a512[9],b512[4]);
	out512[14] = _mm512_madd52hi_epu64(out512[14],a512[9],b512[4]);
	out512[14] = _mm512_madd52lo_epu64(out512[14],a512[9],b512[5]);
	out512[15] = _mm512_madd52hi_epu64(out512[15],a512[9],b512[5]);
	out512[15] = _mm512_madd52lo_epu64(out512[15],a512[9],b512[6]);
	out512[16] = _mm512_madd52hi_epu64(out512[16],a512[9],b512[6]);
	out512[16] = _mm512_madd52lo_epu64(out512[16],a512[9],b512[7]);
	out512[17] = _mm512_madd52hi_epu64(out512[17],a512[9],b512[7]);
	out512[17] = _mm512_madd52lo_epu64(out512[17],a512[9],b512[8]);
	out512[18] = _mm512_madd52hi_epu64(out512[18],a512[9],b512[8]);
	out512[18] = _mm512_madd52lo_epu64(out512[18],a512[9],b512[9]);
	out512[19] = _mm512_madd52hi_epu64(out512[19],a512[9],b512[9]);
	out512[19] = _mm512_madd52lo_epu64(out512[19],a512[9],b512[10]);
	out512[20] = _mm512_madd52hi_epu64(out512[20],a512[9],b512[10]);
	out512[20] = _mm512_madd52lo_epu64(out512[20],a512[9],b512[11]);
	out512[21] = _mm512_madd52hi_epu64(out512[21],a512[9],b512[11]);
	out512[21] = _mm512_madd52lo_epu64(out512[21],a512[9],b512[12]);
	out512[22] = _mm512_madd52hi_epu64(out512[22],a512[9],b512[12]);
	out512[22] = _mm512_madd52lo_epu64(out512[22],a512[9],b512[13]);
	out512[23] = _mm512_madd52hi_epu64(out512[23],a512[9],b512[13]);
	out512[23] = _mm512_madd52lo_epu64(out512[23],a512[9],b512[14]);
	out512[24] = _mm512_madd52hi_epu64(out512[24],a512[9],b512[14]);
	out512[24] = _mm512_madd52lo_epu64(out512[24],a512[9],b512[15]);
	out512[25] = _mm512_madd52hi_epu64(out512[25],a512[9],b512[15]);
	out512[25] = _mm512_madd52lo_epu64(out512[25],a512[9],b512[16]);
	out512[26] = _mm512_madd52hi_epu64(out512[26],a512[9],b512[16]);
	out512[26] = _mm512_madd52lo_epu64(out512[26],a512[9],b512[17]);
	out512[27] = _mm512_madd52hi_epu64(out512[27],a512[9],b512[17]);
	out512[27] = _mm512_madd52lo_epu64(out512[27],a512[9],b512[18]);
	out512[28] = _mm512_madd52hi_epu64(out512[28],a512[9],b512[18]);
	out512[28] = _mm512_madd52lo_epu64(out512[28],a512[9],b512[19]);
	out512[29] = _mm512_madd52hi_epu64(zero,a512[9],b512[19]);

	q512 = _mm512_madd52lo_epu64(zero,out512[9],n_prime[0]);

	t512[0] = _mm512_madd52lo_epu64(out512[9],q512,n[0]);
	t512[1] = _mm512_madd52hi_epu64(out512[10],q512,n[0]);
	t512[1] = _mm512_madd52lo_epu64(t512[1],q512,n[1]);
	t512[2] = _mm512_madd52hi_epu64(out512[11],q512,n[1]);
	t512[2] = _mm512_madd52lo_epu64(t512[2],q512,n[2]);
	t512[3] = _mm512_madd52hi_epu64(out512[12],q512,n[2]);
	t512[3] = _mm512_madd52lo_epu64(t512[3],q512,n[3]);
	t512[4] = _mm512_madd52hi_epu64(out512[13],q512,n[3]);
	t512[4] = _mm512_madd52lo_epu64(t512[4],q512,n[4]);
	t512[5] = _mm512_madd52hi_epu64(out512[14],q512,n[4]);
	t512[5] = _mm512_madd52lo_epu64(t512[5],q512,n[5]);
	t512[6] = _mm512_madd52hi_epu64(out512[15],q512,n[5]);
	t512[6] = _mm512_madd52lo_epu64(t512[6],q512,n[6]);
	t512[7] = _mm512_madd52hi_epu64(out512[16],q512,n[6]);
	t512[7] = _mm512_madd52lo_epu64(t512[7],q512,n[7]);
	t512[8] = _mm512_madd52hi_epu64(out512[17],q512,n[7]);
	t512[8] = _mm512_madd52lo_epu64(t512[8],q512,n[8]);
	t512[9] = _mm512_madd52hi_epu64(out512[18],q512,n[8]);
	t512[9] = _mm512_madd52lo_epu64(t512[9],q512,n[9]);
	t512[10] = _mm512_madd52hi_epu64(out512[19],q512,n[9]);
	t512[10] = _mm512_madd52lo_epu64(t512[10],q512,n[10]);
	t512[11] = _mm512_madd52hi_epu64(out512[20],q512,n[10]);
	t512[11] = _mm512_madd52lo_epu64(t512[11],q512,n[11]);
	t512[12] = _mm512_madd52hi_epu64(out512[21],q512,n[11]);
	t512[12] = _mm512_madd52lo_epu64(t512[12],q512,n[12]);
	t512[13] = _mm512_madd52hi_epu64(out512[22],q512,n[12]);
	t512[13] = _mm512_madd52lo_epu64(t512[13],q512,n[13]);
	t512[14] = _mm512_madd52hi_epu64(out512[23],q512,n[13]);
	t512[14] = _mm512_madd52lo_epu64(t512[14],q512,n[14]);
	t512[15] = _mm512_madd52hi_epu64(out512[24],q512,n[14]);
	t512[15] = _mm512_madd52lo_epu64(t512[15],q512,n[15]);
	t512[16] = _mm512_madd52hi_epu64(out512[25],q512,n[15]);
	t512[16] = _mm512_madd52lo_epu64(t512[16],q512,n[16]);
	t512[17] = _mm512_madd52hi_epu64(out512[26],q512,n[16]);
	t512[17] = _mm512_madd52lo_epu64(t512[17],q512,n[17]);
	t512[18] = _mm512_madd52hi_epu64(out512[27],q512,n[17]);
	t512[18] = _mm512_madd52lo_epu64(t512[18],q512,n[18]);
	t512[19] = _mm512_madd52hi_epu64(out512[28],q512,n[18]);
	t512[19] = _mm512_madd52lo_epu64(t512[19],q512,n[19]);
	t512[20] = _mm512_madd52hi_epu64(out512[29],q512,n[19]);

	carry  = _mm512_srli_epi64(t512[0],52);
	out512[9] = _mm512_and_si512(t512[0],mask52);
	t512[1] = _mm512_add_epi64(carry,t512[1]);
	carry  = _mm512_srli_epi64(t512[1],52);
	out512[10] = _mm512_and_si512(t512[1],mask52);
	t512[2] = _mm512_add_epi64(carry,t512[2]);
	carry  = _mm512_srli_epi64(t512[2],52);
	out512[11] = _mm512_and_si512(t512[2],mask52);
	t512[3] = _mm512_add_epi64(carry,t512[3]);
	carry  = _mm512_srli_epi64(t512[3],52);
	out512[12] = _mm512_and_si512(t512[3],mask52);
	t512[4] = _mm512_add_epi64(carry,t512[4]);
	carry  = _mm512_srli_epi64(t512[4],52);
	out512[13] = _mm512_and_si512(t512[4],mask52);
	t512[5] = _mm512_add_epi64(carry,t512[5]);
	carry  = _mm512_srli_epi64(t512[5],52);
	out512[14] = _mm512_and_si512(t512[5],mask52);
	t512[6] = _mm512_add_epi64(carry,t512[6]);
	carry  = _mm512_srli_epi64(t512[6],52);
	out512[15] = _mm512_and_si512(t512[6],mask52);
	t512[7] = _mm512_add_epi64(carry,t512[7]);
	carry  = _mm512_srli_epi64(t512[7],52);
	out512[16] = _mm512_and_si512(t512[7],mask52);
	t512[8] = _mm512_add_epi64(carry,t512[8]);
	carry  = _mm512_srli_epi64(t512[8],52);
	out512[17] = _mm512_and_si512(t512[8],mask52);
	t512[9] = _mm512_add_epi64(carry,t512[9]);
	carry  = _mm512_srli_epi64(t512[9],52);
	out512[18] = _mm512_and_si512(t512[9],mask52);
	t512[10] = _mm512_add_epi64(carry,t512[10]);
	carry  = _mm512_srli_epi64(t512[10],52);
	out512[19] = _mm512_and_si512(t512[10],mask52);
	t512[11] = _mm512_add_epi64(carry,t512[11]);
	carry  = _mm512_srli_epi64(t512[11],52);
	out512[20] = _mm512_and_si512(t512[11],mask52);
	t512[12] = _mm512_add_epi64(carry,t512[12]);
	carry  = _mm512_srli_epi64(t512[12],52);
	out512[21] = _mm512_and_si512(t512[12],mask52);
	t512[13] = _mm512_add_epi64(carry,t512[13]);
	carry  = _mm512_srli_epi64(t512[13],52);
	out512[22] = _mm512_and_si512(t512[13],mask52);
	t512[14] = _mm512_add_epi64(carry,t512[14]);
	carry  = _mm512_srli_epi64(t512[14],52);
	out512[23] = _mm512_and_si512(t512[14],mask52);
	t512[15] = _mm512_add_epi64(carry,t512[15]);
	carry  = _mm512_srli_epi64(t512[15],52);
	out512[24] = _mm512_and_si512(t512[15],mask52);
	t512[16] = _mm512_add_epi64(carry,t512[16]);
	carry  = _mm512_srli_epi64(t512[16],52);
	out512[25] = _mm512_and_si512(t512[16],mask52);
	t512[17] = _mm512_add_epi64(carry,t512[17]);
	carry  = _mm512_srli_epi64(t512[17],52);
	out512[26] = _mm512_and_si512(t512[17],mask52);
	t512[18] = _mm512_add_epi64(carry,t512[18]);
	carry  = _mm512_srli_epi64(t512[18],52);
	out512[27] = _mm512_and_si512(t512[18],mask52);
	t512[19] = _mm512_add_epi64(carry,t512[19]);
	carry  = _mm512_srli_epi64(t512[19],52);
	out512[28] = _mm512_and_si512(t512[19],mask52);
	out512[29] = _mm512_add_epi64(t512[20],carry);


	//Y = Y + a_iB

	out512[10] = _mm512_madd52lo_epu64(out512[10],a512[10],b512[0]);
	out512[11] = _mm512_madd52hi_epu64(out512[11],a512[10],b512[0]);
	out512[11] = _mm512_madd52lo_epu64(out512[11],a512[10],b512[1]);
	out512[12] = _mm512_madd52hi_epu64(out512[12],a512[10],b512[1]);
	out512[12] = _mm512_madd52lo_epu64(out512[12],a512[10],b512[2]);
	out512[13] = _mm512_madd52hi_epu64(out512[13],a512[10],b512[2]);
	out512[13] = _mm512_madd52lo_epu64(out512[13],a512[10],b512[3]);
	out512[14] = _mm512_madd52hi_epu64(out512[14],a512[10],b512[3]);
	out512[14] = _mm512_madd52lo_epu64(out512[14],a512[10],b512[4]);
	out512[15] = _mm512_madd52hi_epu64(out512[15],a512[10],b512[4]);
	out512[15] = _mm512_madd52lo_epu64(out512[15],a512[10],b512[5]);
	out512[16] = _mm512_madd52hi_epu64(out512[16],a512[10],b512[5]);
	out512[16] = _mm512_madd52lo_epu64(out512[16],a512[10],b512[6]);
	out512[17] = _mm512_madd52hi_epu64(out512[17],a512[10],b512[6]);
	out512[17] = _mm512_madd52lo_epu64(out512[17],a512[10],b512[7]);
	out512[18] = _mm512_madd52hi_epu64(out512[18],a512[10],b512[7]);
	out512[18] = _mm512_madd52lo_epu64(out512[18],a512[10],b512[8]);
	out512[19] = _mm512_madd52hi_epu64(out512[19],a512[10],b512[8]);
	out512[19] = _mm512_madd52lo_epu64(out512[19],a512[10],b512[9]);
	out512[20] = _mm512_madd52hi_epu64(out512[20],a512[10],b512[9]);
	out512[20] = _mm512_madd52lo_epu64(out512[20],a512[10],b512[10]);
	out512[21] = _mm512_madd52hi_epu64(out512[21],a512[10],b512[10]);
	out512[21] = _mm512_madd52lo_epu64(out512[21],a512[10],b512[11]);
	out512[22] = _mm512_madd52hi_epu64(out512[22],a512[10],b512[11]);
	out512[22] = _mm512_madd52lo_epu64(out512[22],a512[10],b512[12]);
	out512[23] = _mm512_madd52hi_epu64(out512[23],a512[10],b512[12]);
	out512[23] = _mm512_madd52lo_epu64(out512[23],a512[10],b512[13]);
	out512[24] = _mm512_madd52hi_epu64(out512[24],a512[10],b512[13]);
	out512[24] = _mm512_madd52lo_epu64(out512[24],a512[10],b512[14]);
	out512[25] = _mm512_madd52hi_epu64(out512[25],a512[10],b512[14]);
	out512[25] = _mm512_madd52lo_epu64(out512[25],a512[10],b512[15]);
	out512[26] = _mm512_madd52hi_epu64(out512[26],a512[10],b512[15]);
	out512[26] = _mm512_madd52lo_epu64(out512[26],a512[10],b512[16]);
	out512[27] = _mm512_madd52hi_epu64(out512[27],a512[10],b512[16]);
	out512[27] = _mm512_madd52lo_epu64(out512[27],a512[10],b512[17]);
	out512[28] = _mm512_madd52hi_epu64(out512[28],a512[10],b512[17]);
	out512[28] = _mm512_madd52lo_epu64(out512[28],a512[10],b512[18]);
	out512[29] = _mm512_madd52hi_epu64(out512[29],a512[10],b512[18]);
	out512[29] = _mm512_madd52lo_epu64(out512[29],a512[10],b512[19]);
	out512[30] = _mm512_madd52hi_epu64(zero,a512[10],b512[19]);

	q512 = _mm512_madd52lo_epu64(zero,out512[10],n_prime[0]);

	t512[0] = _mm512_madd52lo_epu64(out512[10],q512,n[0]);
	t512[1] = _mm512_madd52hi_epu64(out512[11],q512,n[0]);
	t512[1] = _mm512_madd52lo_epu64(t512[1],q512,n[1]);
	t512[2] = _mm512_madd52hi_epu64(out512[12],q512,n[1]);
	t512[2] = _mm512_madd52lo_epu64(t512[2],q512,n[2]);
	t512[3] = _mm512_madd52hi_epu64(out512[13],q512,n[2]);
	t512[3] = _mm512_madd52lo_epu64(t512[3],q512,n[3]);
	t512[4] = _mm512_madd52hi_epu64(out512[14],q512,n[3]);
	t512[4] = _mm512_madd52lo_epu64(t512[4],q512,n[4]);
	t512[5] = _mm512_madd52hi_epu64(out512[15],q512,n[4]);
	t512[5] = _mm512_madd52lo_epu64(t512[5],q512,n[5]);
	t512[6] = _mm512_madd52hi_epu64(out512[16],q512,n[5]);
	t512[6] = _mm512_madd52lo_epu64(t512[6],q512,n[6]);
	t512[7] = _mm512_madd52hi_epu64(out512[17],q512,n[6]);
	t512[7] = _mm512_madd52lo_epu64(t512[7],q512,n[7]);
	t512[8] = _mm512_madd52hi_epu64(out512[18],q512,n[7]);
	t512[8] = _mm512_madd52lo_epu64(t512[8],q512,n[8]);
	t512[9] = _mm512_madd52hi_epu64(out512[19],q512,n[8]);
	t512[9] = _mm512_madd52lo_epu64(t512[9],q512,n[9]);
	t512[10] = _mm512_madd52hi_epu64(out512[20],q512,n[9]);
	t512[10] = _mm512_madd52lo_epu64(t512[10],q512,n[10]);
	t512[11] = _mm512_madd52hi_epu64(out512[21],q512,n[10]);
	t512[11] = _mm512_madd52lo_epu64(t512[11],q512,n[11]);
	t512[12] = _mm512_madd52hi_epu64(out512[22],q512,n[11]);
	t512[12] = _mm512_madd52lo_epu64(t512[12],q512,n[12]);
	t512[13] = _mm512_madd52hi_epu64(out512[23],q512,n[12]);
	t512[13] = _mm512_madd52lo_epu64(t512[13],q512,n[13]);
	t512[14] = _mm512_madd52hi_epu64(out512[24],q512,n[13]);
	t512[14] = _mm512_madd52lo_epu64(t512[14],q512,n[14]);
	t512[15] = _mm512_madd52hi_epu64(out512[25],q512,n[14]);
	t512[15] = _mm512_madd52lo_epu64(t512[15],q512,n[15]);
	t512[16] = _mm512_madd52hi_epu64(out512[26],q512,n[15]);
	t512[16] = _mm512_madd52lo_epu64(t512[16],q512,n[16]);
	t512[17] = _mm512_madd52hi_epu64(out512[27],q512,n[16]);
	t512[17] = _mm512_madd52lo_epu64(t512[17],q512,n[17]);
	t512[18] = _mm512_madd52hi_epu64(out512[28],q512,n[17]);
	t512[18] = _mm512_madd52lo_epu64(t512[18],q512,n[18]);
	t512[19] = _mm512_madd52hi_epu64(out512[29],q512,n[18]);
	t512[19] = _mm512_madd52lo_epu64(t512[19],q512,n[19]);
	t512[20] = _mm512_madd52hi_epu64(out512[30],q512,n[19]);

	carry  = _mm512_srli_epi64(t512[0],52);
	out512[10] = _mm512_and_si512(t512[0],mask52);
	t512[1] = _mm512_add_epi64(carry,t512[1]);
	carry  = _mm512_srli_epi64(t512[1],52);
	out512[11] = _mm512_and_si512(t512[1],mask52);
	t512[2] = _mm512_add_epi64(carry,t512[2]);
	carry  = _mm512_srli_epi64(t512[2],52);
	out512[12] = _mm512_and_si512(t512[2],mask52);
	t512[3] = _mm512_add_epi64(carry,t512[3]);
	carry  = _mm512_srli_epi64(t512[3],52);
	out512[13] = _mm512_and_si512(t512[3],mask52);
	t512[4] = _mm512_add_epi64(carry,t512[4]);
	carry  = _mm512_srli_epi64(t512[4],52);
	out512[14] = _mm512_and_si512(t512[4],mask52);
	t512[5] = _mm512_add_epi64(carry,t512[5]);
	carry  = _mm512_srli_epi64(t512[5],52);
	out512[15] = _mm512_and_si512(t512[5],mask52);
	t512[6] = _mm512_add_epi64(carry,t512[6]);
	carry  = _mm512_srli_epi64(t512[6],52);
	out512[16] = _mm512_and_si512(t512[6],mask52);
	t512[7] = _mm512_add_epi64(carry,t512[7]);
	carry  = _mm512_srli_epi64(t512[7],52);
	out512[17] = _mm512_and_si512(t512[7],mask52);
	t512[8] = _mm512_add_epi64(carry,t512[8]);
	carry  = _mm512_srli_epi64(t512[8],52);
	out512[18] = _mm512_and_si512(t512[8],mask52);
	t512[9] = _mm512_add_epi64(carry,t512[9]);
	carry  = _mm512_srli_epi64(t512[9],52);
	out512[19] = _mm512_and_si512(t512[9],mask52);
	t512[10] = _mm512_add_epi64(carry,t512[10]);
	carry  = _mm512_srli_epi64(t512[10],52);
	out512[20] = _mm512_and_si512(t512[10],mask52);
	t512[11] = _mm512_add_epi64(carry,t512[11]);
	carry  = _mm512_srli_epi64(t512[11],52);
	out512[21] = _mm512_and_si512(t512[11],mask52);
	t512[12] = _mm512_add_epi64(carry,t512[12]);
	carry  = _mm512_srli_epi64(t512[12],52);
	out512[22] = _mm512_and_si512(t512[12],mask52);
	t512[13] = _mm512_add_epi64(carry,t512[13]);
	carry  = _mm512_srli_epi64(t512[13],52);
	out512[23] = _mm512_and_si512(t512[13],mask52);
	t512[14] = _mm512_add_epi64(carry,t512[14]);
	carry  = _mm512_srli_epi64(t512[14],52);
	out512[24] = _mm512_and_si512(t512[14],mask52);
	t512[15] = _mm512_add_epi64(carry,t512[15]);
	carry  = _mm512_srli_epi64(t512[15],52);
	out512[25] = _mm512_and_si512(t512[15],mask52);
	t512[16] = _mm512_add_epi64(carry,t512[16]);
	carry  = _mm512_srli_epi64(t512[16],52);
	out512[26] = _mm512_and_si512(t512[16],mask52);
	t512[17] = _mm512_add_epi64(carry,t512[17]);
	carry  = _mm512_srli_epi64(t512[17],52);
	out512[27] = _mm512_and_si512(t512[17],mask52);
	t512[18] = _mm512_add_epi64(carry,t512[18]);
	carry  = _mm512_srli_epi64(t512[18],52);
	out512[28] = _mm512_and_si512(t512[18],mask52);
	t512[19] = _mm512_add_epi64(carry,t512[19]);
	carry  = _mm512_srli_epi64(t512[19],52);
	out512[29] = _mm512_and_si512(t512[19],mask52);
	out512[30] = _mm512_add_epi64(t512[20],carry);


	//Y = Y + a_iB

	out512[11] = _mm512_madd52lo_epu64(out512[11],a512[11],b512[0]);
	out512[12] = _mm512_madd52hi_epu64(out512[12],a512[11],b512[0]);
	out512[12] = _mm512_madd52lo_epu64(out512[12],a512[11],b512[1]);
	out512[13] = _mm512_madd52hi_epu64(out512[13],a512[11],b512[1]);
	out512[13] = _mm512_madd52lo_epu64(out512[13],a512[11],b512[2]);
	out512[14] = _mm512_madd52hi_epu64(out512[14],a512[11],b512[2]);
	out512[14] = _mm512_madd52lo_epu64(out512[14],a512[11],b512[3]);
	out512[15] = _mm512_madd52hi_epu64(out512[15],a512[11],b512[3]);
	out512[15] = _mm512_madd52lo_epu64(out512[15],a512[11],b512[4]);
	out512[16] = _mm512_madd52hi_epu64(out512[16],a512[11],b512[4]);
	out512[16] = _mm512_madd52lo_epu64(out512[16],a512[11],b512[5]);
	out512[17] = _mm512_madd52hi_epu64(out512[17],a512[11],b512[5]);
	out512[17] = _mm512_madd52lo_epu64(out512[17],a512[11],b512[6]);
	out512[18] = _mm512_madd52hi_epu64(out512[18],a512[11],b512[6]);
	out512[18] = _mm512_madd52lo_epu64(out512[18],a512[11],b512[7]);
	out512[19] = _mm512_madd52hi_epu64(out512[19],a512[11],b512[7]);
	out512[19] = _mm512_madd52lo_epu64(out512[19],a512[11],b512[8]);
	out512[20] = _mm512_madd52hi_epu64(out512[20],a512[11],b512[8]);
	out512[20] = _mm512_madd52lo_epu64(out512[20],a512[11],b512[9]);
	out512[21] = _mm512_madd52hi_epu64(out512[21],a512[11],b512[9]);
	out512[21] = _mm512_madd52lo_epu64(out512[21],a512[11],b512[10]);
	out512[22] = _mm512_madd52hi_epu64(out512[22],a512[11],b512[10]);
	out512[22] = _mm512_madd52lo_epu64(out512[22],a512[11],b512[11]);
	out512[23] = _mm512_madd52hi_epu64(out512[23],a512[11],b512[11]);
	out512[23] = _mm512_madd52lo_epu64(out512[23],a512[11],b512[12]);
	out512[24] = _mm512_madd52hi_epu64(out512[24],a512[11],b512[12]);
	out512[24] = _mm512_madd52lo_epu64(out512[24],a512[11],b512[13]);
	out512[25] = _mm512_madd52hi_epu64(out512[25],a512[11],b512[13]);
	out512[25] = _mm512_madd52lo_epu64(out512[25],a512[11],b512[14]);
	out512[26] = _mm512_madd52hi_epu64(out512[26],a512[11],b512[14]);
	out512[26] = _mm512_madd52lo_epu64(out512[26],a512[11],b512[15]);
	out512[27] = _mm512_madd52hi_epu64(out512[27],a512[11],b512[15]);
	out512[27] = _mm512_madd52lo_epu64(out512[27],a512[11],b512[16]);
	out512[28] = _mm512_madd52hi_epu64(out512[28],a512[11],b512[16]);
	out512[28] = _mm512_madd52lo_epu64(out512[28],a512[11],b512[17]);
	out512[29] = _mm512_madd52hi_epu64(out512[29],a512[11],b512[17]);
	out512[29] = _mm512_madd52lo_epu64(out512[29],a512[11],b512[18]);
	out512[30] = _mm512_madd52hi_epu64(out512[30],a512[11],b512[18]);
	out512[30] = _mm512_madd52lo_epu64(out512[30],a512[11],b512[19]);
	out512[31] = _mm512_madd52hi_epu64(zero,a512[11],b512[19]);

	q512 = _mm512_madd52lo_epu64(zero,out512[11],n_prime[0]);

	t512[0] = _mm512_madd52lo_epu64(out512[11],q512,n[0]);
	t512[1] = _mm512_madd52hi_epu64(out512[12],q512,n[0]);
	t512[1] = _mm512_madd52lo_epu64(t512[1],q512,n[1]);
	t512[2] = _mm512_madd52hi_epu64(out512[13],q512,n[1]);
	t512[2] = _mm512_madd52lo_epu64(t512[2],q512,n[2]);
	t512[3] = _mm512_madd52hi_epu64(out512[14],q512,n[2]);
	t512[3] = _mm512_madd52lo_epu64(t512[3],q512,n[3]);
	t512[4] = _mm512_madd52hi_epu64(out512[15],q512,n[3]);
	t512[4] = _mm512_madd52lo_epu64(t512[4],q512,n[4]);
	t512[5] = _mm512_madd52hi_epu64(out512[16],q512,n[4]);
	t512[5] = _mm512_madd52lo_epu64(t512[5],q512,n[5]);
	t512[6] = _mm512_madd52hi_epu64(out512[17],q512,n[5]);
	t512[6] = _mm512_madd52lo_epu64(t512[6],q512,n[6]);
	t512[7] = _mm512_madd52hi_epu64(out512[18],q512,n[6]);
	t512[7] = _mm512_madd52lo_epu64(t512[7],q512,n[7]);
	t512[8] = _mm512_madd52hi_epu64(out512[19],q512,n[7]);
	t512[8] = _mm512_madd52lo_epu64(t512[8],q512,n[8]);
	t512[9] = _mm512_madd52hi_epu64(out512[20],q512,n[8]);
	t512[9] = _mm512_madd52lo_epu64(t512[9],q512,n[9]);
	t512[10] = _mm512_madd52hi_epu64(out512[21],q512,n[9]);
	t512[10] = _mm512_madd52lo_epu64(t512[10],q512,n[10]);
	t512[11] = _mm512_madd52hi_epu64(out512[22],q512,n[10]);
	t512[11] = _mm512_madd52lo_epu64(t512[11],q512,n[11]);
	t512[12] = _mm512_madd52hi_epu64(out512[23],q512,n[11]);
	t512[12] = _mm512_madd52lo_epu64(t512[12],q512,n[12]);
	t512[13] = _mm512_madd52hi_epu64(out512[24],q512,n[12]);
	t512[13] = _mm512_madd52lo_epu64(t512[13],q512,n[13]);
	t512[14] = _mm512_madd52hi_epu64(out512[25],q512,n[13]);
	t512[14] = _mm512_madd52lo_epu64(t512[14],q512,n[14]);
	t512[15] = _mm512_madd52hi_epu64(out512[26],q512,n[14]);
	t512[15] = _mm512_madd52lo_epu64(t512[15],q512,n[15]);
	t512[16] = _mm512_madd52hi_epu64(out512[27],q512,n[15]);
	t512[16] = _mm512_madd52lo_epu64(t512[16],q512,n[16]);
	t512[17] = _mm512_madd52hi_epu64(out512[28],q512,n[16]);
	t512[17] = _mm512_madd52lo_epu64(t512[17],q512,n[17]);
	t512[18] = _mm512_madd52hi_epu64(out512[29],q512,n[17]);
	t512[18] = _mm512_madd52lo_epu64(t512[18],q512,n[18]);
	t512[19] = _mm512_madd52hi_epu64(out512[30],q512,n[18]);
	t512[19] = _mm512_madd52lo_epu64(t512[19],q512,n[19]);
	t512[20] = _mm512_madd52hi_epu64(out512[31],q512,n[19]);

	carry  = _mm512_srli_epi64(t512[0],52);
	out512[11] = _mm512_and_si512(t512[0],mask52);
	t512[1] = _mm512_add_epi64(carry,t512[1]);
	carry  = _mm512_srli_epi64(t512[1],52);
	out512[12] = _mm512_and_si512(t512[1],mask52);
	t512[2] = _mm512_add_epi64(carry,t512[2]);
	carry  = _mm512_srli_epi64(t512[2],52);
	out512[13] = _mm512_and_si512(t512[2],mask52);
	t512[3] = _mm512_add_epi64(carry,t512[3]);
	carry  = _mm512_srli_epi64(t512[3],52);
	out512[14] = _mm512_and_si512(t512[3],mask52);
	t512[4] = _mm512_add_epi64(carry,t512[4]);
	carry  = _mm512_srli_epi64(t512[4],52);
	out512[15] = _mm512_and_si512(t512[4],mask52);
	t512[5] = _mm512_add_epi64(carry,t512[5]);
	carry  = _mm512_srli_epi64(t512[5],52);
	out512[16] = _mm512_and_si512(t512[5],mask52);
	t512[6] = _mm512_add_epi64(carry,t512[6]);
	carry  = _mm512_srli_epi64(t512[6],52);
	out512[17] = _mm512_and_si512(t512[6],mask52);
	t512[7] = _mm512_add_epi64(carry,t512[7]);
	carry  = _mm512_srli_epi64(t512[7],52);
	out512[18] = _mm512_and_si512(t512[7],mask52);
	t512[8] = _mm512_add_epi64(carry,t512[8]);
	carry  = _mm512_srli_epi64(t512[8],52);
	out512[19] = _mm512_and_si512(t512[8],mask52);
	t512[9] = _mm512_add_epi64(carry,t512[9]);
	carry  = _mm512_srli_epi64(t512[9],52);
	out512[20] = _mm512_and_si512(t512[9],mask52);
	t512[10] = _mm512_add_epi64(carry,t512[10]);
	carry  = _mm512_srli_epi64(t512[10],52);
	out512[21] = _mm512_and_si512(t512[10],mask52);
	t512[11] = _mm512_add_epi64(carry,t512[11]);
	carry  = _mm512_srli_epi64(t512[11],52);
	out512[22] = _mm512_and_si512(t512[11],mask52);
	t512[12] = _mm512_add_epi64(carry,t512[12]);
	carry  = _mm512_srli_epi64(t512[12],52);
	out512[23] = _mm512_and_si512(t512[12],mask52);
	t512[13] = _mm512_add_epi64(carry,t512[13]);
	carry  = _mm512_srli_epi64(t512[13],52);
	out512[24] = _mm512_and_si512(t512[13],mask52);
	t512[14] = _mm512_add_epi64(carry,t512[14]);
	carry  = _mm512_srli_epi64(t512[14],52);
	out512[25] = _mm512_and_si512(t512[14],mask52);
	t512[15] = _mm512_add_epi64(carry,t512[15]);
	carry  = _mm512_srli_epi64(t512[15],52);
	out512[26] = _mm512_and_si512(t512[15],mask52);
	t512[16] = _mm512_add_epi64(carry,t512[16]);
	carry  = _mm512_srli_epi64(t512[16],52);
	out512[27] = _mm512_and_si512(t512[16],mask52);
	t512[17] = _mm512_add_epi64(carry,t512[17]);
	carry  = _mm512_srli_epi64(t512[17],52);
	out512[28] = _mm512_and_si512(t512[17],mask52);
	t512[18] = _mm512_add_epi64(carry,t512[18]);
	carry  = _mm512_srli_epi64(t512[18],52);
	out512[29] = _mm512_and_si512(t512[18],mask52);
	t512[19] = _mm512_add_epi64(carry,t512[19]);
	carry  = _mm512_srli_epi64(t512[19],52);
	out512[30] = _mm512_and_si512(t512[19],mask52);
	out512[31] = _mm512_add_epi64(t512[20],carry);


	//Y = Y + a_iB

	out512[12] = _mm512_madd52lo_epu64(out512[12],a512[12],b512[0]);
	out512[13] = _mm512_madd52hi_epu64(out512[13],a512[12],b512[0]);
	out512[13] = _mm512_madd52lo_epu64(out512[13],a512[12],b512[1]);
	out512[14] = _mm512_madd52hi_epu64(out512[14],a512[12],b512[1]);
	out512[14] = _mm512_madd52lo_epu64(out512[14],a512[12],b512[2]);
	out512[15] = _mm512_madd52hi_epu64(out512[15],a512[12],b512[2]);
	out512[15] = _mm512_madd52lo_epu64(out512[15],a512[12],b512[3]);
	out512[16] = _mm512_madd52hi_epu64(out512[16],a512[12],b512[3]);
	out512[16] = _mm512_madd52lo_epu64(out512[16],a512[12],b512[4]);
	out512[17] = _mm512_madd52hi_epu64(out512[17],a512[12],b512[4]);
	out512[17] = _mm512_madd52lo_epu64(out512[17],a512[12],b512[5]);
	out512[18] = _mm512_madd52hi_epu64(out512[18],a512[12],b512[5]);
	out512[18] = _mm512_madd52lo_epu64(out512[18],a512[12],b512[6]);
	out512[19] = _mm512_madd52hi_epu64(out512[19],a512[12],b512[6]);
	out512[19] = _mm512_madd52lo_epu64(out512[19],a512[12],b512[7]);
	out512[20] = _mm512_madd52hi_epu64(out512[20],a512[12],b512[7]);
	out512[20] = _mm512_madd52lo_epu64(out512[20],a512[12],b512[8]);
	out512[21] = _mm512_madd52hi_epu64(out512[21],a512[12],b512[8]);
	out512[21] = _mm512_madd52lo_epu64(out512[21],a512[12],b512[9]);
	out512[22] = _mm512_madd52hi_epu64(out512[22],a512[12],b512[9]);
	out512[22] = _mm512_madd52lo_epu64(out512[22],a512[12],b512[10]);
	out512[23] = _mm512_madd52hi_epu64(out512[23],a512[12],b512[10]);
	out512[23] = _mm512_madd52lo_epu64(out512[23],a512[12],b512[11]);
	out512[24] = _mm512_madd52hi_epu64(out512[24],a512[12],b512[11]);
	out512[24] = _mm512_madd52lo_epu64(out512[24],a512[12],b512[12]);
	out512[25] = _mm512_madd52hi_epu64(out512[25],a512[12],b512[12]);
	out512[25] = _mm512_madd52lo_epu64(out512[25],a512[12],b512[13]);
	out512[26] = _mm512_madd52hi_epu64(out512[26],a512[12],b512[13]);
	out512[26] = _mm512_madd52lo_epu64(out512[26],a512[12],b512[14]);
	out512[27] = _mm512_madd52hi_epu64(out512[27],a512[12],b512[14]);
	out512[27] = _mm512_madd52lo_epu64(out512[27],a512[12],b512[15]);
	out512[28] = _mm512_madd52hi_epu64(out512[28],a512[12],b512[15]);
	out512[28] = _mm512_madd52lo_epu64(out512[28],a512[12],b512[16]);
	out512[29] = _mm512_madd52hi_epu64(out512[29],a512[12],b512[16]);
	out512[29] = _mm512_madd52lo_epu64(out512[29],a512[12],b512[17]);
	out512[30] = _mm512_madd52hi_epu64(out512[30],a512[12],b512[17]);
	out512[30] = _mm512_madd52lo_epu64(out512[30],a512[12],b512[18]);
	out512[31] = _mm512_madd52hi_epu64(out512[31],a512[12],b512[18]);
	out512[31] = _mm512_madd52lo_epu64(out512[31],a512[12],b512[19]);
	out512[32] = _mm512_madd52hi_epu64(zero,a512[12],b512[19]);

	q512 = _mm512_madd52lo_epu64(zero,out512[12],n_prime[0]);

	t512[0] = _mm512_madd52lo_epu64(out512[12],q512,n[0]);
	t512[1] = _mm512_madd52hi_epu64(out512[13],q512,n[0]);
	t512[1] = _mm512_madd52lo_epu64(t512[1],q512,n[1]);
	t512[2] = _mm512_madd52hi_epu64(out512[14],q512,n[1]);
	t512[2] = _mm512_madd52lo_epu64(t512[2],q512,n[2]);
	t512[3] = _mm512_madd52hi_epu64(out512[15],q512,n[2]);
	t512[3] = _mm512_madd52lo_epu64(t512[3],q512,n[3]);
	t512[4] = _mm512_madd52hi_epu64(out512[16],q512,n[3]);
	t512[4] = _mm512_madd52lo_epu64(t512[4],q512,n[4]);
	t512[5] = _mm512_madd52hi_epu64(out512[17],q512,n[4]);
	t512[5] = _mm512_madd52lo_epu64(t512[5],q512,n[5]);
	t512[6] = _mm512_madd52hi_epu64(out512[18],q512,n[5]);
	t512[6] = _mm512_madd52lo_epu64(t512[6],q512,n[6]);
	t512[7] = _mm512_madd52hi_epu64(out512[19],q512,n[6]);
	t512[7] = _mm512_madd52lo_epu64(t512[7],q512,n[7]);
	t512[8] = _mm512_madd52hi_epu64(out512[20],q512,n[7]);
	t512[8] = _mm512_madd52lo_epu64(t512[8],q512,n[8]);
	t512[9] = _mm512_madd52hi_epu64(out512[21],q512,n[8]);
	t512[9] = _mm512_madd52lo_epu64(t512[9],q512,n[9]);
	t512[10] = _mm512_madd52hi_epu64(out512[22],q512,n[9]);
	t512[10] = _mm512_madd52lo_epu64(t512[10],q512,n[10]);
	t512[11] = _mm512_madd52hi_epu64(out512[23],q512,n[10]);
	t512[11] = _mm512_madd52lo_epu64(t512[11],q512,n[11]);
	t512[12] = _mm512_madd52hi_epu64(out512[24],q512,n[11]);
	t512[12] = _mm512_madd52lo_epu64(t512[12],q512,n[12]);
	t512[13] = _mm512_madd52hi_epu64(out512[25],q512,n[12]);
	t512[13] = _mm512_madd52lo_epu64(t512[13],q512,n[13]);
	t512[14] = _mm512_madd52hi_epu64(out512[26],q512,n[13]);
	t512[14] = _mm512_madd52lo_epu64(t512[14],q512,n[14]);
	t512[15] = _mm512_madd52hi_epu64(out512[27],q512,n[14]);
	t512[15] = _mm512_madd52lo_epu64(t512[15],q512,n[15]);
	t512[16] = _mm512_madd52hi_epu64(out512[28],q512,n[15]);
	t512[16] = _mm512_madd52lo_epu64(t512[16],q512,n[16]);
	t512[17] = _mm512_madd52hi_epu64(out512[29],q512,n[16]);
	t512[17] = _mm512_madd52lo_epu64(t512[17],q512,n[17]);
	t512[18] = _mm512_madd52hi_epu64(out512[30],q512,n[17]);
	t512[18] = _mm512_madd52lo_epu64(t512[18],q512,n[18]);
	t512[19] = _mm512_madd52hi_epu64(out512[31],q512,n[18]);
	t512[19] = _mm512_madd52lo_epu64(t512[19],q512,n[19]);
	t512[20] = _mm512_madd52hi_epu64(out512[32],q512,n[19]);

	carry  = _mm512_srli_epi64(t512[0],52);
	out512[12] = _mm512_and_si512(t512[0],mask52);
	t512[1] = _mm512_add_epi64(carry,t512[1]);
	carry  = _mm512_srli_epi64(t512[1],52);
	out512[13] = _mm512_and_si512(t512[1],mask52);
	t512[2] = _mm512_add_epi64(carry,t512[2]);
	carry  = _mm512_srli_epi64(t512[2],52);
	out512[14] = _mm512_and_si512(t512[2],mask52);
	t512[3] = _mm512_add_epi64(carry,t512[3]);
	carry  = _mm512_srli_epi64(t512[3],52);
	out512[15] = _mm512_and_si512(t512[3],mask52);
	t512[4] = _mm512_add_epi64(carry,t512[4]);
	carry  = _mm512_srli_epi64(t512[4],52);
	out512[16] = _mm512_and_si512(t512[4],mask52);
	t512[5] = _mm512_add_epi64(carry,t512[5]);
	carry  = _mm512_srli_epi64(t512[5],52);
	out512[17] = _mm512_and_si512(t512[5],mask52);
	t512[6] = _mm512_add_epi64(carry,t512[6]);
	carry  = _mm512_srli_epi64(t512[6],52);
	out512[18] = _mm512_and_si512(t512[6],mask52);
	t512[7] = _mm512_add_epi64(carry,t512[7]);
	carry  = _mm512_srli_epi64(t512[7],52);
	out512[19] = _mm512_and_si512(t512[7],mask52);
	t512[8] = _mm512_add_epi64(carry,t512[8]);
	carry  = _mm512_srli_epi64(t512[8],52);
	out512[20] = _mm512_and_si512(t512[8],mask52);
	t512[9] = _mm512_add_epi64(carry,t512[9]);
	carry  = _mm512_srli_epi64(t512[9],52);
	out512[21] = _mm512_and_si512(t512[9],mask52);
	t512[10] = _mm512_add_epi64(carry,t512[10]);
	carry  = _mm512_srli_epi64(t512[10],52);
	out512[22] = _mm512_and_si512(t512[10],mask52);
	t512[11] = _mm512_add_epi64(carry,t512[11]);
	carry  = _mm512_srli_epi64(t512[11],52);
	out512[23] = _mm512_and_si512(t512[11],mask52);
	t512[12] = _mm512_add_epi64(carry,t512[12]);
	carry  = _mm512_srli_epi64(t512[12],52);
	out512[24] = _mm512_and_si512(t512[12],mask52);
	t512[13] = _mm512_add_epi64(carry,t512[13]);
	carry  = _mm512_srli_epi64(t512[13],52);
	out512[25] = _mm512_and_si512(t512[13],mask52);
	t512[14] = _mm512_add_epi64(carry,t512[14]);
	carry  = _mm512_srli_epi64(t512[14],52);
	out512[26] = _mm512_and_si512(t512[14],mask52);
	t512[15] = _mm512_add_epi64(carry,t512[15]);
	carry  = _mm512_srli_epi64(t512[15],52);
	out512[27] = _mm512_and_si512(t512[15],mask52);
	t512[16] = _mm512_add_epi64(carry,t512[16]);
	carry  = _mm512_srli_epi64(t512[16],52);
	out512[28] = _mm512_and_si512(t512[16],mask52);
	t512[17] = _mm512_add_epi64(carry,t512[17]);
	carry  = _mm512_srli_epi64(t512[17],52);
	out512[29] = _mm512_and_si512(t512[17],mask52);
	t512[18] = _mm512_add_epi64(carry,t512[18]);
	carry  = _mm512_srli_epi64(t512[18],52);
	out512[30] = _mm512_and_si512(t512[18],mask52);
	t512[19] = _mm512_add_epi64(carry,t512[19]);
	carry  = _mm512_srli_epi64(t512[19],52);
	out512[31] = _mm512_and_si512(t512[19],mask52);
	out512[32] = _mm512_add_epi64(t512[20],carry);


	//Y = Y + a_iB

	out512[13] = _mm512_madd52lo_epu64(out512[13],a512[13],b512[0]);
	out512[14] = _mm512_madd52hi_epu64(out512[14],a512[13],b512[0]);
	out512[14] = _mm512_madd52lo_epu64(out512[14],a512[13],b512[1]);
	out512[15] = _mm512_madd52hi_epu64(out512[15],a512[13],b512[1]);
	out512[15] = _mm512_madd52lo_epu64(out512[15],a512[13],b512[2]);
	out512[16] = _mm512_madd52hi_epu64(out512[16],a512[13],b512[2]);
	out512[16] = _mm512_madd52lo_epu64(out512[16],a512[13],b512[3]);
	out512[17] = _mm512_madd52hi_epu64(out512[17],a512[13],b512[3]);
	out512[17] = _mm512_madd52lo_epu64(out512[17],a512[13],b512[4]);
	out512[18] = _mm512_madd52hi_epu64(out512[18],a512[13],b512[4]);
	out512[18] = _mm512_madd52lo_epu64(out512[18],a512[13],b512[5]);
	out512[19] = _mm512_madd52hi_epu64(out512[19],a512[13],b512[5]);
	out512[19] = _mm512_madd52lo_epu64(out512[19],a512[13],b512[6]);
	out512[20] = _mm512_madd52hi_epu64(out512[20],a512[13],b512[6]);
	out512[20] = _mm512_madd52lo_epu64(out512[20],a512[13],b512[7]);
	out512[21] = _mm512_madd52hi_epu64(out512[21],a512[13],b512[7]);
	out512[21] = _mm512_madd52lo_epu64(out512[21],a512[13],b512[8]);
	out512[22] = _mm512_madd52hi_epu64(out512[22],a512[13],b512[8]);
	out512[22] = _mm512_madd52lo_epu64(out512[22],a512[13],b512[9]);
	out512[23] = _mm512_madd52hi_epu64(out512[23],a512[13],b512[9]);
	out512[23] = _mm512_madd52lo_epu64(out512[23],a512[13],b512[10]);
	out512[24] = _mm512_madd52hi_epu64(out512[24],a512[13],b512[10]);
	out512[24] = _mm512_madd52lo_epu64(out512[24],a512[13],b512[11]);
	out512[25] = _mm512_madd52hi_epu64(out512[25],a512[13],b512[11]);
	out512[25] = _mm512_madd52lo_epu64(out512[25],a512[13],b512[12]);
	out512[26] = _mm512_madd52hi_epu64(out512[26],a512[13],b512[12]);
	out512[26] = _mm512_madd52lo_epu64(out512[26],a512[13],b512[13]);
	out512[27] = _mm512_madd52hi_epu64(out512[27],a512[13],b512[13]);
	out512[27] = _mm512_madd52lo_epu64(out512[27],a512[13],b512[14]);
	out512[28] = _mm512_madd52hi_epu64(out512[28],a512[13],b512[14]);
	out512[28] = _mm512_madd52lo_epu64(out512[28],a512[13],b512[15]);
	out512[29] = _mm512_madd52hi_epu64(out512[29],a512[13],b512[15]);
	out512[29] = _mm512_madd52lo_epu64(out512[29],a512[13],b512[16]);
	out512[30] = _mm512_madd52hi_epu64(out512[30],a512[13],b512[16]);
	out512[30] = _mm512_madd52lo_epu64(out512[30],a512[13],b512[17]);
	out512[31] = _mm512_madd52hi_epu64(out512[31],a512[13],b512[17]);
	out512[31] = _mm512_madd52lo_epu64(out512[31],a512[13],b512[18]);
	out512[32] = _mm512_madd52hi_epu64(out512[32],a512[13],b512[18]);
	out512[32] = _mm512_madd52lo_epu64(out512[32],a512[13],b512[19]);
	out512[33] = _mm512_madd52hi_epu64(zero,a512[13],b512[19]);

	q512 = _mm512_madd52lo_epu64(zero,out512[13],n_prime[0]);

	t512[0] = _mm512_madd52lo_epu64(out512[13],q512,n[0]);
	t512[1] = _mm512_madd52hi_epu64(out512[14],q512,n[0]);
	t512[1] = _mm512_madd52lo_epu64(t512[1],q512,n[1]);
	t512[2] = _mm512_madd52hi_epu64(out512[15],q512,n[1]);
	t512[2] = _mm512_madd52lo_epu64(t512[2],q512,n[2]);
	t512[3] = _mm512_madd52hi_epu64(out512[16],q512,n[2]);
	t512[3] = _mm512_madd52lo_epu64(t512[3],q512,n[3]);
	t512[4] = _mm512_madd52hi_epu64(out512[17],q512,n[3]);
	t512[4] = _mm512_madd52lo_epu64(t512[4],q512,n[4]);
	t512[5] = _mm512_madd52hi_epu64(out512[18],q512,n[4]);
	t512[5] = _mm512_madd52lo_epu64(t512[5],q512,n[5]);
	t512[6] = _mm512_madd52hi_epu64(out512[19],q512,n[5]);
	t512[6] = _mm512_madd52lo_epu64(t512[6],q512,n[6]);
	t512[7] = _mm512_madd52hi_epu64(out512[20],q512,n[6]);
	t512[7] = _mm512_madd52lo_epu64(t512[7],q512,n[7]);
	t512[8] = _mm512_madd52hi_epu64(out512[21],q512,n[7]);
	t512[8] = _mm512_madd52lo_epu64(t512[8],q512,n[8]);
	t512[9] = _mm512_madd52hi_epu64(out512[22],q512,n[8]);
	t512[9] = _mm512_madd52lo_epu64(t512[9],q512,n[9]);
	t512[10] = _mm512_madd52hi_epu64(out512[23],q512,n[9]);
	t512[10] = _mm512_madd52lo_epu64(t512[10],q512,n[10]);
	t512[11] = _mm512_madd52hi_epu64(out512[24],q512,n[10]);
	t512[11] = _mm512_madd52lo_epu64(t512[11],q512,n[11]);
	t512[12] = _mm512_madd52hi_epu64(out512[25],q512,n[11]);
	t512[12] = _mm512_madd52lo_epu64(t512[12],q512,n[12]);
	t512[13] = _mm512_madd52hi_epu64(out512[26],q512,n[12]);
	t512[13] = _mm512_madd52lo_epu64(t512[13],q512,n[13]);
	t512[14] = _mm512_madd52hi_epu64(out512[27],q512,n[13]);
	t512[14] = _mm512_madd52lo_epu64(t512[14],q512,n[14]);
	t512[15] = _mm512_madd52hi_epu64(out512[28],q512,n[14]);
	t512[15] = _mm512_madd52lo_epu64(t512[15],q512,n[15]);
	t512[16] = _mm512_madd52hi_epu64(out512[29],q512,n[15]);
	t512[16] = _mm512_madd52lo_epu64(t512[16],q512,n[16]);
	t512[17] = _mm512_madd52hi_epu64(out512[30],q512,n[16]);
	t512[17] = _mm512_madd52lo_epu64(t512[17],q512,n[17]);
	t512[18] = _mm512_madd52hi_epu64(out512[31],q512,n[17]);
	t512[18] = _mm512_madd52lo_epu64(t512[18],q512,n[18]);
	t512[19] = _mm512_madd52hi_epu64(out512[32],q512,n[18]);
	t512[19] = _mm512_madd52lo_epu64(t512[19],q512,n[19]);
	t512[20] = _mm512_madd52hi_epu64(out512[33],q512,n[19]);

	carry  = _mm512_srli_epi64(t512[0],52);
	out512[13] = _mm512_and_si512(t512[0],mask52);
	t512[1] = _mm512_add_epi64(carry,t512[1]);
	carry  = _mm512_srli_epi64(t512[1],52);
	out512[14] = _mm512_and_si512(t512[1],mask52);
	t512[2] = _mm512_add_epi64(carry,t512[2]);
	carry  = _mm512_srli_epi64(t512[2],52);
	out512[15] = _mm512_and_si512(t512[2],mask52);
	t512[3] = _mm512_add_epi64(carry,t512[3]);
	carry  = _mm512_srli_epi64(t512[3],52);
	out512[16] = _mm512_and_si512(t512[3],mask52);
	t512[4] = _mm512_add_epi64(carry,t512[4]);
	carry  = _mm512_srli_epi64(t512[4],52);
	out512[17] = _mm512_and_si512(t512[4],mask52);
	t512[5] = _mm512_add_epi64(carry,t512[5]);
	carry  = _mm512_srli_epi64(t512[5],52);
	out512[18] = _mm512_and_si512(t512[5],mask52);
	t512[6] = _mm512_add_epi64(carry,t512[6]);
	carry  = _mm512_srli_epi64(t512[6],52);
	out512[19] = _mm512_and_si512(t512[6],mask52);
	t512[7] = _mm512_add_epi64(carry,t512[7]);
	carry  = _mm512_srli_epi64(t512[7],52);
	out512[20] = _mm512_and_si512(t512[7],mask52);
	t512[8] = _mm512_add_epi64(carry,t512[8]);
	carry  = _mm512_srli_epi64(t512[8],52);
	out512[21] = _mm512_and_si512(t512[8],mask52);
	t512[9] = _mm512_add_epi64(carry,t512[9]);
	carry  = _mm512_srli_epi64(t512[9],52);
	out512[22] = _mm512_and_si512(t512[9],mask52);
	t512[10] = _mm512_add_epi64(carry,t512[10]);
	carry  = _mm512_srli_epi64(t512[10],52);
	out512[23] = _mm512_and_si512(t512[10],mask52);
	t512[11] = _mm512_add_epi64(carry,t512[11]);
	carry  = _mm512_srli_epi64(t512[11],52);
	out512[24] = _mm512_and_si512(t512[11],mask52);
	t512[12] = _mm512_add_epi64(carry,t512[12]);
	carry  = _mm512_srli_epi64(t512[12],52);
	out512[25] = _mm512_and_si512(t512[12],mask52);
	t512[13] = _mm512_add_epi64(carry,t512[13]);
	carry  = _mm512_srli_epi64(t512[13],52);
	out512[26] = _mm512_and_si512(t512[13],mask52);
	t512[14] = _mm512_add_epi64(carry,t512[14]);
	carry  = _mm512_srli_epi64(t512[14],52);
	out512[27] = _mm512_and_si512(t512[14],mask52);
	t512[15] = _mm512_add_epi64(carry,t512[15]);
	carry  = _mm512_srli_epi64(t512[15],52);
	out512[28] = _mm512_and_si512(t512[15],mask52);
	t512[16] = _mm512_add_epi64(carry,t512[16]);
	carry  = _mm512_srli_epi64(t512[16],52);
	out512[29] = _mm512_and_si512(t512[16],mask52);
	t512[17] = _mm512_add_epi64(carry,t512[17]);
	carry  = _mm512_srli_epi64(t512[17],52);
	out512[30] = _mm512_and_si512(t512[17],mask52);
	t512[18] = _mm512_add_epi64(carry,t512[18]);
	carry  = _mm512_srli_epi64(t512[18],52);
	out512[31] = _mm512_and_si512(t512[18],mask52);
	t512[19] = _mm512_add_epi64(carry,t512[19]);
	carry  = _mm512_srli_epi64(t512[19],52);
	out512[32] = _mm512_and_si512(t512[19],mask52);
	out512[33] = _mm512_add_epi64(t512[20],carry);


	//Y = Y + a_iB

	out512[14] = _mm512_madd52lo_epu64(out512[14],a512[14],b512[0]);
	out512[15] = _mm512_madd52hi_epu64(out512[15],a512[14],b512[0]);
	out512[15] = _mm512_madd52lo_epu64(out512[15],a512[14],b512[1]);
	out512[16] = _mm512_madd52hi_epu64(out512[16],a512[14],b512[1]);
	out512[16] = _mm512_madd52lo_epu64(out512[16],a512[14],b512[2]);
	out512[17] = _mm512_madd52hi_epu64(out512[17],a512[14],b512[2]);
	out512[17] = _mm512_madd52lo_epu64(out512[17],a512[14],b512[3]);
	out512[18] = _mm512_madd52hi_epu64(out512[18],a512[14],b512[3]);
	out512[18] = _mm512_madd52lo_epu64(out512[18],a512[14],b512[4]);
	out512[19] = _mm512_madd52hi_epu64(out512[19],a512[14],b512[4]);
	out512[19] = _mm512_madd52lo_epu64(out512[19],a512[14],b512[5]);
	out512[20] = _mm512_madd52hi_epu64(out512[20],a512[14],b512[5]);
	out512[20] = _mm512_madd52lo_epu64(out512[20],a512[14],b512[6]);
	out512[21] = _mm512_madd52hi_epu64(out512[21],a512[14],b512[6]);
	out512[21] = _mm512_madd52lo_epu64(out512[21],a512[14],b512[7]);
	out512[22] = _mm512_madd52hi_epu64(out512[22],a512[14],b512[7]);
	out512[22] = _mm512_madd52lo_epu64(out512[22],a512[14],b512[8]);
	out512[23] = _mm512_madd52hi_epu64(out512[23],a512[14],b512[8]);
	out512[23] = _mm512_madd52lo_epu64(out512[23],a512[14],b512[9]);
	out512[24] = _mm512_madd52hi_epu64(out512[24],a512[14],b512[9]);
	out512[24] = _mm512_madd52lo_epu64(out512[24],a512[14],b512[10]);
	out512[25] = _mm512_madd52hi_epu64(out512[25],a512[14],b512[10]);
	out512[25] = _mm512_madd52lo_epu64(out512[25],a512[14],b512[11]);
	out512[26] = _mm512_madd52hi_epu64(out512[26],a512[14],b512[11]);
	out512[26] = _mm512_madd52lo_epu64(out512[26],a512[14],b512[12]);
	out512[27] = _mm512_madd52hi_epu64(out512[27],a512[14],b512[12]);
	out512[27] = _mm512_madd52lo_epu64(out512[27],a512[14],b512[13]);
	out512[28] = _mm512_madd52hi_epu64(out512[28],a512[14],b512[13]);
	out512[28] = _mm512_madd52lo_epu64(out512[28],a512[14],b512[14]);
	out512[29] = _mm512_madd52hi_epu64(out512[29],a512[14],b512[14]);
	out512[29] = _mm512_madd52lo_epu64(out512[29],a512[14],b512[15]);
	out512[30] = _mm512_madd52hi_epu64(out512[30],a512[14],b512[15]);
	out512[30] = _mm512_madd52lo_epu64(out512[30],a512[14],b512[16]);
	out512[31] = _mm512_madd52hi_epu64(out512[31],a512[14],b512[16]);
	out512[31] = _mm512_madd52lo_epu64(out512[31],a512[14],b512[17]);
	out512[32] = _mm512_madd52hi_epu64(out512[32],a512[14],b512[17]);
	out512[32] = _mm512_madd52lo_epu64(out512[32],a512[14],b512[18]);
	out512[33] = _mm512_madd52hi_epu64(out512[33],a512[14],b512[18]);
	out512[33] = _mm512_madd52lo_epu64(out512[33],a512[14],b512[19]);
	out512[34] = _mm512_madd52hi_epu64(zero,a512[14],b512[19]);

	q512 = _mm512_madd52lo_epu64(zero,out512[14],n_prime[0]);

	t512[0] = _mm512_madd52lo_epu64(out512[14],q512,n[0]);
	t512[1] = _mm512_madd52hi_epu64(out512[15],q512,n[0]);
	t512[1] = _mm512_madd52lo_epu64(t512[1],q512,n[1]);
	t512[2] = _mm512_madd52hi_epu64(out512[16],q512,n[1]);
	t512[2] = _mm512_madd52lo_epu64(t512[2],q512,n[2]);
	t512[3] = _mm512_madd52hi_epu64(out512[17],q512,n[2]);
	t512[3] = _mm512_madd52lo_epu64(t512[3],q512,n[3]);
	t512[4] = _mm512_madd52hi_epu64(out512[18],q512,n[3]);
	t512[4] = _mm512_madd52lo_epu64(t512[4],q512,n[4]);
	t512[5] = _mm512_madd52hi_epu64(out512[19],q512,n[4]);
	t512[5] = _mm512_madd52lo_epu64(t512[5],q512,n[5]);
	t512[6] = _mm512_madd52hi_epu64(out512[20],q512,n[5]);
	t512[6] = _mm512_madd52lo_epu64(t512[6],q512,n[6]);
	t512[7] = _mm512_madd52hi_epu64(out512[21],q512,n[6]);
	t512[7] = _mm512_madd52lo_epu64(t512[7],q512,n[7]);
	t512[8] = _mm512_madd52hi_epu64(out512[22],q512,n[7]);
	t512[8] = _mm512_madd52lo_epu64(t512[8],q512,n[8]);
	t512[9] = _mm512_madd52hi_epu64(out512[23],q512,n[8]);
	t512[9] = _mm512_madd52lo_epu64(t512[9],q512,n[9]);
	t512[10] = _mm512_madd52hi_epu64(out512[24],q512,n[9]);
	t512[10] = _mm512_madd52lo_epu64(t512[10],q512,n[10]);
	t512[11] = _mm512_madd52hi_epu64(out512[25],q512,n[10]);
	t512[11] = _mm512_madd52lo_epu64(t512[11],q512,n[11]);
	t512[12] = _mm512_madd52hi_epu64(out512[26],q512,n[11]);
	t512[12] = _mm512_madd52lo_epu64(t512[12],q512,n[12]);
	t512[13] = _mm512_madd52hi_epu64(out512[27],q512,n[12]);
	t512[13] = _mm512_madd52lo_epu64(t512[13],q512,n[13]);
	t512[14] = _mm512_madd52hi_epu64(out512[28],q512,n[13]);
	t512[14] = _mm512_madd52lo_epu64(t512[14],q512,n[14]);
	t512[15] = _mm512_madd52hi_epu64(out512[29],q512,n[14]);
	t512[15] = _mm512_madd52lo_epu64(t512[15],q512,n[15]);
	t512[16] = _mm512_madd52hi_epu64(out512[30],q512,n[15]);
	t512[16] = _mm512_madd52lo_epu64(t512[16],q512,n[16]);
	t512[17] = _mm512_madd52hi_epu64(out512[31],q512,n[16]);
	t512[17] = _mm512_madd52lo_epu64(t512[17],q512,n[17]);
	t512[18] = _mm512_madd52hi_epu64(out512[32],q512,n[17]);
	t512[18] = _mm512_madd52lo_epu64(t512[18],q512,n[18]);
	t512[19] = _mm512_madd52hi_epu64(out512[33],q512,n[18]);
	t512[19] = _mm512_madd52lo_epu64(t512[19],q512,n[19]);
	t512[20] = _mm512_madd52hi_epu64(out512[34],q512,n[19]);

	carry  = _mm512_srli_epi64(t512[0],52);
	out512[14] = _mm512_and_si512(t512[0],mask52);
	t512[1] = _mm512_add_epi64(carry,t512[1]);
	carry  = _mm512_srli_epi64(t512[1],52);
	out512[15] = _mm512_and_si512(t512[1],mask52);
	t512[2] = _mm512_add_epi64(carry,t512[2]);
	carry  = _mm512_srli_epi64(t512[2],52);
	out512[16] = _mm512_and_si512(t512[2],mask52);
	t512[3] = _mm512_add_epi64(carry,t512[3]);
	carry  = _mm512_srli_epi64(t512[3],52);
	out512[17] = _mm512_and_si512(t512[3],mask52);
	t512[4] = _mm512_add_epi64(carry,t512[4]);
	carry  = _mm512_srli_epi64(t512[4],52);
	out512[18] = _mm512_and_si512(t512[4],mask52);
	t512[5] = _mm512_add_epi64(carry,t512[5]);
	carry  = _mm512_srli_epi64(t512[5],52);
	out512[19] = _mm512_and_si512(t512[5],mask52);
	t512[6] = _mm512_add_epi64(carry,t512[6]);
	carry  = _mm512_srli_epi64(t512[6],52);
	out512[20] = _mm512_and_si512(t512[6],mask52);
	t512[7] = _mm512_add_epi64(carry,t512[7]);
	carry  = _mm512_srli_epi64(t512[7],52);
	out512[21] = _mm512_and_si512(t512[7],mask52);
	t512[8] = _mm512_add_epi64(carry,t512[8]);
	carry  = _mm512_srli_epi64(t512[8],52);
	out512[22] = _mm512_and_si512(t512[8],mask52);
	t512[9] = _mm512_add_epi64(carry,t512[9]);
	carry  = _mm512_srli_epi64(t512[9],52);
	out512[23] = _mm512_and_si512(t512[9],mask52);
	t512[10] = _mm512_add_epi64(carry,t512[10]);
	carry  = _mm512_srli_epi64(t512[10],52);
	out512[24] = _mm512_and_si512(t512[10],mask52);
	t512[11] = _mm512_add_epi64(carry,t512[11]);
	carry  = _mm512_srli_epi64(t512[11],52);
	out512[25] = _mm512_and_si512(t512[11],mask52);
	t512[12] = _mm512_add_epi64(carry,t512[12]);
	carry  = _mm512_srli_epi64(t512[12],52);
	out512[26] = _mm512_and_si512(t512[12],mask52);
	t512[13] = _mm512_add_epi64(carry,t512[13]);
	carry  = _mm512_srli_epi64(t512[13],52);
	out512[27] = _mm512_and_si512(t512[13],mask52);
	t512[14] = _mm512_add_epi64(carry,t512[14]);
	carry  = _mm512_srli_epi64(t512[14],52);
	out512[28] = _mm512_and_si512(t512[14],mask52);
	t512[15] = _mm512_add_epi64(carry,t512[15]);
	carry  = _mm512_srli_epi64(t512[15],52);
	out512[29] = _mm512_and_si512(t512[15],mask52);
	t512[16] = _mm512_add_epi64(carry,t512[16]);
	carry  = _mm512_srli_epi64(t512[16],52);
	out512[30] = _mm512_and_si512(t512[16],mask52);
	t512[17] = _mm512_add_epi64(carry,t512[17]);
	carry  = _mm512_srli_epi64(t512[17],52);
	out512[31] = _mm512_and_si512(t512[17],mask52);
	t512[18] = _mm512_add_epi64(carry,t512[18]);
	carry  = _mm512_srli_epi64(t512[18],52);
	out512[32] = _mm512_and_si512(t512[18],mask52);
	t512[19] = _mm512_add_epi64(carry,t512[19]);
	carry  = _mm512_srli_epi64(t512[19],52);
	out512[33] = _mm512_and_si512(t512[19],mask52);
	out512[34] = _mm512_add_epi64(t512[20],carry);


	//Y = Y + a_iB

	out512[15] = _mm512_madd52lo_epu64(out512[15],a512[15],b512[0]);
	out512[16] = _mm512_madd52hi_epu64(out512[16],a512[15],b512[0]);
	out512[16] = _mm512_madd52lo_epu64(out512[16],a512[15],b512[1]);
	out512[17] = _mm512_madd52hi_epu64(out512[17],a512[15],b512[1]);
	out512[17] = _mm512_madd52lo_epu64(out512[17],a512[15],b512[2]);
	out512[18] = _mm512_madd52hi_epu64(out512[18],a512[15],b512[2]);
	out512[18] = _mm512_madd52lo_epu64(out512[18],a512[15],b512[3]);
	out512[19] = _mm512_madd52hi_epu64(out512[19],a512[15],b512[3]);
	out512[19] = _mm512_madd52lo_epu64(out512[19],a512[15],b512[4]);
	out512[20] = _mm512_madd52hi_epu64(out512[20],a512[15],b512[4]);
	out512[20] = _mm512_madd52lo_epu64(out512[20],a512[15],b512[5]);
	out512[21] = _mm512_madd52hi_epu64(out512[21],a512[15],b512[5]);
	out512[21] = _mm512_madd52lo_epu64(out512[21],a512[15],b512[6]);
	out512[22] = _mm512_madd52hi_epu64(out512[22],a512[15],b512[6]);
	out512[22] = _mm512_madd52lo_epu64(out512[22],a512[15],b512[7]);
	out512[23] = _mm512_madd52hi_epu64(out512[23],a512[15],b512[7]);
	out512[23] = _mm512_madd52lo_epu64(out512[23],a512[15],b512[8]);
	out512[24] = _mm512_madd52hi_epu64(out512[24],a512[15],b512[8]);
	out512[24] = _mm512_madd52lo_epu64(out512[24],a512[15],b512[9]);
	out512[25] = _mm512_madd52hi_epu64(out512[25],a512[15],b512[9]);
	out512[25] = _mm512_madd52lo_epu64(out512[25],a512[15],b512[10]);
	out512[26] = _mm512_madd52hi_epu64(out512[26],a512[15],b512[10]);
	out512[26] = _mm512_madd52lo_epu64(out512[26],a512[15],b512[11]);
	out512[27] = _mm512_madd52hi_epu64(out512[27],a512[15],b512[11]);
	out512[27] = _mm512_madd52lo_epu64(out512[27],a512[15],b512[12]);
	out512[28] = _mm512_madd52hi_epu64(out512[28],a512[15],b512[12]);
	out512[28] = _mm512_madd52lo_epu64(out512[28],a512[15],b512[13]);
	out512[29] = _mm512_madd52hi_epu64(out512[29],a512[15],b512[13]);
	out512[29] = _mm512_madd52lo_epu64(out512[29],a512[15],b512[14]);
	out512[30] = _mm512_madd52hi_epu64(out512[30],a512[15],b512[14]);
	out512[30] = _mm512_madd52lo_epu64(out512[30],a512[15],b512[15]);
	out512[31] = _mm512_madd52hi_epu64(out512[31],a512[15],b512[15]);
	out512[31] = _mm512_madd52lo_epu64(out512[31],a512[15],b512[16]);
	out512[32] = _mm512_madd52hi_epu64(out512[32],a512[15],b512[16]);
	out512[32] = _mm512_madd52lo_epu64(out512[32],a512[15],b512[17]);
	out512[33] = _mm512_madd52hi_epu64(out512[33],a512[15],b512[17]);
	out512[33] = _mm512_madd52lo_epu64(out512[33],a512[15],b512[18]);
	out512[34] = _mm512_madd52hi_epu64(out512[34],a512[15],b512[18]);
	out512[34] = _mm512_madd52lo_epu64(out512[34],a512[15],b512[19]);
	out512[35] = _mm512_madd52hi_epu64(zero,a512[15],b512[19]);

	q512 = _mm512_madd52lo_epu64(zero,out512[15],n_prime[0]);

	t512[0] = _mm512_madd52lo_epu64(out512[15],q512,n[0]);
	t512[1] = _mm512_madd52hi_epu64(out512[16],q512,n[0]);
	t512[1] = _mm512_madd52lo_epu64(t512[1],q512,n[1]);
	t512[2] = _mm512_madd52hi_epu64(out512[17],q512,n[1]);
	t512[2] = _mm512_madd52lo_epu64(t512[2],q512,n[2]);
	t512[3] = _mm512_madd52hi_epu64(out512[18],q512,n[2]);
	t512[3] = _mm512_madd52lo_epu64(t512[3],q512,n[3]);
	t512[4] = _mm512_madd52hi_epu64(out512[19],q512,n[3]);
	t512[4] = _mm512_madd52lo_epu64(t512[4],q512,n[4]);
	t512[5] = _mm512_madd52hi_epu64(out512[20],q512,n[4]);
	t512[5] = _mm512_madd52lo_epu64(t512[5],q512,n[5]);
	t512[6] = _mm512_madd52hi_epu64(out512[21],q512,n[5]);
	t512[6] = _mm512_madd52lo_epu64(t512[6],q512,n[6]);
	t512[7] = _mm512_madd52hi_epu64(out512[22],q512,n[6]);
	t512[7] = _mm512_madd52lo_epu64(t512[7],q512,n[7]);
	t512[8] = _mm512_madd52hi_epu64(out512[23],q512,n[7]);
	t512[8] = _mm512_madd52lo_epu64(t512[8],q512,n[8]);
	t512[9] = _mm512_madd52hi_epu64(out512[24],q512,n[8]);
	t512[9] = _mm512_madd52lo_epu64(t512[9],q512,n[9]);
	t512[10] = _mm512_madd52hi_epu64(out512[25],q512,n[9]);
	t512[10] = _mm512_madd52lo_epu64(t512[10],q512,n[10]);
	t512[11] = _mm512_madd52hi_epu64(out512[26],q512,n[10]);
	t512[11] = _mm512_madd52lo_epu64(t512[11],q512,n[11]);
	t512[12] = _mm512_madd52hi_epu64(out512[27],q512,n[11]);
	t512[12] = _mm512_madd52lo_epu64(t512[12],q512,n[12]);
	t512[13] = _mm512_madd52hi_epu64(out512[28],q512,n[12]);
	t512[13] = _mm512_madd52lo_epu64(t512[13],q512,n[13]);
	t512[14] = _mm512_madd52hi_epu64(out512[29],q512,n[13]);
	t512[14] = _mm512_madd52lo_epu64(t512[14],q512,n[14]);
	t512[15] = _mm512_madd52hi_epu64(out512[30],q512,n[14]);
	t512[15] = _mm512_madd52lo_epu64(t512[15],q512,n[15]);
	t512[16] = _mm512_madd52hi_epu64(out512[31],q512,n[15]);
	t512[16] = _mm512_madd52lo_epu64(t512[16],q512,n[16]);
	t512[17] = _mm512_madd52hi_epu64(out512[32],q512,n[16]);
	t512[17] = _mm512_madd52lo_epu64(t512[17],q512,n[17]);
	t512[18] = _mm512_madd52hi_epu64(out512[33],q512,n[17]);
	t512[18] = _mm512_madd52lo_epu64(t512[18],q512,n[18]);
	t512[19] = _mm512_madd52hi_epu64(out512[34],q512,n[18]);
	t512[19] = _mm512_madd52lo_epu64(t512[19],q512,n[19]);
	t512[20] = _mm512_madd52hi_epu64(out512[35],q512,n[19]);

	carry  = _mm512_srli_epi64(t512[0],52);
	out512[15] = _mm512_and_si512(t512[0],mask52);
	t512[1] = _mm512_add_epi64(carry,t512[1]);
	carry  = _mm512_srli_epi64(t512[1],52);
	out512[16] = _mm512_and_si512(t512[1],mask52);
	t512[2] = _mm512_add_epi64(carry,t512[2]);
	carry  = _mm512_srli_epi64(t512[2],52);
	out512[17] = _mm512_and_si512(t512[2],mask52);
	t512[3] = _mm512_add_epi64(carry,t512[3]);
	carry  = _mm512_srli_epi64(t512[3],52);
	out512[18] = _mm512_and_si512(t512[3],mask52);
	t512[4] = _mm512_add_epi64(carry,t512[4]);
	carry  = _mm512_srli_epi64(t512[4],52);
	out512[19] = _mm512_and_si512(t512[4],mask52);
	t512[5] = _mm512_add_epi64(carry,t512[5]);
	carry  = _mm512_srli_epi64(t512[5],52);
	out512[20] = _mm512_and_si512(t512[5],mask52);
	t512[6] = _mm512_add_epi64(carry,t512[6]);
	carry  = _mm512_srli_epi64(t512[6],52);
	out512[21] = _mm512_and_si512(t512[6],mask52);
	t512[7] = _mm512_add_epi64(carry,t512[7]);
	carry  = _mm512_srli_epi64(t512[7],52);
	out512[22] = _mm512_and_si512(t512[7],mask52);
	t512[8] = _mm512_add_epi64(carry,t512[8]);
	carry  = _mm512_srli_epi64(t512[8],52);
	out512[23] = _mm512_and_si512(t512[8],mask52);
	t512[9] = _mm512_add_epi64(carry,t512[9]);
	carry  = _mm512_srli_epi64(t512[9],52);
	out512[24] = _mm512_and_si512(t512[9],mask52);
	t512[10] = _mm512_add_epi64(carry,t512[10]);
	carry  = _mm512_srli_epi64(t512[10],52);
	out512[25] = _mm512_and_si512(t512[10],mask52);
	t512[11] = _mm512_add_epi64(carry,t512[11]);
	carry  = _mm512_srli_epi64(t512[11],52);
	out512[26] = _mm512_and_si512(t512[11],mask52);
	t512[12] = _mm512_add_epi64(carry,t512[12]);
	carry  = _mm512_srli_epi64(t512[12],52);
	out512[27] = _mm512_and_si512(t512[12],mask52);
	t512[13] = _mm512_add_epi64(carry,t512[13]);
	carry  = _mm512_srli_epi64(t512[13],52);
	out512[28] = _mm512_and_si512(t512[13],mask52);
	t512[14] = _mm512_add_epi64(carry,t512[14]);
	carry  = _mm512_srli_epi64(t512[14],52);
	out512[29] = _mm512_and_si512(t512[14],mask52);
	t512[15] = _mm512_add_epi64(carry,t512[15]);
	carry  = _mm512_srli_epi64(t512[15],52);
	out512[30] = _mm512_and_si512(t512[15],mask52);
	t512[16] = _mm512_add_epi64(carry,t512[16]);
	carry  = _mm512_srli_epi64(t512[16],52);
	out512[31] = _mm512_and_si512(t512[16],mask52);
	t512[17] = _mm512_add_epi64(carry,t512[17]);
	carry  = _mm512_srli_epi64(t512[17],52);
	out512[32] = _mm512_and_si512(t512[17],mask52);
	t512[18] = _mm512_add_epi64(carry,t512[18]);
	carry  = _mm512_srli_epi64(t512[18],52);
	out512[33] = _mm512_and_si512(t512[18],mask52);
	t512[19] = _mm512_add_epi64(carry,t512[19]);
	carry  = _mm512_srli_epi64(t512[19],52);
	out512[34] = _mm512_and_si512(t512[19],mask52);
	out512[35] = _mm512_add_epi64(t512[20],carry);


	//Y = Y + a_iB

	out512[16] = _mm512_madd52lo_epu64(out512[16],a512[16],b512[0]);
	out512[17] = _mm512_madd52hi_epu64(out512[17],a512[16],b512[0]);
	out512[17] = _mm512_madd52lo_epu64(out512[17],a512[16],b512[1]);
	out512[18] = _mm512_madd52hi_epu64(out512[18],a512[16],b512[1]);
	out512[18] = _mm512_madd52lo_epu64(out512[18],a512[16],b512[2]);
	out512[19] = _mm512_madd52hi_epu64(out512[19],a512[16],b512[2]);
	out512[19] = _mm512_madd52lo_epu64(out512[19],a512[16],b512[3]);
	out512[20] = _mm512_madd52hi_epu64(out512[20],a512[16],b512[3]);
	out512[20] = _mm512_madd52lo_epu64(out512[20],a512[16],b512[4]);
	out512[21] = _mm512_madd52hi_epu64(out512[21],a512[16],b512[4]);
	out512[21] = _mm512_madd52lo_epu64(out512[21],a512[16],b512[5]);
	out512[22] = _mm512_madd52hi_epu64(out512[22],a512[16],b512[5]);
	out512[22] = _mm512_madd52lo_epu64(out512[22],a512[16],b512[6]);
	out512[23] = _mm512_madd52hi_epu64(out512[23],a512[16],b512[6]);
	out512[23] = _mm512_madd52lo_epu64(out512[23],a512[16],b512[7]);
	out512[24] = _mm512_madd52hi_epu64(out512[24],a512[16],b512[7]);
	out512[24] = _mm512_madd52lo_epu64(out512[24],a512[16],b512[8]);
	out512[25] = _mm512_madd52hi_epu64(out512[25],a512[16],b512[8]);
	out512[25] = _mm512_madd52lo_epu64(out512[25],a512[16],b512[9]);
	out512[26] = _mm512_madd52hi_epu64(out512[26],a512[16],b512[9]);
	out512[26] = _mm512_madd52lo_epu64(out512[26],a512[16],b512[10]);
	out512[27] = _mm512_madd52hi_epu64(out512[27],a512[16],b512[10]);
	out512[27] = _mm512_madd52lo_epu64(out512[27],a512[16],b512[11]);
	out512[28] = _mm512_madd52hi_epu64(out512[28],a512[16],b512[11]);
	out512[28] = _mm512_madd52lo_epu64(out512[28],a512[16],b512[12]);
	out512[29] = _mm512_madd52hi_epu64(out512[29],a512[16],b512[12]);
	out512[29] = _mm512_madd52lo_epu64(out512[29],a512[16],b512[13]);
	out512[30] = _mm512_madd52hi_epu64(out512[30],a512[16],b512[13]);
	out512[30] = _mm512_madd52lo_epu64(out512[30],a512[16],b512[14]);
	out512[31] = _mm512_madd52hi_epu64(out512[31],a512[16],b512[14]);
	out512[31] = _mm512_madd52lo_epu64(out512[31],a512[16],b512[15]);
	out512[32] = _mm512_madd52hi_epu64(out512[32],a512[16],b512[15]);
	out512[32] = _mm512_madd52lo_epu64(out512[32],a512[16],b512[16]);
	out512[33] = _mm512_madd52hi_epu64(out512[33],a512[16],b512[16]);
	out512[33] = _mm512_madd52lo_epu64(out512[33],a512[16],b512[17]);
	out512[34] = _mm512_madd52hi_epu64(out512[34],a512[16],b512[17]);
	out512[34] = _mm512_madd52lo_epu64(out512[34],a512[16],b512[18]);
	out512[35] = _mm512_madd52hi_epu64(out512[35],a512[16],b512[18]);
	out512[35] = _mm512_madd52lo_epu64(out512[35],a512[16],b512[19]);
	out512[36] = _mm512_madd52hi_epu64(zero,a512[16],b512[19]);

	q512 = _mm512_madd52lo_epu64(zero,out512[16],n_prime[0]);

	t512[0] = _mm512_madd52lo_epu64(out512[16],q512,n[0]);
	t512[1] = _mm512_madd52hi_epu64(out512[17],q512,n[0]);
	t512[1] = _mm512_madd52lo_epu64(t512[1],q512,n[1]);
	t512[2] = _mm512_madd52hi_epu64(out512[18],q512,n[1]);
	t512[2] = _mm512_madd52lo_epu64(t512[2],q512,n[2]);
	t512[3] = _mm512_madd52hi_epu64(out512[19],q512,n[2]);
	t512[3] = _mm512_madd52lo_epu64(t512[3],q512,n[3]);
	t512[4] = _mm512_madd52hi_epu64(out512[20],q512,n[3]);
	t512[4] = _mm512_madd52lo_epu64(t512[4],q512,n[4]);
	t512[5] = _mm512_madd52hi_epu64(out512[21],q512,n[4]);
	t512[5] = _mm512_madd52lo_epu64(t512[5],q512,n[5]);
	t512[6] = _mm512_madd52hi_epu64(out512[22],q512,n[5]);
	t512[6] = _mm512_madd52lo_epu64(t512[6],q512,n[6]);
	t512[7] = _mm512_madd52hi_epu64(out512[23],q512,n[6]);
	t512[7] = _mm512_madd52lo_epu64(t512[7],q512,n[7]);
	t512[8] = _mm512_madd52hi_epu64(out512[24],q512,n[7]);
	t512[8] = _mm512_madd52lo_epu64(t512[8],q512,n[8]);
	t512[9] = _mm512_madd52hi_epu64(out512[25],q512,n[8]);
	t512[9] = _mm512_madd52lo_epu64(t512[9],q512,n[9]);
	t512[10] = _mm512_madd52hi_epu64(out512[26],q512,n[9]);
	t512[10] = _mm512_madd52lo_epu64(t512[10],q512,n[10]);
	t512[11] = _mm512_madd52hi_epu64(out512[27],q512,n[10]);
	t512[11] = _mm512_madd52lo_epu64(t512[11],q512,n[11]);
	t512[12] = _mm512_madd52hi_epu64(out512[28],q512,n[11]);
	t512[12] = _mm512_madd52lo_epu64(t512[12],q512,n[12]);
	t512[13] = _mm512_madd52hi_epu64(out512[29],q512,n[12]);
	t512[13] = _mm512_madd52lo_epu64(t512[13],q512,n[13]);
	t512[14] = _mm512_madd52hi_epu64(out512[30],q512,n[13]);
	t512[14] = _mm512_madd52lo_epu64(t512[14],q512,n[14]);
	t512[15] = _mm512_madd52hi_epu64(out512[31],q512,n[14]);
	t512[15] = _mm512_madd52lo_epu64(t512[15],q512,n[15]);
	t512[16] = _mm512_madd52hi_epu64(out512[32],q512,n[15]);
	t512[16] = _mm512_madd52lo_epu64(t512[16],q512,n[16]);
	t512[17] = _mm512_madd52hi_epu64(out512[33],q512,n[16]);
	t512[17] = _mm512_madd52lo_epu64(t512[17],q512,n[17]);
	t512[18] = _mm512_madd52hi_epu64(out512[34],q512,n[17]);
	t512[18] = _mm512_madd52lo_epu64(t512[18],q512,n[18]);
	t512[19] = _mm512_madd52hi_epu64(out512[35],q512,n[18]);
	t512[19] = _mm512_madd52lo_epu64(t512[19],q512,n[19]);
	t512[20] = _mm512_madd52hi_epu64(out512[36],q512,n[19]);

	carry  = _mm512_srli_epi64(t512[0],52);
	out512[16] = _mm512_and_si512(t512[0],mask52);
	t512[1] = _mm512_add_epi64(carry,t512[1]);
	carry  = _mm512_srli_epi64(t512[1],52);
	out512[17] = _mm512_and_si512(t512[1],mask52);
	t512[2] = _mm512_add_epi64(carry,t512[2]);
	carry  = _mm512_srli_epi64(t512[2],52);
	out512[18] = _mm512_and_si512(t512[2],mask52);
	t512[3] = _mm512_add_epi64(carry,t512[3]);
	carry  = _mm512_srli_epi64(t512[3],52);
	out512[19] = _mm512_and_si512(t512[3],mask52);
	t512[4] = _mm512_add_epi64(carry,t512[4]);
	carry  = _mm512_srli_epi64(t512[4],52);
	out512[20] = _mm512_and_si512(t512[4],mask52);
	t512[5] = _mm512_add_epi64(carry,t512[5]);
	carry  = _mm512_srli_epi64(t512[5],52);
	out512[21] = _mm512_and_si512(t512[5],mask52);
	t512[6] = _mm512_add_epi64(carry,t512[6]);
	carry  = _mm512_srli_epi64(t512[6],52);
	out512[22] = _mm512_and_si512(t512[6],mask52);
	t512[7] = _mm512_add_epi64(carry,t512[7]);
	carry  = _mm512_srli_epi64(t512[7],52);
	out512[23] = _mm512_and_si512(t512[7],mask52);
	t512[8] = _mm512_add_epi64(carry,t512[8]);
	carry  = _mm512_srli_epi64(t512[8],52);
	out512[24] = _mm512_and_si512(t512[8],mask52);
	t512[9] = _mm512_add_epi64(carry,t512[9]);
	carry  = _mm512_srli_epi64(t512[9],52);
	out512[25] = _mm512_and_si512(t512[9],mask52);
	t512[10] = _mm512_add_epi64(carry,t512[10]);
	carry  = _mm512_srli_epi64(t512[10],52);
	out512[26] = _mm512_and_si512(t512[10],mask52);
	t512[11] = _mm512_add_epi64(carry,t512[11]);
	carry  = _mm512_srli_epi64(t512[11],52);
	out512[27] = _mm512_and_si512(t512[11],mask52);
	t512[12] = _mm512_add_epi64(carry,t512[12]);
	carry  = _mm512_srli_epi64(t512[12],52);
	out512[28] = _mm512_and_si512(t512[12],mask52);
	t512[13] = _mm512_add_epi64(carry,t512[13]);
	carry  = _mm512_srli_epi64(t512[13],52);
	out512[29] = _mm512_and_si512(t512[13],mask52);
	t512[14] = _mm512_add_epi64(carry,t512[14]);
	carry  = _mm512_srli_epi64(t512[14],52);
	out512[30] = _mm512_and_si512(t512[14],mask52);
	t512[15] = _mm512_add_epi64(carry,t512[15]);
	carry  = _mm512_srli_epi64(t512[15],52);
	out512[31] = _mm512_and_si512(t512[15],mask52);
	t512[16] = _mm512_add_epi64(carry,t512[16]);
	carry  = _mm512_srli_epi64(t512[16],52);
	out512[32] = _mm512_and_si512(t512[16],mask52);
	t512[17] = _mm512_add_epi64(carry,t512[17]);
	carry  = _mm512_srli_epi64(t512[17],52);
	out512[33] = _mm512_and_si512(t512[17],mask52);
	t512[18] = _mm512_add_epi64(carry,t512[18]);
	carry  = _mm512_srli_epi64(t512[18],52);
	out512[34] = _mm512_and_si512(t512[18],mask52);
	t512[19] = _mm512_add_epi64(carry,t512[19]);
	carry  = _mm512_srli_epi64(t512[19],52);
	out512[35] = _mm512_and_si512(t512[19],mask52);
	out512[36] = _mm512_add_epi64(t512[20],carry);


	//Y = Y + a_iB

	out512[17] = _mm512_madd52lo_epu64(out512[17],a512[17],b512[0]);
	out512[18] = _mm512_madd52hi_epu64(out512[18],a512[17],b512[0]);
	out512[18] = _mm512_madd52lo_epu64(out512[18],a512[17],b512[1]);
	out512[19] = _mm512_madd52hi_epu64(out512[19],a512[17],b512[1]);
	out512[19] = _mm512_madd52lo_epu64(out512[19],a512[17],b512[2]);
	out512[20] = _mm512_madd52hi_epu64(out512[20],a512[17],b512[2]);
	out512[20] = _mm512_madd52lo_epu64(out512[20],a512[17],b512[3]);
	out512[21] = _mm512_madd52hi_epu64(out512[21],a512[17],b512[3]);
	out512[21] = _mm512_madd52lo_epu64(out512[21],a512[17],b512[4]);
	out512[22] = _mm512_madd52hi_epu64(out512[22],a512[17],b512[4]);
	out512[22] = _mm512_madd52lo_epu64(out512[22],a512[17],b512[5]);
	out512[23] = _mm512_madd52hi_epu64(out512[23],a512[17],b512[5]);
	out512[23] = _mm512_madd52lo_epu64(out512[23],a512[17],b512[6]);
	out512[24] = _mm512_madd52hi_epu64(out512[24],a512[17],b512[6]);
	out512[24] = _mm512_madd52lo_epu64(out512[24],a512[17],b512[7]);
	out512[25] = _mm512_madd52hi_epu64(out512[25],a512[17],b512[7]);
	out512[25] = _mm512_madd52lo_epu64(out512[25],a512[17],b512[8]);
	out512[26] = _mm512_madd52hi_epu64(out512[26],a512[17],b512[8]);
	out512[26] = _mm512_madd52lo_epu64(out512[26],a512[17],b512[9]);
	out512[27] = _mm512_madd52hi_epu64(out512[27],a512[17],b512[9]);
	out512[27] = _mm512_madd52lo_epu64(out512[27],a512[17],b512[10]);
	out512[28] = _mm512_madd52hi_epu64(out512[28],a512[17],b512[10]);
	out512[28] = _mm512_madd52lo_epu64(out512[28],a512[17],b512[11]);
	out512[29] = _mm512_madd52hi_epu64(out512[29],a512[17],b512[11]);
	out512[29] = _mm512_madd52lo_epu64(out512[29],a512[17],b512[12]);
	out512[30] = _mm512_madd52hi_epu64(out512[30],a512[17],b512[12]);
	out512[30] = _mm512_madd52lo_epu64(out512[30],a512[17],b512[13]);
	out512[31] = _mm512_madd52hi_epu64(out512[31],a512[17],b512[13]);
	out512[31] = _mm512_madd52lo_epu64(out512[31],a512[17],b512[14]);
	out512[32] = _mm512_madd52hi_epu64(out512[32],a512[17],b512[14]);
	out512[32] = _mm512_madd52lo_epu64(out512[32],a512[17],b512[15]);
	out512[33] = _mm512_madd52hi_epu64(out512[33],a512[17],b512[15]);
	out512[33] = _mm512_madd52lo_epu64(out512[33],a512[17],b512[16]);
	out512[34] = _mm512_madd52hi_epu64(out512[34],a512[17],b512[16]);
	out512[34] = _mm512_madd52lo_epu64(out512[34],a512[17],b512[17]);
	out512[35] = _mm512_madd52hi_epu64(out512[35],a512[17],b512[17]);
	out512[35] = _mm512_madd52lo_epu64(out512[35],a512[17],b512[18]);
	out512[36] = _mm512_madd52hi_epu64(out512[36],a512[17],b512[18]);
	out512[36] = _mm512_madd52lo_epu64(out512[36],a512[17],b512[19]);
	out512[37] = _mm512_madd52hi_epu64(zero,a512[17],b512[19]);

	q512 = _mm512_madd52lo_epu64(zero,out512[17],n_prime[0]);

	t512[0] = _mm512_madd52lo_epu64(out512[17],q512,n[0]);
	t512[1] = _mm512_madd52hi_epu64(out512[18],q512,n[0]);
	t512[1] = _mm512_madd52lo_epu64(t512[1],q512,n[1]);
	t512[2] = _mm512_madd52hi_epu64(out512[19],q512,n[1]);
	t512[2] = _mm512_madd52lo_epu64(t512[2],q512,n[2]);
	t512[3] = _mm512_madd52hi_epu64(out512[20],q512,n[2]);
	t512[3] = _mm512_madd52lo_epu64(t512[3],q512,n[3]);
	t512[4] = _mm512_madd52hi_epu64(out512[21],q512,n[3]);
	t512[4] = _mm512_madd52lo_epu64(t512[4],q512,n[4]);
	t512[5] = _mm512_madd52hi_epu64(out512[22],q512,n[4]);
	t512[5] = _mm512_madd52lo_epu64(t512[5],q512,n[5]);
	t512[6] = _mm512_madd52hi_epu64(out512[23],q512,n[5]);
	t512[6] = _mm512_madd52lo_epu64(t512[6],q512,n[6]);
	t512[7] = _mm512_madd52hi_epu64(out512[24],q512,n[6]);
	t512[7] = _mm512_madd52lo_epu64(t512[7],q512,n[7]);
	t512[8] = _mm512_madd52hi_epu64(out512[25],q512,n[7]);
	t512[8] = _mm512_madd52lo_epu64(t512[8],q512,n[8]);
	t512[9] = _mm512_madd52hi_epu64(out512[26],q512,n[8]);
	t512[9] = _mm512_madd52lo_epu64(t512[9],q512,n[9]);
	t512[10] = _mm512_madd52hi_epu64(out512[27],q512,n[9]);
	t512[10] = _mm512_madd52lo_epu64(t512[10],q512,n[10]);
	t512[11] = _mm512_madd52hi_epu64(out512[28],q512,n[10]);
	t512[11] = _mm512_madd52lo_epu64(t512[11],q512,n[11]);
	t512[12] = _mm512_madd52hi_epu64(out512[29],q512,n[11]);
	t512[12] = _mm512_madd52lo_epu64(t512[12],q512,n[12]);
	t512[13] = _mm512_madd52hi_epu64(out512[30],q512,n[12]);
	t512[13] = _mm512_madd52lo_epu64(t512[13],q512,n[13]);
	t512[14] = _mm512_madd52hi_epu64(out512[31],q512,n[13]);
	t512[14] = _mm512_madd52lo_epu64(t512[14],q512,n[14]);
	t512[15] = _mm512_madd52hi_epu64(out512[32],q512,n[14]);
	t512[15] = _mm512_madd52lo_epu64(t512[15],q512,n[15]);
	t512[16] = _mm512_madd52hi_epu64(out512[33],q512,n[15]);
	t512[16] = _mm512_madd52lo_epu64(t512[16],q512,n[16]);
	t512[17] = _mm512_madd52hi_epu64(out512[34],q512,n[16]);
	t512[17] = _mm512_madd52lo_epu64(t512[17],q512,n[17]);
	t512[18] = _mm512_madd52hi_epu64(out512[35],q512,n[17]);
	t512[18] = _mm512_madd52lo_epu64(t512[18],q512,n[18]);
	t512[19] = _mm512_madd52hi_epu64(out512[36],q512,n[18]);
	t512[19] = _mm512_madd52lo_epu64(t512[19],q512,n[19]);
	t512[20] = _mm512_madd52hi_epu64(out512[37],q512,n[19]);

	carry  = _mm512_srli_epi64(t512[0],52);
	out512[17] = _mm512_and_si512(t512[0],mask52);
	t512[1] = _mm512_add_epi64(carry,t512[1]);
	carry  = _mm512_srli_epi64(t512[1],52);
	out512[18] = _mm512_and_si512(t512[1],mask52);
	t512[2] = _mm512_add_epi64(carry,t512[2]);
	carry  = _mm512_srli_epi64(t512[2],52);
	out512[19] = _mm512_and_si512(t512[2],mask52);
	t512[3] = _mm512_add_epi64(carry,t512[3]);
	carry  = _mm512_srli_epi64(t512[3],52);
	out512[20] = _mm512_and_si512(t512[3],mask52);
	t512[4] = _mm512_add_epi64(carry,t512[4]);
	carry  = _mm512_srli_epi64(t512[4],52);
	out512[21] = _mm512_and_si512(t512[4],mask52);
	t512[5] = _mm512_add_epi64(carry,t512[5]);
	carry  = _mm512_srli_epi64(t512[5],52);
	out512[22] = _mm512_and_si512(t512[5],mask52);
	t512[6] = _mm512_add_epi64(carry,t512[6]);
	carry  = _mm512_srli_epi64(t512[6],52);
	out512[23] = _mm512_and_si512(t512[6],mask52);
	t512[7] = _mm512_add_epi64(carry,t512[7]);
	carry  = _mm512_srli_epi64(t512[7],52);
	out512[24] = _mm512_and_si512(t512[7],mask52);
	t512[8] = _mm512_add_epi64(carry,t512[8]);
	carry  = _mm512_srli_epi64(t512[8],52);
	out512[25] = _mm512_and_si512(t512[8],mask52);
	t512[9] = _mm512_add_epi64(carry,t512[9]);
	carry  = _mm512_srli_epi64(t512[9],52);
	out512[26] = _mm512_and_si512(t512[9],mask52);
	t512[10] = _mm512_add_epi64(carry,t512[10]);
	carry  = _mm512_srli_epi64(t512[10],52);
	out512[27] = _mm512_and_si512(t512[10],mask52);
	t512[11] = _mm512_add_epi64(carry,t512[11]);
	carry  = _mm512_srli_epi64(t512[11],52);
	out512[28] = _mm512_and_si512(t512[11],mask52);
	t512[12] = _mm512_add_epi64(carry,t512[12]);
	carry  = _mm512_srli_epi64(t512[12],52);
	out512[29] = _mm512_and_si512(t512[12],mask52);
	t512[13] = _mm512_add_epi64(carry,t512[13]);
	carry  = _mm512_srli_epi64(t512[13],52);
	out512[30] = _mm512_and_si512(t512[13],mask52);
	t512[14] = _mm512_add_epi64(carry,t512[14]);
	carry  = _mm512_srli_epi64(t512[14],52);
	out512[31] = _mm512_and_si512(t512[14],mask52);
	t512[15] = _mm512_add_epi64(carry,t512[15]);
	carry  = _mm512_srli_epi64(t512[15],52);
	out512[32] = _mm512_and_si512(t512[15],mask52);
	t512[16] = _mm512_add_epi64(carry,t512[16]);
	carry  = _mm512_srli_epi64(t512[16],52);
	out512[33] = _mm512_and_si512(t512[16],mask52);
	t512[17] = _mm512_add_epi64(carry,t512[17]);
	carry  = _mm512_srli_epi64(t512[17],52);
	out512[34] = _mm512_and_si512(t512[17],mask52);
	t512[18] = _mm512_add_epi64(carry,t512[18]);
	carry  = _mm512_srli_epi64(t512[18],52);
	out512[35] = _mm512_and_si512(t512[18],mask52);
	t512[19] = _mm512_add_epi64(carry,t512[19]);
	carry  = _mm512_srli_epi64(t512[19],52);
	out512[36] = _mm512_and_si512(t512[19],mask52);
	out512[37] = _mm512_add_epi64(t512[20],carry);


	//Y = Y + a_iB

	out512[18] = _mm512_madd52lo_epu64(out512[18],a512[18],b512[0]);
	out512[19] = _mm512_madd52hi_epu64(out512[19],a512[18],b512[0]);
	out512[19] = _mm512_madd52lo_epu64(out512[19],a512[18],b512[1]);
	out512[20] = _mm512_madd52hi_epu64(out512[20],a512[18],b512[1]);
	out512[20] = _mm512_madd52lo_epu64(out512[20],a512[18],b512[2]);
	out512[21] = _mm512_madd52hi_epu64(out512[21],a512[18],b512[2]);
	out512[21] = _mm512_madd52lo_epu64(out512[21],a512[18],b512[3]);
	out512[22] = _mm512_madd52hi_epu64(out512[22],a512[18],b512[3]);
	out512[22] = _mm512_madd52lo_epu64(out512[22],a512[18],b512[4]);
	out512[23] = _mm512_madd52hi_epu64(out512[23],a512[18],b512[4]);
	out512[23] = _mm512_madd52lo_epu64(out512[23],a512[18],b512[5]);
	out512[24] = _mm512_madd52hi_epu64(out512[24],a512[18],b512[5]);
	out512[24] = _mm512_madd52lo_epu64(out512[24],a512[18],b512[6]);
	out512[25] = _mm512_madd52hi_epu64(out512[25],a512[18],b512[6]);
	out512[25] = _mm512_madd52lo_epu64(out512[25],a512[18],b512[7]);
	out512[26] = _mm512_madd52hi_epu64(out512[26],a512[18],b512[7]);
	out512[26] = _mm512_madd52lo_epu64(out512[26],a512[18],b512[8]);
	out512[27] = _mm512_madd52hi_epu64(out512[27],a512[18],b512[8]);
	out512[27] = _mm512_madd52lo_epu64(out512[27],a512[18],b512[9]);
	out512[28] = _mm512_madd52hi_epu64(out512[28],a512[18],b512[9]);
	out512[28] = _mm512_madd52lo_epu64(out512[28],a512[18],b512[10]);
	out512[29] = _mm512_madd52hi_epu64(out512[29],a512[18],b512[10]);
	out512[29] = _mm512_madd52lo_epu64(out512[29],a512[18],b512[11]);
	out512[30] = _mm512_madd52hi_epu64(out512[30],a512[18],b512[11]);
	out512[30] = _mm512_madd52lo_epu64(out512[30],a512[18],b512[12]);
	out512[31] = _mm512_madd52hi_epu64(out512[31],a512[18],b512[12]);
	out512[31] = _mm512_madd52lo_epu64(out512[31],a512[18],b512[13]);
	out512[32] = _mm512_madd52hi_epu64(out512[32],a512[18],b512[13]);
	out512[32] = _mm512_madd52lo_epu64(out512[32],a512[18],b512[14]);
	out512[33] = _mm512_madd52hi_epu64(out512[33],a512[18],b512[14]);
	out512[33] = _mm512_madd52lo_epu64(out512[33],a512[18],b512[15]);
	out512[34] = _mm512_madd52hi_epu64(out512[34],a512[18],b512[15]);
	out512[34] = _mm512_madd52lo_epu64(out512[34],a512[18],b512[16]);
	out512[35] = _mm512_madd52hi_epu64(out512[35],a512[18],b512[16]);
	out512[35] = _mm512_madd52lo_epu64(out512[35],a512[18],b512[17]);
	out512[36] = _mm512_madd52hi_epu64(out512[36],a512[18],b512[17]);
	out512[36] = _mm512_madd52lo_epu64(out512[36],a512[18],b512[18]);
	out512[37] = _mm512_madd52hi_epu64(out512[37],a512[18],b512[18]);
	out512[37] = _mm512_madd52lo_epu64(out512[37],a512[18],b512[19]);
	out512[38] = _mm512_madd52hi_epu64(zero,a512[18],b512[19]);

	q512 = _mm512_madd52lo_epu64(zero,out512[18],n_prime[0]);

	t512[0] = _mm512_madd52lo_epu64(out512[18],q512,n[0]);
	t512[1] = _mm512_madd52hi_epu64(out512[19],q512,n[0]);
	t512[1] = _mm512_madd52lo_epu64(t512[1],q512,n[1]);
	t512[2] = _mm512_madd52hi_epu64(out512[20],q512,n[1]);
	t512[2] = _mm512_madd52lo_epu64(t512[2],q512,n[2]);
	t512[3] = _mm512_madd52hi_epu64(out512[21],q512,n[2]);
	t512[3] = _mm512_madd52lo_epu64(t512[3],q512,n[3]);
	t512[4] = _mm512_madd52hi_epu64(out512[22],q512,n[3]);
	t512[4] = _mm512_madd52lo_epu64(t512[4],q512,n[4]);
	t512[5] = _mm512_madd52hi_epu64(out512[23],q512,n[4]);
	t512[5] = _mm512_madd52lo_epu64(t512[5],q512,n[5]);
	t512[6] = _mm512_madd52hi_epu64(out512[24],q512,n[5]);
	t512[6] = _mm512_madd52lo_epu64(t512[6],q512,n[6]);
	t512[7] = _mm512_madd52hi_epu64(out512[25],q512,n[6]);
	t512[7] = _mm512_madd52lo_epu64(t512[7],q512,n[7]);
	t512[8] = _mm512_madd52hi_epu64(out512[26],q512,n[7]);
	t512[8] = _mm512_madd52lo_epu64(t512[8],q512,n[8]);
	t512[9] = _mm512_madd52hi_epu64(out512[27],q512,n[8]);
	t512[9] = _mm512_madd52lo_epu64(t512[9],q512,n[9]);
	t512[10] = _mm512_madd52hi_epu64(out512[28],q512,n[9]);
	t512[10] = _mm512_madd52lo_epu64(t512[10],q512,n[10]);
	t512[11] = _mm512_madd52hi_epu64(out512[29],q512,n[10]);
	t512[11] = _mm512_madd52lo_epu64(t512[11],q512,n[11]);
	t512[12] = _mm512_madd52hi_epu64(out512[30],q512,n[11]);
	t512[12] = _mm512_madd52lo_epu64(t512[12],q512,n[12]);
	t512[13] = _mm512_madd52hi_epu64(out512[31],q512,n[12]);
	t512[13] = _mm512_madd52lo_epu64(t512[13],q512,n[13]);
	t512[14] = _mm512_madd52hi_epu64(out512[32],q512,n[13]);
	t512[14] = _mm512_madd52lo_epu64(t512[14],q512,n[14]);
	t512[15] = _mm512_madd52hi_epu64(out512[33],q512,n[14]);
	t512[15] = _mm512_madd52lo_epu64(t512[15],q512,n[15]);
	t512[16] = _mm512_madd52hi_epu64(out512[34],q512,n[15]);
	t512[16] = _mm512_madd52lo_epu64(t512[16],q512,n[16]);
	t512[17] = _mm512_madd52hi_epu64(out512[35],q512,n[16]);
	t512[17] = _mm512_madd52lo_epu64(t512[17],q512,n[17]);
	t512[18] = _mm512_madd52hi_epu64(out512[36],q512,n[17]);
	t512[18] = _mm512_madd52lo_epu64(t512[18],q512,n[18]);
	t512[19] = _mm512_madd52hi_epu64(out512[37],q512,n[18]);
	t512[19] = _mm512_madd52lo_epu64(t512[19],q512,n[19]);
	t512[20] = _mm512_madd52hi_epu64(out512[38],q512,n[19]);

	carry  = _mm512_srli_epi64(t512[0],52);
	out512[18] = _mm512_and_si512(t512[0],mask52);
	t512[1] = _mm512_add_epi64(carry,t512[1]);
	carry  = _mm512_srli_epi64(t512[1],52);
	out512[19] = _mm512_and_si512(t512[1],mask52);
	t512[2] = _mm512_add_epi64(carry,t512[2]);
	carry  = _mm512_srli_epi64(t512[2],52);
	out512[20] = _mm512_and_si512(t512[2],mask52);
	t512[3] = _mm512_add_epi64(carry,t512[3]);
	carry  = _mm512_srli_epi64(t512[3],52);
	out512[21] = _mm512_and_si512(t512[3],mask52);
	t512[4] = _mm512_add_epi64(carry,t512[4]);
	carry  = _mm512_srli_epi64(t512[4],52);
	out512[22] = _mm512_and_si512(t512[4],mask52);
	t512[5] = _mm512_add_epi64(carry,t512[5]);
	carry  = _mm512_srli_epi64(t512[5],52);
	out512[23] = _mm512_and_si512(t512[5],mask52);
	t512[6] = _mm512_add_epi64(carry,t512[6]);
	carry  = _mm512_srli_epi64(t512[6],52);
	out512[24] = _mm512_and_si512(t512[6],mask52);
	t512[7] = _mm512_add_epi64(carry,t512[7]);
	carry  = _mm512_srli_epi64(t512[7],52);
	out512[25] = _mm512_and_si512(t512[7],mask52);
	t512[8] = _mm512_add_epi64(carry,t512[8]);
	carry  = _mm512_srli_epi64(t512[8],52);
	out512[26] = _mm512_and_si512(t512[8],mask52);
	t512[9] = _mm512_add_epi64(carry,t512[9]);
	carry  = _mm512_srli_epi64(t512[9],52);
	out512[27] = _mm512_and_si512(t512[9],mask52);
	t512[10] = _mm512_add_epi64(carry,t512[10]);
	carry  = _mm512_srli_epi64(t512[10],52);
	out512[28] = _mm512_and_si512(t512[10],mask52);
	t512[11] = _mm512_add_epi64(carry,t512[11]);
	carry  = _mm512_srli_epi64(t512[11],52);
	out512[29] = _mm512_and_si512(t512[11],mask52);
	t512[12] = _mm512_add_epi64(carry,t512[12]);
	carry  = _mm512_srli_epi64(t512[12],52);
	out512[30] = _mm512_and_si512(t512[12],mask52);
	t512[13] = _mm512_add_epi64(carry,t512[13]);
	carry  = _mm512_srli_epi64(t512[13],52);
	out512[31] = _mm512_and_si512(t512[13],mask52);
	t512[14] = _mm512_add_epi64(carry,t512[14]);
	carry  = _mm512_srli_epi64(t512[14],52);
	out512[32] = _mm512_and_si512(t512[14],mask52);
	t512[15] = _mm512_add_epi64(carry,t512[15]);
	carry  = _mm512_srli_epi64(t512[15],52);
	out512[33] = _mm512_and_si512(t512[15],mask52);
	t512[16] = _mm512_add_epi64(carry,t512[16]);
	carry  = _mm512_srli_epi64(t512[16],52);
	out512[34] = _mm512_and_si512(t512[16],mask52);
	t512[17] = _mm512_add_epi64(carry,t512[17]);
	carry  = _mm512_srli_epi64(t512[17],52);
	out512[35] = _mm512_and_si512(t512[17],mask52);
	t512[18] = _mm512_add_epi64(carry,t512[18]);
	carry  = _mm512_srli_epi64(t512[18],52);
	out512[36] = _mm512_and_si512(t512[18],mask52);
	t512[19] = _mm512_add_epi64(carry,t512[19]);
	carry  = _mm512_srli_epi64(t512[19],52);
	out512[37] = _mm512_and_si512(t512[19],mask52);
	out512[38] = _mm512_add_epi64(t512[20],carry);

	out512[19] = _mm512_madd52lo_epu64(out512[19],a512[19],b512[0]);
	out512[20] = _mm512_madd52hi_epu64(out512[20],a512[19],b512[0]);
	out512[20] = _mm512_madd52lo_epu64(out512[20],a512[19],b512[1]);
	out512[21] = _mm512_madd52hi_epu64(out512[21],a512[19],b512[1]);
	out512[21] = _mm512_madd52lo_epu64(out512[21],a512[19],b512[2]);
	out512[22] = _mm512_madd52hi_epu64(out512[22],a512[19],b512[2]);
	out512[22] = _mm512_madd52lo_epu64(out512[22],a512[19],b512[3]);
	out512[23] = _mm512_madd52hi_epu64(out512[23],a512[19],b512[3]);
	out512[23] = _mm512_madd52lo_epu64(out512[23],a512[19],b512[4]);
	out512[24] = _mm512_madd52hi_epu64(out512[24],a512[19],b512[4]);
	out512[24] = _mm512_madd52lo_epu64(out512[24],a512[19],b512[5]);
	out512[25] = _mm512_madd52hi_epu64(out512[25],a512[19],b512[5]);
	out512[25] = _mm512_madd52lo_epu64(out512[25],a512[19],b512[6]);
	out512[26] = _mm512_madd52hi_epu64(out512[26],a512[19],b512[6]);
	out512[26] = _mm512_madd52lo_epu64(out512[26],a512[19],b512[7]);
	out512[27] = _mm512_madd52hi_epu64(out512[27],a512[19],b512[7]);
	out512[27] = _mm512_madd52lo_epu64(out512[27],a512[19],b512[8]);
	out512[28] = _mm512_madd52hi_epu64(out512[28],a512[19],b512[8]);
	out512[28] = _mm512_madd52lo_epu64(out512[28],a512[19],b512[9]);
	out512[29] = _mm512_madd52hi_epu64(out512[29],a512[19],b512[9]);
	out512[29] = _mm512_madd52lo_epu64(out512[29],a512[19],b512[10]);
	out512[30] = _mm512_madd52hi_epu64(out512[30],a512[19],b512[10]);
	out512[30] = _mm512_madd52lo_epu64(out512[30],a512[19],b512[11]);
	out512[31] = _mm512_madd52hi_epu64(out512[31],a512[19],b512[11]);
	out512[31] = _mm512_madd52lo_epu64(out512[31],a512[19],b512[12]);
	out512[32] = _mm512_madd52hi_epu64(out512[32],a512[19],b512[12]);
	out512[32] = _mm512_madd52lo_epu64(out512[32],a512[19],b512[13]);
	out512[33] = _mm512_madd52hi_epu64(out512[33],a512[19],b512[13]);
	out512[33] = _mm512_madd52lo_epu64(out512[33],a512[19],b512[14]);
	out512[34] = _mm512_madd52hi_epu64(out512[34],a512[19],b512[14]);
	out512[34] = _mm512_madd52lo_epu64(out512[34],a512[19],b512[15]);
	out512[35] = _mm512_madd52hi_epu64(out512[35],a512[19],b512[15]);
	out512[35] = _mm512_madd52lo_epu64(out512[35],a512[19],b512[16]);
	out512[36] = _mm512_madd52hi_epu64(out512[36],a512[19],b512[16]);
	out512[36] = _mm512_madd52lo_epu64(out512[36],a512[19],b512[17]);
	out512[37] = _mm512_madd52hi_epu64(out512[37],a512[19],b512[17]);
	out512[37] = _mm512_madd52lo_epu64(out512[37],a512[19],b512[18]);
	out512[38] = _mm512_madd52hi_epu64(out512[38],a512[19],b512[18]);
	out512[38] = _mm512_madd52lo_epu64(out512[38],a512[19],b512[19]);
	out512[39] = _mm512_madd52hi_epu64(zero,a512[19],b512[19]);

	q512 = _mm512_madd52lo_epu64(zero,out512[19],n_prime[0]);

	t512[0] = _mm512_madd52lo_epu64(out512[19],q512,n[0]);
	t512[1] = _mm512_madd52hi_epu64(out512[20],q512,n[0]);
	t512[1] = _mm512_madd52lo_epu64(t512[1],q512,n[1]);
	t512[2] = _mm512_madd52hi_epu64(out512[21],q512,n[1]);
	t512[2] = _mm512_madd52lo_epu64(t512[2],q512,n[2]);
	t512[3] = _mm512_madd52hi_epu64(out512[22],q512,n[2]);
	t512[3] = _mm512_madd52lo_epu64(t512[3],q512,n[3]);
	t512[4] = _mm512_madd52hi_epu64(out512[23],q512,n[3]);
	t512[4] = _mm512_madd52lo_epu64(t512[4],q512,n[4]);
	t512[5] = _mm512_madd52hi_epu64(out512[24],q512,n[4]);
	t512[5] = _mm512_madd52lo_epu64(t512[5],q512,n[5]);
	t512[6] = _mm512_madd52hi_epu64(out512[25],q512,n[5]);
	t512[6] = _mm512_madd52lo_epu64(t512[6],q512,n[6]);
	t512[7] = _mm512_madd52hi_epu64(out512[26],q512,n[6]);
	t512[7] = _mm512_madd52lo_epu64(t512[7],q512,n[7]);
	t512[8] = _mm512_madd52hi_epu64(out512[27],q512,n[7]);
	t512[8] = _mm512_madd52lo_epu64(t512[8],q512,n[8]);
	t512[9] = _mm512_madd52hi_epu64(out512[28],q512,n[8]);
	t512[9] = _mm512_madd52lo_epu64(t512[9],q512,n[9]);
	t512[10] = _mm512_madd52hi_epu64(out512[29],q512,n[9]);
	t512[10] = _mm512_madd52lo_epu64(t512[10],q512,n[10]);
	t512[11] = _mm512_madd52hi_epu64(out512[30],q512,n[10]);
	t512[11] = _mm512_madd52lo_epu64(t512[11],q512,n[11]);
	t512[12] = _mm512_madd52hi_epu64(out512[31],q512,n[11]);
	t512[12] = _mm512_madd52lo_epu64(t512[12],q512,n[12]);
	t512[13] = _mm512_madd52hi_epu64(out512[32],q512,n[12]);
	t512[13] = _mm512_madd52lo_epu64(t512[13],q512,n[13]);
	t512[14] = _mm512_madd52hi_epu64(out512[33],q512,n[13]);
	t512[14] = _mm512_madd52lo_epu64(t512[14],q512,n[14]);
	t512[15] = _mm512_madd52hi_epu64(out512[34],q512,n[14]);
	t512[15] = _mm512_madd52lo_epu64(t512[15],q512,n[15]);
	t512[16] = _mm512_madd52hi_epu64(out512[35],q512,n[15]);
	t512[16] = _mm512_madd52lo_epu64(t512[16],q512,n[16]);
	t512[17] = _mm512_madd52hi_epu64(out512[36],q512,n[16]);
	t512[17] = _mm512_madd52lo_epu64(t512[17],q512,n[17]);
	t512[18] = _mm512_madd52hi_epu64(out512[37],q512,n[17]);
	t512[18] = _mm512_madd52lo_epu64(t512[18],q512,n[18]);
	t512[19] = _mm512_madd52hi_epu64(out512[38],q512,n[18]);
	t512[19] = _mm512_madd52lo_epu64(t512[19],q512,n[19]);
	t512[20] = _mm512_madd52hi_epu64(out512[39],q512,n[19]);

	carry  = _mm512_srli_epi64(t512[0],52);
	t512[1] = _mm512_add_epi64(carry,t512[1]);
	carry  = _mm512_srli_epi64(t512[1],52);
	out[0] = _mm512_and_si512(t512[1],mask52);
	t512[2] = _mm512_add_epi64(carry,t512[2]);
	carry  = _mm512_srli_epi64(t512[2],52);
	out[1] = _mm512_and_si512(t512[2],mask52);
	t512[3] = _mm512_add_epi64(carry,t512[3]);
	carry  = _mm512_srli_epi64(t512[3],52);
	out[2] = _mm512_and_si512(t512[3],mask52);
	t512[4] = _mm512_add_epi64(carry,t512[4]);
	carry  = _mm512_srli_epi64(t512[4],52);
	out[3] = _mm512_and_si512(t512[4],mask52);
	t512[5] = _mm512_add_epi64(carry,t512[5]);
	carry  = _mm512_srli_epi64(t512[5],52);
	out[4] = _mm512_and_si512(t512[5],mask52);
	t512[6] = _mm512_add_epi64(carry,t512[6]);
	carry  = _mm512_srli_epi64(t512[6],52);
	out[5] = _mm512_and_si512(t512[6],mask52);
	t512[7] = _mm512_add_epi64(carry,t512[7]);
	carry  = _mm512_srli_epi64(t512[7],52);
	out[6] = _mm512_and_si512(t512[7],mask52);
	t512[8] = _mm512_add_epi64(carry,t512[8]);
	carry  = _mm512_srli_epi64(t512[8],52);
	out[7] = _mm512_and_si512(t512[8],mask52);
	t512[9] = _mm512_add_epi64(carry,t512[9]);
	carry  = _mm512_srli_epi64(t512[9],52);
	out[8] = _mm512_and_si512(t512[9],mask52);
	t512[10] = _mm512_add_epi64(carry,t512[10]);
	carry  = _mm512_srli_epi64(t512[10],52);
	out[9] = _mm512_and_si512(t512[10],mask52);
	t512[11] = _mm512_add_epi64(carry,t512[11]);
	carry  = _mm512_srli_epi64(t512[11],52);
	out[10] = _mm512_and_si512(t512[11],mask52);
	t512[12] = _mm512_add_epi64(carry,t512[12]);
	carry  = _mm512_srli_epi64(t512[12],52);
	out[11] = _mm512_and_si512(t512[12],mask52);
	t512[13] = _mm512_add_epi64(carry,t512[13]);
	carry  = _mm512_srli_epi64(t512[13],52);
	out[12] = _mm512_and_si512(t512[13],mask52);
	t512[14] = _mm512_add_epi64(carry,t512[14]);
	carry  = _mm512_srli_epi64(t512[14],52);
	out[13] = _mm512_and_si512(t512[14],mask52);
	t512[15] = _mm512_add_epi64(carry,t512[15]);
	carry  = _mm512_srli_epi64(t512[15],52);
	out[14] = _mm512_and_si512(t512[15],mask52);
	t512[16] = _mm512_add_epi64(carry,t512[16]);
	carry  = _mm512_srli_epi64(t512[16],52);
	out[15] = _mm512_and_si512(t512[16],mask52);
	t512[17] = _mm512_add_epi64(carry,t512[17]);
	carry  = _mm512_srli_epi64(t512[17],52);
	out[16] = _mm512_and_si512(t512[17],mask52);
	t512[18] = _mm512_add_epi64(carry,t512[18]);
	carry  = _mm512_srli_epi64(t512[18],52);
	out[17] = _mm512_and_si512(t512[18],mask52);
	t512[19] = _mm512_add_epi64(carry,t512[19]);
	carry  = _mm512_srli_epi64(t512[19],52);
	out[18] = _mm512_and_si512(t512[19],mask52);
	out[19] = _mm512_add_epi64(t512[20],carry);
	
	//final subtraction
	
	/*
	__m512i maskSub = zero - (out[19]>>36);
	//__m512i 
	carry = zero;
	__m512i sub = carry + (n[0]&maskSub);
	out[0] = out[0]-sub;
	carry = (out[0]>>52)&1;
	
	for(int i=1;i<20;i++)
	{
		out[i-1] = _mm512_and_si512(mask52,out[i-1]);
		__m512i sub = carry + (n[i]&maskSub);
		out[i] = out[i]-sub;
		carry = (out[i]>>52)&1;
	}

	out[19] = _mm512_and_si512(mask36,out[19]);//*/

}


