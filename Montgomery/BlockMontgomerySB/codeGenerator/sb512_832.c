/* Schoolbook multiplication */

inline void force_inline mul512_8_SIZE(__m512i out[32], __m512i a512[16], __m512i b512[16])
{
	out[0] = _mm512_madd52lo_epu64(zero,a512[0],b512[0]);

	out[1] = _mm512_madd52hi_epu64(carry,a512[0],b512[0]);
	out[1] = _mm512_madd52lo_epu64(out[1],a512[1],b512[0]);
	out[1] = _mm512_madd52lo_epu64(out[1],a512[0],b512[1]);
	carry  = _mm512_srli(out[1],52);
	out[1] = _mm512_and_si512([1],mask52);

	out[2] = _mm512_madd52hi_epu64(carry,a512[1],b512[0]);
	out[2] = _mm512_madd52hi_epu64(out[2],a512[0],b512[1]);
	out[2] = _mm512_madd52lo_epu64(out[2],a512[2],b512[0]);
	out[2] = _mm512_madd52lo_epu64(out[2],a512[1],b512[1]);
	out[2] = _mm512_madd52lo_epu64(out[2],a512[0],b512[2]);
	carry  = _mm512_srli(out[2],52);
	out[2] = _mm512_and_si512([2],mask52);

	out[3] = _mm512_madd52hi_epu64(carry,a512[2],b512[0]);
	out[3] = _mm512_madd52hi_epu64(out[3],a512[1],b512[1]);
	out[3] = _mm512_madd52hi_epu64(out[3],a512[0],b512[2]);
	out[3] = _mm512_madd52lo_epu64(out[3],a512[3],b512[0]);
	out[3] = _mm512_madd52lo_epu64(out[3],a512[2],b512[1]);
	out[3] = _mm512_madd52lo_epu64(out[3],a512[1],b512[2]);
	out[3] = _mm512_madd52lo_epu64(out[3],a512[0],b512[3]);
	carry  = _mm512_srli(out[3],52);
	out[3] = _mm512_and_si512([3],mask52);

	out[4] = _mm512_madd52hi_epu64(carry,a512[3],b512[0]);
	out[4] = _mm512_madd52hi_epu64(out[4],a512[2],b512[1]);
	out[4] = _mm512_madd52hi_epu64(out[4],a512[1],b512[2]);
	out[4] = _mm512_madd52hi_epu64(out[4],a512[0],b512[3]);
	out[4] = _mm512_madd52lo_epu64(out[4],a512[4],b512[0]);
	out[4] = _mm512_madd52lo_epu64(out[4],a512[3],b512[1]);
	out[4] = _mm512_madd52lo_epu64(out[4],a512[2],b512[2]);
	out[4] = _mm512_madd52lo_epu64(out[4],a512[1],b512[3]);
	out[4] = _mm512_madd52lo_epu64(out[4],a512[0],b512[4]);
	carry  = _mm512_srli(out[4],52);
	out[4] = _mm512_and_si512([4],mask52);

	out[5] = _mm512_madd52hi_epu64(carry,a512[4],b512[0]);
	out[5] = _mm512_madd52hi_epu64(out[5],a512[3],b512[1]);
	out[5] = _mm512_madd52hi_epu64(out[5],a512[2],b512[2]);
	out[5] = _mm512_madd52hi_epu64(out[5],a512[1],b512[3]);
	out[5] = _mm512_madd52hi_epu64(out[5],a512[0],b512[4]);
	out[5] = _mm512_madd52lo_epu64(out[5],a512[5],b512[0]);
	out[5] = _mm512_madd52lo_epu64(out[5],a512[4],b512[1]);
	out[5] = _mm512_madd52lo_epu64(out[5],a512[3],b512[2]);
	out[5] = _mm512_madd52lo_epu64(out[5],a512[2],b512[3]);
	out[5] = _mm512_madd52lo_epu64(out[5],a512[1],b512[4]);
	out[5] = _mm512_madd52lo_epu64(out[5],a512[0],b512[5]);
	carry  = _mm512_srli(out[5],52);
	out[5] = _mm512_and_si512([5],mask52);

	out[6] = _mm512_madd52hi_epu64(carry,a512[5],b512[0]);
	out[6] = _mm512_madd52hi_epu64(out[6],a512[4],b512[1]);
	out[6] = _mm512_madd52hi_epu64(out[6],a512[3],b512[2]);
	out[6] = _mm512_madd52hi_epu64(out[6],a512[2],b512[3]);
	out[6] = _mm512_madd52hi_epu64(out[6],a512[1],b512[4]);
	out[6] = _mm512_madd52hi_epu64(out[6],a512[0],b512[5]);
	out[6] = _mm512_madd52lo_epu64(out[6],a512[6],b512[0]);
	out[6] = _mm512_madd52lo_epu64(out[6],a512[5],b512[1]);
	out[6] = _mm512_madd52lo_epu64(out[6],a512[4],b512[2]);
	out[6] = _mm512_madd52lo_epu64(out[6],a512[3],b512[3]);
	out[6] = _mm512_madd52lo_epu64(out[6],a512[2],b512[4]);
	out[6] = _mm512_madd52lo_epu64(out[6],a512[1],b512[5]);
	out[6] = _mm512_madd52lo_epu64(out[6],a512[0],b512[6]);
	carry  = _mm512_srli(out[6],52);
	out[6] = _mm512_and_si512([6],mask52);

	out[7] = _mm512_madd52hi_epu64(carry,a512[6],b512[0]);
	out[7] = _mm512_madd52hi_epu64(out[7],a512[5],b512[1]);
	out[7] = _mm512_madd52hi_epu64(out[7],a512[4],b512[2]);
	out[7] = _mm512_madd52hi_epu64(out[7],a512[3],b512[3]);
	out[7] = _mm512_madd52hi_epu64(out[7],a512[2],b512[4]);
	out[7] = _mm512_madd52hi_epu64(out[7],a512[1],b512[5]);
	out[7] = _mm512_madd52hi_epu64(out[7],a512[0],b512[6]);
	out[7] = _mm512_madd52lo_epu64(out[7],a512[7],b512[0]);
	out[7] = _mm512_madd52lo_epu64(out[7],a512[6],b512[1]);
	out[7] = _mm512_madd52lo_epu64(out[7],a512[5],b512[2]);
	out[7] = _mm512_madd52lo_epu64(out[7],a512[4],b512[3]);
	out[7] = _mm512_madd52lo_epu64(out[7],a512[3],b512[4]);
	out[7] = _mm512_madd52lo_epu64(out[7],a512[2],b512[5]);
	out[7] = _mm512_madd52lo_epu64(out[7],a512[1],b512[6]);
	out[7] = _mm512_madd52lo_epu64(out[7],a512[0],b512[7]);
	carry  = _mm512_srli(out[7],52);
	out[7] = _mm512_and_si512([7],mask52);

	out[8] = _mm512_madd52hi_epu64(carry,a512[7],b512[0]);
	out[8] = _mm512_madd52hi_epu64(out[8],a512[6],b512[1]);
	out[8] = _mm512_madd52hi_epu64(out[8],a512[5],b512[2]);
	out[8] = _mm512_madd52hi_epu64(out[8],a512[4],b512[3]);
	out[8] = _mm512_madd52hi_epu64(out[8],a512[3],b512[4]);
	out[8] = _mm512_madd52hi_epu64(out[8],a512[2],b512[5]);
	out[8] = _mm512_madd52hi_epu64(out[8],a512[1],b512[6]);
	out[8] = _mm512_madd52hi_epu64(out[8],a512[0],b512[7]);
	out[8] = _mm512_madd52lo_epu64(out[8],a512[8],b512[0]);
	out[8] = _mm512_madd52lo_epu64(out[8],a512[7],b512[1]);
	out[8] = _mm512_madd52lo_epu64(out[8],a512[6],b512[2]);
	out[8] = _mm512_madd52lo_epu64(out[8],a512[5],b512[3]);
	out[8] = _mm512_madd52lo_epu64(out[8],a512[4],b512[4]);
	out[8] = _mm512_madd52lo_epu64(out[8],a512[3],b512[5]);
	out[8] = _mm512_madd52lo_epu64(out[8],a512[2],b512[6]);
	out[8] = _mm512_madd52lo_epu64(out[8],a512[1],b512[7]);
	out[8] = _mm512_madd52lo_epu64(out[8],a512[0],b512[8]);
	carry  = _mm512_srli(out[8],52);
	out[8] = _mm512_and_si512([8],mask52);

	out[9] = _mm512_madd52hi_epu64(carry,a512[8],b512[0]);
	out[9] = _mm512_madd52hi_epu64(out[9],a512[7],b512[1]);
	out[9] = _mm512_madd52hi_epu64(out[9],a512[6],b512[2]);
	out[9] = _mm512_madd52hi_epu64(out[9],a512[5],b512[3]);
	out[9] = _mm512_madd52hi_epu64(out[9],a512[4],b512[4]);
	out[9] = _mm512_madd52hi_epu64(out[9],a512[3],b512[5]);
	out[9] = _mm512_madd52hi_epu64(out[9],a512[2],b512[6]);
	out[9] = _mm512_madd52hi_epu64(out[9],a512[1],b512[7]);
	out[9] = _mm512_madd52hi_epu64(out[9],a512[0],b512[8]);
	out[9] = _mm512_madd52lo_epu64(out[9],a512[9],b512[0]);
	out[9] = _mm512_madd52lo_epu64(out[9],a512[8],b512[1]);
	out[9] = _mm512_madd52lo_epu64(out[9],a512[7],b512[2]);
	out[9] = _mm512_madd52lo_epu64(out[9],a512[6],b512[3]);
	out[9] = _mm512_madd52lo_epu64(out[9],a512[5],b512[4]);
	out[9] = _mm512_madd52lo_epu64(out[9],a512[4],b512[5]);
	out[9] = _mm512_madd52lo_epu64(out[9],a512[3],b512[6]);
	out[9] = _mm512_madd52lo_epu64(out[9],a512[2],b512[7]);
	out[9] = _mm512_madd52lo_epu64(out[9],a512[1],b512[8]);
	out[9] = _mm512_madd52lo_epu64(out[9],a512[0],b512[9]);
	carry  = _mm512_srli(out[9],52);
	out[9] = _mm512_and_si512([9],mask52);

	out[10] = _mm512_madd52hi_epu64(carry,a512[9],b512[0]);
	out[10] = _mm512_madd52hi_epu64(out[10],a512[8],b512[1]);
	out[10] = _mm512_madd52hi_epu64(out[10],a512[7],b512[2]);
	out[10] = _mm512_madd52hi_epu64(out[10],a512[6],b512[3]);
	out[10] = _mm512_madd52hi_epu64(out[10],a512[5],b512[4]);
	out[10] = _mm512_madd52hi_epu64(out[10],a512[4],b512[5]);
	out[10] = _mm512_madd52hi_epu64(out[10],a512[3],b512[6]);
	out[10] = _mm512_madd52hi_epu64(out[10],a512[2],b512[7]);
	out[10] = _mm512_madd52hi_epu64(out[10],a512[1],b512[8]);
	out[10] = _mm512_madd52hi_epu64(out[10],a512[0],b512[9]);
	out[10] = _mm512_madd52lo_epu64(out[10],a512[10],b512[0]);
	out[10] = _mm512_madd52lo_epu64(out[10],a512[9],b512[1]);
	out[10] = _mm512_madd52lo_epu64(out[10],a512[8],b512[2]);
	out[10] = _mm512_madd52lo_epu64(out[10],a512[7],b512[3]);
	out[10] = _mm512_madd52lo_epu64(out[10],a512[6],b512[4]);
	out[10] = _mm512_madd52lo_epu64(out[10],a512[5],b512[5]);
	out[10] = _mm512_madd52lo_epu64(out[10],a512[4],b512[6]);
	out[10] = _mm512_madd52lo_epu64(out[10],a512[3],b512[7]);
	out[10] = _mm512_madd52lo_epu64(out[10],a512[2],b512[8]);
	out[10] = _mm512_madd52lo_epu64(out[10],a512[1],b512[9]);
	out[10] = _mm512_madd52lo_epu64(out[10],a512[0],b512[10]);
	carry  = _mm512_srli(out[10],52);
	out[10] = _mm512_and_si512([10],mask52);

	out[11] = _mm512_madd52hi_epu64(carry,a512[10],b512[0]);
	out[11] = _mm512_madd52hi_epu64(out[11],a512[9],b512[1]);
	out[11] = _mm512_madd52hi_epu64(out[11],a512[8],b512[2]);
	out[11] = _mm512_madd52hi_epu64(out[11],a512[7],b512[3]);
	out[11] = _mm512_madd52hi_epu64(out[11],a512[6],b512[4]);
	out[11] = _mm512_madd52hi_epu64(out[11],a512[5],b512[5]);
	out[11] = _mm512_madd52hi_epu64(out[11],a512[4],b512[6]);
	out[11] = _mm512_madd52hi_epu64(out[11],a512[3],b512[7]);
	out[11] = _mm512_madd52hi_epu64(out[11],a512[2],b512[8]);
	out[11] = _mm512_madd52hi_epu64(out[11],a512[1],b512[9]);
	out[11] = _mm512_madd52hi_epu64(out[11],a512[0],b512[10]);
	out[11] = _mm512_madd52lo_epu64(out[11],a512[11],b512[0]);
	out[11] = _mm512_madd52lo_epu64(out[11],a512[10],b512[1]);
	out[11] = _mm512_madd52lo_epu64(out[11],a512[9],b512[2]);
	out[11] = _mm512_madd52lo_epu64(out[11],a512[8],b512[3]);
	out[11] = _mm512_madd52lo_epu64(out[11],a512[7],b512[4]);
	out[11] = _mm512_madd52lo_epu64(out[11],a512[6],b512[5]);
	out[11] = _mm512_madd52lo_epu64(out[11],a512[5],b512[6]);
	out[11] = _mm512_madd52lo_epu64(out[11],a512[4],b512[7]);
	out[11] = _mm512_madd52lo_epu64(out[11],a512[3],b512[8]);
	out[11] = _mm512_madd52lo_epu64(out[11],a512[2],b512[9]);
	out[11] = _mm512_madd52lo_epu64(out[11],a512[1],b512[10]);
	out[11] = _mm512_madd52lo_epu64(out[11],a512[0],b512[11]);
	carry  = _mm512_srli(out[11],52);
	out[11] = _mm512_and_si512([11],mask52);

	out[12] = _mm512_madd52hi_epu64(carry,a512[11],b512[0]);
	out[12] = _mm512_madd52hi_epu64(out[12],a512[10],b512[1]);
	out[12] = _mm512_madd52hi_epu64(out[12],a512[9],b512[2]);
	out[12] = _mm512_madd52hi_epu64(out[12],a512[8],b512[3]);
	out[12] = _mm512_madd52hi_epu64(out[12],a512[7],b512[4]);
	out[12] = _mm512_madd52hi_epu64(out[12],a512[6],b512[5]);
	out[12] = _mm512_madd52hi_epu64(out[12],a512[5],b512[6]);
	out[12] = _mm512_madd52hi_epu64(out[12],a512[4],b512[7]);
	out[12] = _mm512_madd52hi_epu64(out[12],a512[3],b512[8]);
	out[12] = _mm512_madd52hi_epu64(out[12],a512[2],b512[9]);
	out[12] = _mm512_madd52hi_epu64(out[12],a512[1],b512[10]);
	out[12] = _mm512_madd52hi_epu64(out[12],a512[0],b512[11]);
	out[12] = _mm512_madd52lo_epu64(out[12],a512[12],b512[0]);
	out[12] = _mm512_madd52lo_epu64(out[12],a512[11],b512[1]);
	out[12] = _mm512_madd52lo_epu64(out[12],a512[10],b512[2]);
	out[12] = _mm512_madd52lo_epu64(out[12],a512[9],b512[3]);
	out[12] = _mm512_madd52lo_epu64(out[12],a512[8],b512[4]);
	out[12] = _mm512_madd52lo_epu64(out[12],a512[7],b512[5]);
	out[12] = _mm512_madd52lo_epu64(out[12],a512[6],b512[6]);
	out[12] = _mm512_madd52lo_epu64(out[12],a512[5],b512[7]);
	out[12] = _mm512_madd52lo_epu64(out[12],a512[4],b512[8]);
	out[12] = _mm512_madd52lo_epu64(out[12],a512[3],b512[9]);
	out[12] = _mm512_madd52lo_epu64(out[12],a512[2],b512[10]);
	out[12] = _mm512_madd52lo_epu64(out[12],a512[1],b512[11]);
	out[12] = _mm512_madd52lo_epu64(out[12],a512[0],b512[12]);
	carry  = _mm512_srli(out[12],52);
	out[12] = _mm512_and_si512([12],mask52);

	out[13] = _mm512_madd52hi_epu64(carry,a512[12],b512[0]);
	out[13] = _mm512_madd52hi_epu64(out[13],a512[11],b512[1]);
	out[13] = _mm512_madd52hi_epu64(out[13],a512[10],b512[2]);
	out[13] = _mm512_madd52hi_epu64(out[13],a512[9],b512[3]);
	out[13] = _mm512_madd52hi_epu64(out[13],a512[8],b512[4]);
	out[13] = _mm512_madd52hi_epu64(out[13],a512[7],b512[5]);
	out[13] = _mm512_madd52hi_epu64(out[13],a512[6],b512[6]);
	out[13] = _mm512_madd52hi_epu64(out[13],a512[5],b512[7]);
	out[13] = _mm512_madd52hi_epu64(out[13],a512[4],b512[8]);
	out[13] = _mm512_madd52hi_epu64(out[13],a512[3],b512[9]);
	out[13] = _mm512_madd52hi_epu64(out[13],a512[2],b512[10]);
	out[13] = _mm512_madd52hi_epu64(out[13],a512[1],b512[11]);
	out[13] = _mm512_madd52hi_epu64(out[13],a512[0],b512[12]);
	out[13] = _mm512_madd52lo_epu64(out[13],a512[13],b512[0]);
	out[13] = _mm512_madd52lo_epu64(out[13],a512[12],b512[1]);
	out[13] = _mm512_madd52lo_epu64(out[13],a512[11],b512[2]);
	out[13] = _mm512_madd52lo_epu64(out[13],a512[10],b512[3]);
	out[13] = _mm512_madd52lo_epu64(out[13],a512[9],b512[4]);
	out[13] = _mm512_madd52lo_epu64(out[13],a512[8],b512[5]);
	out[13] = _mm512_madd52lo_epu64(out[13],a512[7],b512[6]);
	out[13] = _mm512_madd52lo_epu64(out[13],a512[6],b512[7]);
	out[13] = _mm512_madd52lo_epu64(out[13],a512[5],b512[8]);
	out[13] = _mm512_madd52lo_epu64(out[13],a512[4],b512[9]);
	out[13] = _mm512_madd52lo_epu64(out[13],a512[3],b512[10]);
	out[13] = _mm512_madd52lo_epu64(out[13],a512[2],b512[11]);
	out[13] = _mm512_madd52lo_epu64(out[13],a512[1],b512[12]);
	out[13] = _mm512_madd52lo_epu64(out[13],a512[0],b512[13]);
	carry  = _mm512_srli(out[13],52);
	out[13] = _mm512_and_si512([13],mask52);

	out[14] = _mm512_madd52hi_epu64(carry,a512[13],b512[0]);
	out[14] = _mm512_madd52hi_epu64(out[14],a512[12],b512[1]);
	out[14] = _mm512_madd52hi_epu64(out[14],a512[11],b512[2]);
	out[14] = _mm512_madd52hi_epu64(out[14],a512[10],b512[3]);
	out[14] = _mm512_madd52hi_epu64(out[14],a512[9],b512[4]);
	out[14] = _mm512_madd52hi_epu64(out[14],a512[8],b512[5]);
	out[14] = _mm512_madd52hi_epu64(out[14],a512[7],b512[6]);
	out[14] = _mm512_madd52hi_epu64(out[14],a512[6],b512[7]);
	out[14] = _mm512_madd52hi_epu64(out[14],a512[5],b512[8]);
	out[14] = _mm512_madd52hi_epu64(out[14],a512[4],b512[9]);
	out[14] = _mm512_madd52hi_epu64(out[14],a512[3],b512[10]);
	out[14] = _mm512_madd52hi_epu64(out[14],a512[2],b512[11]);
	out[14] = _mm512_madd52hi_epu64(out[14],a512[1],b512[12]);
	out[14] = _mm512_madd52hi_epu64(out[14],a512[0],b512[13]);
	out[14] = _mm512_madd52lo_epu64(out[14],a512[14],b512[0]);
	out[14] = _mm512_madd52lo_epu64(out[14],a512[13],b512[1]);
	out[14] = _mm512_madd52lo_epu64(out[14],a512[12],b512[2]);
	out[14] = _mm512_madd52lo_epu64(out[14],a512[11],b512[3]);
	out[14] = _mm512_madd52lo_epu64(out[14],a512[10],b512[4]);
	out[14] = _mm512_madd52lo_epu64(out[14],a512[9],b512[5]);
	out[14] = _mm512_madd52lo_epu64(out[14],a512[8],b512[6]);
	out[14] = _mm512_madd52lo_epu64(out[14],a512[7],b512[7]);
	out[14] = _mm512_madd52lo_epu64(out[14],a512[6],b512[8]);
	out[14] = _mm512_madd52lo_epu64(out[14],a512[5],b512[9]);
	out[14] = _mm512_madd52lo_epu64(out[14],a512[4],b512[10]);
	out[14] = _mm512_madd52lo_epu64(out[14],a512[3],b512[11]);
	out[14] = _mm512_madd52lo_epu64(out[14],a512[2],b512[12]);
	out[14] = _mm512_madd52lo_epu64(out[14],a512[1],b512[13]);
	out[14] = _mm512_madd52lo_epu64(out[14],a512[0],b512[14]);
	carry  = _mm512_srli(out[14],52);
	out[14] = _mm512_and_si512([14],mask52);

	out[15] = _mm512_madd52hi_epu64(carry,a512[14],b512[0]);
	out[15] = _mm512_madd52hi_epu64(out[15],a512[13],b512[1]);
	out[15] = _mm512_madd52hi_epu64(out[15],a512[12],b512[2]);
	out[15] = _mm512_madd52hi_epu64(out[15],a512[11],b512[3]);
	out[15] = _mm512_madd52hi_epu64(out[15],a512[10],b512[4]);
	out[15] = _mm512_madd52hi_epu64(out[15],a512[9],b512[5]);
	out[15] = _mm512_madd52hi_epu64(out[15],a512[8],b512[6]);
	out[15] = _mm512_madd52hi_epu64(out[15],a512[7],b512[7]);
	out[15] = _mm512_madd52hi_epu64(out[15],a512[6],b512[8]);
	out[15] = _mm512_madd52hi_epu64(out[15],a512[5],b512[9]);
	out[15] = _mm512_madd52hi_epu64(out[15],a512[4],b512[10]);
	out[15] = _mm512_madd52hi_epu64(out[15],a512[3],b512[11]);
	out[15] = _mm512_madd52hi_epu64(out[15],a512[2],b512[12]);
	out[15] = _mm512_madd52hi_epu64(out[15],a512[1],b512[13]);
	out[15] = _mm512_madd52hi_epu64(out[15],a512[0],b512[14]);
	out[15] = _mm512_madd52lo_epu64(out[15],a512[15],b512[0]);
	out[15] = _mm512_madd52lo_epu64(out[15],a512[14],b512[1]);
	out[15] = _mm512_madd52lo_epu64(out[15],a512[13],b512[2]);
	out[15] = _mm512_madd52lo_epu64(out[15],a512[12],b512[3]);
	out[15] = _mm512_madd52lo_epu64(out[15],a512[11],b512[4]);
	out[15] = _mm512_madd52lo_epu64(out[15],a512[10],b512[5]);
	out[15] = _mm512_madd52lo_epu64(out[15],a512[9],b512[6]);
	out[15] = _mm512_madd52lo_epu64(out[15],a512[8],b512[7]);
	out[15] = _mm512_madd52lo_epu64(out[15],a512[7],b512[8]);
	out[15] = _mm512_madd52lo_epu64(out[15],a512[6],b512[9]);
	out[15] = _mm512_madd52lo_epu64(out[15],a512[5],b512[10]);
	out[15] = _mm512_madd52lo_epu64(out[15],a512[4],b512[11]);
	out[15] = _mm512_madd52lo_epu64(out[15],a512[3],b512[12]);
	out[15] = _mm512_madd52lo_epu64(out[15],a512[2],b512[13]);
	out[15] = _mm512_madd52lo_epu64(out[15],a512[1],b512[14]);
	out[15] = _mm512_madd52lo_epu64(out[15],a512[0],b512[15]);
	carry  = _mm512_srli(out[15],52);
	out[15] = _mm512_and_si512([15],mask52);

	out[16] = _mm512_madd52hi_epu64(carry,a512[15],b512[0]);
	out[16] = _mm512_madd52hi_epu64(out[16],a512[14],b512[1]);
	out[16] = _mm512_madd52hi_epu64(out[16],a512[13],b512[2]);
	out[16] = _mm512_madd52hi_epu64(out[16],a512[12],b512[3]);
	out[16] = _mm512_madd52hi_epu64(out[16],a512[11],b512[4]);
	out[16] = _mm512_madd52hi_epu64(out[16],a512[10],b512[5]);
	out[16] = _mm512_madd52hi_epu64(out[16],a512[9],b512[6]);
	out[16] = _mm512_madd52hi_epu64(out[16],a512[8],b512[7]);
	out[16] = _mm512_madd52hi_epu64(out[16],a512[7],b512[8]);
	out[16] = _mm512_madd52hi_epu64(out[16],a512[6],b512[9]);
	out[16] = _mm512_madd52hi_epu64(out[16],a512[5],b512[10]);
	out[16] = _mm512_madd52hi_epu64(out[16],a512[4],b512[11]);
	out[16] = _mm512_madd52hi_epu64(out[16],a512[3],b512[12]);
	out[16] = _mm512_madd52hi_epu64(out[16],a512[2],b512[13]);
	out[16] = _mm512_madd52hi_epu64(out[16],a512[1],b512[14]);
	out[16] = _mm512_madd52hi_epu64(out[16],a512[0],b512[15]);
	out[16] = _mm512_madd52lo_epu64(out[16],a512[15],b512[1]);
	out[16] = _mm512_madd52lo_epu64(out[16],a512[14],b512[2]);
	out[16] = _mm512_madd52lo_epu64(out[16],a512[13],b512[3]);
	out[16] = _mm512_madd52lo_epu64(out[16],a512[12],b512[4]);
	out[16] = _mm512_madd52lo_epu64(out[16],a512[11],b512[5]);
	out[16] = _mm512_madd52lo_epu64(out[16],a512[10],b512[6]);
	out[16] = _mm512_madd52lo_epu64(out[16],a512[9],b512[7]);
	out[16] = _mm512_madd52lo_epu64(out[16],a512[8],b512[8]);
	out[16] = _mm512_madd52lo_epu64(out[16],a512[7],b512[9]);
	out[16] = _mm512_madd52lo_epu64(out[16],a512[6],b512[10]);
	out[16] = _mm512_madd52lo_epu64(out[16],a512[5],b512[11]);
	out[16] = _mm512_madd52lo_epu64(out[16],a512[4],b512[12]);
	out[16] = _mm512_madd52lo_epu64(out[16],a512[3],b512[13]);
	out[16] = _mm512_madd52lo_epu64(out[16],a512[2],b512[14]);
	out[16] = _mm512_madd52lo_epu64(out[16],a512[1],b512[15]);
	carry  = _mm512_srli(out[16],52);
	out[16] = _mm512_and_si512([16],mask52);

	out[17] = _mm512_madd52hi_epu64(carry,a512[15],b512[1]);
	out[17] = _mm512_madd52hi_epu64(out[17],a512[14],b512[2]);
	out[17] = _mm512_madd52hi_epu64(out[17],a512[13],b512[3]);
	out[17] = _mm512_madd52hi_epu64(out[17],a512[12],b512[4]);
	out[17] = _mm512_madd52hi_epu64(out[17],a512[11],b512[5]);
	out[17] = _mm512_madd52hi_epu64(out[17],a512[10],b512[6]);
	out[17] = _mm512_madd52hi_epu64(out[17],a512[9],b512[7]);
	out[17] = _mm512_madd52hi_epu64(out[17],a512[8],b512[8]);
	out[17] = _mm512_madd52hi_epu64(out[17],a512[7],b512[9]);
	out[17] = _mm512_madd52hi_epu64(out[17],a512[6],b512[10]);
	out[17] = _mm512_madd52hi_epu64(out[17],a512[5],b512[11]);
	out[17] = _mm512_madd52hi_epu64(out[17],a512[4],b512[12]);
	out[17] = _mm512_madd52hi_epu64(out[17],a512[3],b512[13]);
	out[17] = _mm512_madd52hi_epu64(out[17],a512[2],b512[14]);
	out[17] = _mm512_madd52hi_epu64(out[17],a512[1],b512[15]);
	out[17] = _mm512_madd52lo_epu64(out[17],a512[15],b512[2]);
	out[17] = _mm512_madd52lo_epu64(out[17],a512[14],b512[3]);
	out[17] = _mm512_madd52lo_epu64(out[17],a512[13],b512[4]);
	out[17] = _mm512_madd52lo_epu64(out[17],a512[12],b512[5]);
	out[17] = _mm512_madd52lo_epu64(out[17],a512[11],b512[6]);
	out[17] = _mm512_madd52lo_epu64(out[17],a512[10],b512[7]);
	out[17] = _mm512_madd52lo_epu64(out[17],a512[9],b512[8]);
	out[17] = _mm512_madd52lo_epu64(out[17],a512[8],b512[9]);
	out[17] = _mm512_madd52lo_epu64(out[17],a512[7],b512[10]);
	out[17] = _mm512_madd52lo_epu64(out[17],a512[6],b512[11]);
	out[17] = _mm512_madd52lo_epu64(out[17],a512[5],b512[12]);
	out[17] = _mm512_madd52lo_epu64(out[17],a512[4],b512[13]);
	out[17] = _mm512_madd52lo_epu64(out[17],a512[3],b512[14]);
	out[17] = _mm512_madd52lo_epu64(out[17],a512[2],b512[15]);
	carry  = _mm512_srli(out[17],52);
	out[17] = _mm512_and_si512([17],mask52);

	out[18] = _mm512_madd52hi_epu64(carry,a512[15],b512[2]);
	out[18] = _mm512_madd52hi_epu64(out[18],a512[14],b512[3]);
	out[18] = _mm512_madd52hi_epu64(out[18],a512[13],b512[4]);
	out[18] = _mm512_madd52hi_epu64(out[18],a512[12],b512[5]);
	out[18] = _mm512_madd52hi_epu64(out[18],a512[11],b512[6]);
	out[18] = _mm512_madd52hi_epu64(out[18],a512[10],b512[7]);
	out[18] = _mm512_madd52hi_epu64(out[18],a512[9],b512[8]);
	out[18] = _mm512_madd52hi_epu64(out[18],a512[8],b512[9]);
	out[18] = _mm512_madd52hi_epu64(out[18],a512[7],b512[10]);
	out[18] = _mm512_madd52hi_epu64(out[18],a512[6],b512[11]);
	out[18] = _mm512_madd52hi_epu64(out[18],a512[5],b512[12]);
	out[18] = _mm512_madd52hi_epu64(out[18],a512[4],b512[13]);
	out[18] = _mm512_madd52hi_epu64(out[18],a512[3],b512[14]);
	out[18] = _mm512_madd52hi_epu64(out[18],a512[2],b512[15]);
	out[18] = _mm512_madd52lo_epu64(out[18],a512[15],b512[3]);
	out[18] = _mm512_madd52lo_epu64(out[18],a512[14],b512[4]);
	out[18] = _mm512_madd52lo_epu64(out[18],a512[13],b512[5]);
	out[18] = _mm512_madd52lo_epu64(out[18],a512[12],b512[6]);
	out[18] = _mm512_madd52lo_epu64(out[18],a512[11],b512[7]);
	out[18] = _mm512_madd52lo_epu64(out[18],a512[10],b512[8]);
	out[18] = _mm512_madd52lo_epu64(out[18],a512[9],b512[9]);
	out[18] = _mm512_madd52lo_epu64(out[18],a512[8],b512[10]);
	out[18] = _mm512_madd52lo_epu64(out[18],a512[7],b512[11]);
	out[18] = _mm512_madd52lo_epu64(out[18],a512[6],b512[12]);
	out[18] = _mm512_madd52lo_epu64(out[18],a512[5],b512[13]);
	out[18] = _mm512_madd52lo_epu64(out[18],a512[4],b512[14]);
	out[18] = _mm512_madd52lo_epu64(out[18],a512[3],b512[15]);
	carry  = _mm512_srli(out[18],52);
	out[18] = _mm512_and_si512([18],mask52);

	out[19] = _mm512_madd52hi_epu64(carry,a512[15],b512[3]);
	out[19] = _mm512_madd52hi_epu64(out[19],a512[14],b512[4]);
	out[19] = _mm512_madd52hi_epu64(out[19],a512[13],b512[5]);
	out[19] = _mm512_madd52hi_epu64(out[19],a512[12],b512[6]);
	out[19] = _mm512_madd52hi_epu64(out[19],a512[11],b512[7]);
	out[19] = _mm512_madd52hi_epu64(out[19],a512[10],b512[8]);
	out[19] = _mm512_madd52hi_epu64(out[19],a512[9],b512[9]);
	out[19] = _mm512_madd52hi_epu64(out[19],a512[8],b512[10]);
	out[19] = _mm512_madd52hi_epu64(out[19],a512[7],b512[11]);
	out[19] = _mm512_madd52hi_epu64(out[19],a512[6],b512[12]);
	out[19] = _mm512_madd52hi_epu64(out[19],a512[5],b512[13]);
	out[19] = _mm512_madd52hi_epu64(out[19],a512[4],b512[14]);
	out[19] = _mm512_madd52hi_epu64(out[19],a512[3],b512[15]);
	out[19] = _mm512_madd52lo_epu64(out[19],a512[15],b512[4]);
	out[19] = _mm512_madd52lo_epu64(out[19],a512[14],b512[5]);
	out[19] = _mm512_madd52lo_epu64(out[19],a512[13],b512[6]);
	out[19] = _mm512_madd52lo_epu64(out[19],a512[12],b512[7]);
	out[19] = _mm512_madd52lo_epu64(out[19],a512[11],b512[8]);
	out[19] = _mm512_madd52lo_epu64(out[19],a512[10],b512[9]);
	out[19] = _mm512_madd52lo_epu64(out[19],a512[9],b512[10]);
	out[19] = _mm512_madd52lo_epu64(out[19],a512[8],b512[11]);
	out[19] = _mm512_madd52lo_epu64(out[19],a512[7],b512[12]);
	out[19] = _mm512_madd52lo_epu64(out[19],a512[6],b512[13]);
	out[19] = _mm512_madd52lo_epu64(out[19],a512[5],b512[14]);
	out[19] = _mm512_madd52lo_epu64(out[19],a512[4],b512[15]);
	carry  = _mm512_srli(out[19],52);
	out[19] = _mm512_and_si512([19],mask52);

	out[20] = _mm512_madd52hi_epu64(carry,a512[15],b512[4]);
	out[20] = _mm512_madd52hi_epu64(out[20],a512[14],b512[5]);
	out[20] = _mm512_madd52hi_epu64(out[20],a512[13],b512[6]);
	out[20] = _mm512_madd52hi_epu64(out[20],a512[12],b512[7]);
	out[20] = _mm512_madd52hi_epu64(out[20],a512[11],b512[8]);
	out[20] = _mm512_madd52hi_epu64(out[20],a512[10],b512[9]);
	out[20] = _mm512_madd52hi_epu64(out[20],a512[9],b512[10]);
	out[20] = _mm512_madd52hi_epu64(out[20],a512[8],b512[11]);
	out[20] = _mm512_madd52hi_epu64(out[20],a512[7],b512[12]);
	out[20] = _mm512_madd52hi_epu64(out[20],a512[6],b512[13]);
	out[20] = _mm512_madd52hi_epu64(out[20],a512[5],b512[14]);
	out[20] = _mm512_madd52hi_epu64(out[20],a512[4],b512[15]);
	out[20] = _mm512_madd52lo_epu64(out[20],a512[15],b512[5]);
	out[20] = _mm512_madd52lo_epu64(out[20],a512[14],b512[6]);
	out[20] = _mm512_madd52lo_epu64(out[20],a512[13],b512[7]);
	out[20] = _mm512_madd52lo_epu64(out[20],a512[12],b512[8]);
	out[20] = _mm512_madd52lo_epu64(out[20],a512[11],b512[9]);
	out[20] = _mm512_madd52lo_epu64(out[20],a512[10],b512[10]);
	out[20] = _mm512_madd52lo_epu64(out[20],a512[9],b512[11]);
	out[20] = _mm512_madd52lo_epu64(out[20],a512[8],b512[12]);
	out[20] = _mm512_madd52lo_epu64(out[20],a512[7],b512[13]);
	out[20] = _mm512_madd52lo_epu64(out[20],a512[6],b512[14]);
	out[20] = _mm512_madd52lo_epu64(out[20],a512[5],b512[15]);
	carry  = _mm512_srli(out[20],52);
	out[20] = _mm512_and_si512([20],mask52);

	out[21] = _mm512_madd52hi_epu64(carry,a512[15],b512[5]);
	out[21] = _mm512_madd52hi_epu64(out[21],a512[14],b512[6]);
	out[21] = _mm512_madd52hi_epu64(out[21],a512[13],b512[7]);
	out[21] = _mm512_madd52hi_epu64(out[21],a512[12],b512[8]);
	out[21] = _mm512_madd52hi_epu64(out[21],a512[11],b512[9]);
	out[21] = _mm512_madd52hi_epu64(out[21],a512[10],b512[10]);
	out[21] = _mm512_madd52hi_epu64(out[21],a512[9],b512[11]);
	out[21] = _mm512_madd52hi_epu64(out[21],a512[8],b512[12]);
	out[21] = _mm512_madd52hi_epu64(out[21],a512[7],b512[13]);
	out[21] = _mm512_madd52hi_epu64(out[21],a512[6],b512[14]);
	out[21] = _mm512_madd52hi_epu64(out[21],a512[5],b512[15]);
	out[21] = _mm512_madd52lo_epu64(out[21],a512[15],b512[6]);
	out[21] = _mm512_madd52lo_epu64(out[21],a512[14],b512[7]);
	out[21] = _mm512_madd52lo_epu64(out[21],a512[13],b512[8]);
	out[21] = _mm512_madd52lo_epu64(out[21],a512[12],b512[9]);
	out[21] = _mm512_madd52lo_epu64(out[21],a512[11],b512[10]);
	out[21] = _mm512_madd52lo_epu64(out[21],a512[10],b512[11]);
	out[21] = _mm512_madd52lo_epu64(out[21],a512[9],b512[12]);
	out[21] = _mm512_madd52lo_epu64(out[21],a512[8],b512[13]);
	out[21] = _mm512_madd52lo_epu64(out[21],a512[7],b512[14]);
	out[21] = _mm512_madd52lo_epu64(out[21],a512[6],b512[15]);
	carry  = _mm512_srli(out[21],52);
	out[21] = _mm512_and_si512([21],mask52);

	out[22] = _mm512_madd52hi_epu64(carry,a512[15],b512[6]);
	out[22] = _mm512_madd52hi_epu64(out[22],a512[14],b512[7]);
	out[22] = _mm512_madd52hi_epu64(out[22],a512[13],b512[8]);
	out[22] = _mm512_madd52hi_epu64(out[22],a512[12],b512[9]);
	out[22] = _mm512_madd52hi_epu64(out[22],a512[11],b512[10]);
	out[22] = _mm512_madd52hi_epu64(out[22],a512[10],b512[11]);
	out[22] = _mm512_madd52hi_epu64(out[22],a512[9],b512[12]);
	out[22] = _mm512_madd52hi_epu64(out[22],a512[8],b512[13]);
	out[22] = _mm512_madd52hi_epu64(out[22],a512[7],b512[14]);
	out[22] = _mm512_madd52hi_epu64(out[22],a512[6],b512[15]);
	out[22] = _mm512_madd52lo_epu64(out[22],a512[15],b512[7]);
	out[22] = _mm512_madd52lo_epu64(out[22],a512[14],b512[8]);
	out[22] = _mm512_madd52lo_epu64(out[22],a512[13],b512[9]);
	out[22] = _mm512_madd52lo_epu64(out[22],a512[12],b512[10]);
	out[22] = _mm512_madd52lo_epu64(out[22],a512[11],b512[11]);
	out[22] = _mm512_madd52lo_epu64(out[22],a512[10],b512[12]);
	out[22] = _mm512_madd52lo_epu64(out[22],a512[9],b512[13]);
	out[22] = _mm512_madd52lo_epu64(out[22],a512[8],b512[14]);
	out[22] = _mm512_madd52lo_epu64(out[22],a512[7],b512[15]);
	carry  = _mm512_srli(out[22],52);
	out[22] = _mm512_and_si512([22],mask52);

	out[23] = _mm512_madd52hi_epu64(carry,a512[15],b512[7]);
	out[23] = _mm512_madd52hi_epu64(out[23],a512[14],b512[8]);
	out[23] = _mm512_madd52hi_epu64(out[23],a512[13],b512[9]);
	out[23] = _mm512_madd52hi_epu64(out[23],a512[12],b512[10]);
	out[23] = _mm512_madd52hi_epu64(out[23],a512[11],b512[11]);
	out[23] = _mm512_madd52hi_epu64(out[23],a512[10],b512[12]);
	out[23] = _mm512_madd52hi_epu64(out[23],a512[9],b512[13]);
	out[23] = _mm512_madd52hi_epu64(out[23],a512[8],b512[14]);
	out[23] = _mm512_madd52hi_epu64(out[23],a512[7],b512[15]);
	out[23] = _mm512_madd52lo_epu64(out[23],a512[15],b512[8]);
	out[23] = _mm512_madd52lo_epu64(out[23],a512[14],b512[9]);
	out[23] = _mm512_madd52lo_epu64(out[23],a512[13],b512[10]);
	out[23] = _mm512_madd52lo_epu64(out[23],a512[12],b512[11]);
	out[23] = _mm512_madd52lo_epu64(out[23],a512[11],b512[12]);
	out[23] = _mm512_madd52lo_epu64(out[23],a512[10],b512[13]);
	out[23] = _mm512_madd52lo_epu64(out[23],a512[9],b512[14]);
	out[23] = _mm512_madd52lo_epu64(out[23],a512[8],b512[15]);
	carry  = _mm512_srli(out[23],52);
	out[23] = _mm512_and_si512([23],mask52);

	out[24] = _mm512_madd52hi_epu64(carry,a512[15],b512[8]);
	out[24] = _mm512_madd52hi_epu64(out[24],a512[14],b512[9]);
	out[24] = _mm512_madd52hi_epu64(out[24],a512[13],b512[10]);
	out[24] = _mm512_madd52hi_epu64(out[24],a512[12],b512[11]);
	out[24] = _mm512_madd52hi_epu64(out[24],a512[11],b512[12]);
	out[24] = _mm512_madd52hi_epu64(out[24],a512[10],b512[13]);
	out[24] = _mm512_madd52hi_epu64(out[24],a512[9],b512[14]);
	out[24] = _mm512_madd52hi_epu64(out[24],a512[8],b512[15]);
	out[24] = _mm512_madd52lo_epu64(out[24],a512[15],b512[9]);
	out[24] = _mm512_madd52lo_epu64(out[24],a512[14],b512[10]);
	out[24] = _mm512_madd52lo_epu64(out[24],a512[13],b512[11]);
	out[24] = _mm512_madd52lo_epu64(out[24],a512[12],b512[12]);
	out[24] = _mm512_madd52lo_epu64(out[24],a512[11],b512[13]);
	out[24] = _mm512_madd52lo_epu64(out[24],a512[10],b512[14]);
	out[24] = _mm512_madd52lo_epu64(out[24],a512[9],b512[15]);
	carry  = _mm512_srli(out[24],52);
	out[24] = _mm512_and_si512([24],mask52);

	out[25] = _mm512_madd52hi_epu64(carry,a512[15],b512[9]);
	out[25] = _mm512_madd52hi_epu64(out[25],a512[14],b512[10]);
	out[25] = _mm512_madd52hi_epu64(out[25],a512[13],b512[11]);
	out[25] = _mm512_madd52hi_epu64(out[25],a512[12],b512[12]);
	out[25] = _mm512_madd52hi_epu64(out[25],a512[11],b512[13]);
	out[25] = _mm512_madd52hi_epu64(out[25],a512[10],b512[14]);
	out[25] = _mm512_madd52hi_epu64(out[25],a512[9],b512[15]);
	out[25] = _mm512_madd52lo_epu64(out[25],a512[15],b512[10]);
	out[25] = _mm512_madd52lo_epu64(out[25],a512[14],b512[11]);
	out[25] = _mm512_madd52lo_epu64(out[25],a512[13],b512[12]);
	out[25] = _mm512_madd52lo_epu64(out[25],a512[12],b512[13]);
	out[25] = _mm512_madd52lo_epu64(out[25],a512[11],b512[14]);
	out[25] = _mm512_madd52lo_epu64(out[25],a512[10],b512[15]);
	carry  = _mm512_srli(out[25],52);
	out[25] = _mm512_and_si512([25],mask52);

	out[26] = _mm512_madd52hi_epu64(carry,a512[15],b512[10]);
	out[26] = _mm512_madd52hi_epu64(out[26],a512[14],b512[11]);
	out[26] = _mm512_madd52hi_epu64(out[26],a512[13],b512[12]);
	out[26] = _mm512_madd52hi_epu64(out[26],a512[12],b512[13]);
	out[26] = _mm512_madd52hi_epu64(out[26],a512[11],b512[14]);
	out[26] = _mm512_madd52hi_epu64(out[26],a512[10],b512[15]);
	out[26] = _mm512_madd52lo_epu64(out[26],a512[15],b512[11]);
	out[26] = _mm512_madd52lo_epu64(out[26],a512[14],b512[12]);
	out[26] = _mm512_madd52lo_epu64(out[26],a512[13],b512[13]);
	out[26] = _mm512_madd52lo_epu64(out[26],a512[12],b512[14]);
	out[26] = _mm512_madd52lo_epu64(out[26],a512[11],b512[15]);
	carry  = _mm512_srli(out[26],52);
	out[26] = _mm512_and_si512([26],mask52);

	out[27] = _mm512_madd52hi_epu64(carry,a512[15],b512[11]);
	out[27] = _mm512_madd52hi_epu64(out[27],a512[14],b512[12]);
	out[27] = _mm512_madd52hi_epu64(out[27],a512[13],b512[13]);
	out[27] = _mm512_madd52hi_epu64(out[27],a512[12],b512[14]);
	out[27] = _mm512_madd52hi_epu64(out[27],a512[11],b512[15]);
	out[27] = _mm512_madd52lo_epu64(out[27],a512[15],b512[12]);
	out[27] = _mm512_madd52lo_epu64(out[27],a512[14],b512[13]);
	out[27] = _mm512_madd52lo_epu64(out[27],a512[13],b512[14]);
	out[27] = _mm512_madd52lo_epu64(out[27],a512[12],b512[15]);
	carry  = _mm512_srli(out[27],52);
	out[27] = _mm512_and_si512([27],mask52);

	out[28] = _mm512_madd52hi_epu64(carry,a512[15],b512[12]);
	out[28] = _mm512_madd52hi_epu64(out[28],a512[14],b512[13]);
	out[28] = _mm512_madd52hi_epu64(out[28],a512[13],b512[14]);
	out[28] = _mm512_madd52hi_epu64(out[28],a512[12],b512[15]);
	out[28] = _mm512_madd52lo_epu64(out[28],a512[15],b512[13]);
	out[28] = _mm512_madd52lo_epu64(out[28],a512[14],b512[14]);
	out[28] = _mm512_madd52lo_epu64(out[28],a512[13],b512[15]);
	carry  = _mm512_srli(out[28],52);
	out[28] = _mm512_and_si512([28],mask52);

	out[29] = _mm512_madd52hi_epu64(carry,a512[15],b512[13]);
	out[29] = _mm512_madd52hi_epu64(out[29],a512[14],b512[14]);
	out[29] = _mm512_madd52hi_epu64(out[29],a512[13],b512[15]);
	out[29] = _mm512_madd52lo_epu64(out[29],a512[15],b512[14]);
	out[29] = _mm512_madd52lo_epu64(out[29],a512[14],b512[15]);
	carry  = _mm512_srli(out[29],52);
	out[29] = _mm512_and_si512([29],mask52);

	out[30] = _mm512_madd52hi_epu64(carry,a512[15],b512[14]);
	out[30] = _mm512_madd52hi_epu64(out[30],a512[14],b512[15]);
	out[30] = _mm512_madd52lo_epu64(out[30],a512[15],b512[15]);
	carry  = _mm512_srli(out[30],52);
	out[30] = _mm512_and_si512([30],mask52);

	out[31] = _mm512_madd52hi_epu64(carry,a512[15],b512[15]);
}

/* Schoolbook squaring */

inline void force_inline square512_8_SIZE(__m512i out[32], __m512i a512[16])
{
	out[0] = _mm512_madd52lo_epu64(zero,a512[0],b512[0]);

